<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:image" content="/og-image.png"/><meta data-react-helmet="true" property="og:author" content="장우석"/><meta data-react-helmet="true" property="og:description" content="가시다님 스터디 : https://www.notion.so/gasidaseo/23-7635cc4f02c04954a3260b317588113e 4주차 Harbor를 이용한 이미지 저장소 구축 및 ArgoCD 1.ArgoCD?? 어느덧 가시다님의 쿠버네티스 스터디도 4주차에 접어들었습니다.
이번주의 주제는 Harbor 구축 및 ArgoCD 입니다.
Harbor의 경우 제가 근무하고 있는 회사에서 한때 사용하였던 경험이 있어 나름 익숙한 Container Registry 였지만
ArgoCD같은 경우 여기저기서 많이 들어는봤지만 생소한 개념이었습니다..ㅜㅜ
그래서 ArgoCD가 무엇인지에 대해 설명하고 넘어가겠습니다. ArgoCD에 대해 설명하기 위해서는 먼저 GitOps에 대해 알아야합니다.
GitOps는 어렵게 생각할것 없이 Git에서 사용하는 Devops의 실천 방법 중 하나입니다.
그중에서도 CD(Continous Deployment)에 초점을 두고 있습니다. GitOp…"/><meta data-react-helmet="true" name="description" content="가시다님 스터디 : https://www.notion.so/gasidaseo/23-7635cc4f02c04954a3260b317588113e 4주차 Harbor를 이용한 이미지 저장소 구축 및 ArgoCD 1.ArgoCD?? 어느덧 가시다님의 쿠버네티스 스터디도 4주차에 접어들었습니다.
이번주의 주제는 Harbor 구축 및 ArgoCD 입니다.
Harbor의 경우 제가 근무하고 있는 회사에서 한때 사용하였던 경험이 있어 나름 익숙한 Container Registry 였지만
ArgoCD같은 경우 여기저기서 많이 들어는봤지만 생소한 개념이었습니다..ㅜㅜ
그래서 ArgoCD가 무엇인지에 대해 설명하고 넘어가겠습니다. ArgoCD에 대해 설명하기 위해서는 먼저 GitOps에 대해 알아야합니다.
GitOps는 어렵게 생각할것 없이 Git에서 사용하는 Devops의 실천 방법 중 하나입니다.
그중에서도 CD(Continous Deployment)에 초점을 두고 있습니다. GitOp…"/><meta data-react-helmet="true" property="og:site_title" content="Gasida Kubernetes Study 4주차"/><meta data-react-helmet="true" property="og:title" content="Gasida Kubernetes Study 4주차"/><meta data-react-helmet="true" name="viewport" content="initial-scale=1, width=device-width"/><meta name="generator" content="Gatsby 4.9.3"/><style data-href="/styles.853e65090dc89bfbb4ac.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-8d7d79679b70dbe27172b6460e7a7910.woff2) format("woff2"),url(/static/montserrat-latin-100-ec38980a9e0119a379e2a9b3dbb1901a.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e279051046ba1286706adc886cf1c96b.woff2) format("woff2"),url(/static/montserrat-latin-100italic-3b325a3173c8207435cd1b76e19bf501.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-9d266fbbfa6cab7009bd56003b1eeb67.woff2) format("woff2"),url(/static/montserrat-latin-200-2d8ba08717110d27122e54c34b8a5798.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-6e5b3756583bb2263eb062eae992735e.woff2) format("woff2"),url(/static/montserrat-latin-200italic-a0d6f343e4b536c582926255367a57da.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-00b3e893aab5a8fd632d6342eb72551a.woff2) format("woff2"),url(/static/montserrat-latin-300-ea303695ceab35f17e7d062f30e0173b.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-56f34ea368f6aedf89583d444bbcb227.woff2) format("woff2"),url(/static/montserrat-latin-300italic-54b0bf2c8c4c12ffafd803be2466a790.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-b71748ae4f80ec8c014def4c5fa8688b.woff2) format("woff2"),url(/static/montserrat-latin-400-0659a9f4e90db5cf51b50d005bff1e41.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-6eed6b4cbb809c6efc7aa7ddad6dbe3e.woff2) format("woff2"),url(/static/montserrat-latin-400italic-7583622cfde30ae49086d18447ab28e7.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-091b209546e16313fd4f4fc36090c757.woff2) format("woff2"),url(/static/montserrat-latin-500-edd311588712a96bbf435fad264fff62.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-c90ced68b46050061d1a41842d6dfb43.woff2) format("woff2"),url(/static/montserrat-latin-500italic-5146cbfe02b1deea5dffea27a5f2f998.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-0480d2f8a71f38db8633b84d8722e0c2.woff2) format("woff2"),url(/static/montserrat-latin-600-b77863a375260a05dd13f86a1cee598f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-cf46ffb11f3a60d7df0567f8851a1d00.woff2) format("woff2"),url(/static/montserrat-latin-600italic-c4fcfeeb057724724097167e57bd7801.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-7dbcc8a5ea2289d83f657c25b4be6193.woff2) format("woff2"),url(/static/montserrat-latin-700-99271a835e1cae8c76ef8bba99a8cc4e.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-c41ad6bdb4bd504a843d546d0a47958d.woff2) format("woff2"),url(/static/montserrat-latin-700italic-6779372f04095051c62ed36bc1dcc142.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-db9a3e0ba7eaea32e5f55328ace6cf23.woff2) format("woff2"),url(/static/montserrat-latin-800-4e3c615967a2360f5db87d2f0fd2456f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-bf45bfa14805969eda318973947bc42b.woff2) format("woff2"),url(/static/montserrat-latin-800italic-fe82abb0bcede51bf724254878e0c374.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-e66c7edc609e24bacbb705175669d814.woff2) format("woff2"),url(/static/montserrat-latin-900-8211f418baeb8ec880b80ba3c682f957.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-4454c775e48152c1a72510ceed3603e2.woff2) format("woff2"),url(/static/montserrat-latin-900italic-efcaa0f6a82ee0640b83a0916e6e8d68.woff) format("woff")}.search-input-wrapper{align-items:center;display:none;margin-top:3px;width:180px}@media(min-width:768px){.search-input-wrapper{display:flex}}.search-icon{color:var(--primary-text-color);margin-right:2px}.search-input{height:100%;width:100%}.search-input .MuiAutocomplete-inputRoot{padding-right:0!important}.search-input .MuiInputBase-input{color:var(--primary-text-color)!important;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;font-weight:500;padding-bottom:2px!important}.search-input .MuiInput-underline:before{border-bottom-width:1px}.search-input .MuiInput-underline:after,.search-input .MuiInput-underline:before{border-bottom-color:var(--primary-text-color)}.page-header-wrapper{display:flex;height:60px;justify-content:center;width:100%}.page-header-wrapper .page-header{align-items:center;display:flex;justify-content:space-between;max-width:720px;width:100%}.page-header-wrapper .page-header .link{color:var(--primary-text-color);font-size:17px;font-weight:700}@media(min-width:768px){.page-header-wrapper .page-header .link{font-size:20px;font-weight:700}}.page-header-wrapper .page-header .trailing-section{align-items:center;display:flex}.page-header-wrapper .page-header .trailing-section .link{margin-right:10px}@media(min-width:768px){.page-header-wrapper .page-header .trailing-section .link{margin-right:20px}}.page-footer-wrapper{align-items:center;display:flex;height:62px;justify-content:center;margin-top:auto;width:100%}.page-footer-wrapper .page-footer{max-width:720px;text-align:center;width:100%}.page-footer-wrapper .page-footer .link{color:var(--primary-text-color);font-size:20px;font-weight:700;margin-right:20px}.page-footer-wrapper .page-footer a{color:#3a95ff}.dark-mode-button-wrapper{align-items:center;bottom:20px;display:flex;justify-content:center;position:fixed;right:20px}.dark-mode-button{-webkit-backdrop-filter:blur(30px);backdrop-filter:blur(30px);background-color:#363f47!important;border-radius:50px;box-shadow:0 5px 25px rgba(0,0,0,.12);cursor:pointer;height:50px;width:50px;z-index:3}.dark-mode-icon{color:#fff}a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{border:0;font-size:100%;font:inherit;margin:0;padding:0;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:"";content:none}table{border-collapse:collapse;border-spacing:0}a{outline:none;text-decoration:none}html{--background-color:#fff;--primary-text-color:#000;--secondary-text-color:#9e9e9e;--content-text-color:#37352f;--button-background-color:#f3f3f4;--button-text-color:#363f47;--tab-text-color:#6e6d7a;--tab-hover-text-color:#0d0c22;--tab-selected-background-color:rgba(13,12,34,.05);--bio-link-icon-color:rgba(0,0,0,.54);--about-link-icon-color:#a8a8a8;--chip-background-color:#f3f3f4;--link-text-color:rgba(55,53,47,.7);--post-card-border-color:rgba(0,0,0,.12);--markdown-table-even-cell-background-color:#f6f8fa;--markdown-table-border-color:#dfe2e5;--markdown-blockquote-border-color:#dfe2e5;--markdown-border-color:#e1e4e8}html[data-theme=dark]{--background-color:#232326;--primary-text-color:#e6e6e6;--secondary-text-color:#768390;--content-text-color:#e6e6e6;--button-background-color:#444c56;--button-text-color:#363f47;--tab-text-color:#768390;--tab-hover-text-color:#acbac7;--tab-selected-background-color:#373e47;--chip-background-color:#323a42;--bio-link-icon-color:#e6e6e6;--about-link-icon-color:#a8a8a8;--link-text-color:#90b0ec;--post-card-border-color:#363f47;--markdown-table-even-cell-background-color:#2d333b;--markdown-table-border-color:#444c56;--markdown-blockquote-border-color:#4f5864;--markdown-border-color:#e1e4e8}*{-webkit-appearance:none;appearance:none;box-sizing:border-box}html{font-size:14px;height:100%;overflow-y:scroll;width:100%}body{background-color:var(--background-color)!important}a{color:var(--link-text-color)}.page-wrapper{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;color:var(--primary-text-color);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;justify-content:center;min-height:100vh;padding-left:15px;padding-right:15px;word-break:keep-all}.page-wrapper,.page-wrapper .page-content{align-items:center;display:flex;flex-direction:column;width:100%}.page-wrapper .page-content{max-width:720px}.icon{color:var(--about-link-icon-color);font-size:20px}.social-links .icon{color:var(--bio-link-icon-color);font-size:30px}@-webkit-keyframes blinking-cursor{0%{opacity:0}50%{opacity:1}to{opacity:0}}@keyframes blinking-cursor{0%{opacity:0}50%{opacity:1}to{opacity:0}}.bio{color:var(--primary-text-color);display:flex;flex-direction:column;justify-content:space-between;margin-bottom:120px;margin-top:120px;width:100%}@media(min-width:768px){.bio{align-items:center;flex-direction:row}}.bio .introduction{display:flex;flex-direction:column;word-break:keep-all}.bio .introduction .react-rotating-text-cursor{-webkit-animation:blinking-cursor .8s cubic-bezier(.68,.01,.01,.99) 0s infinite;animation:blinking-cursor .8s cubic-bezier(.68,.01,.01,.99) 0s infinite}.bio .introduction strong{display:inline-block;font-weight:600}.bio .introduction.korean{font-size:32px;font-weight:100;line-height:1.2}.bio .introduction.korean .title .react-rotating-text-cursor{font-size:35px;line-height:35px}@media(min-width:768px){.bio .introduction.korean{font-size:40px}.bio .introduction.korean .title .react-rotating-text-cursor{font-size:45px;line-height:45px}}.bio .introduction.english{font-family:montserrat;font-size:25px;line-height:1.2}@media(min-width:768px){.bio .introduction.english{font-size:45px}}.bio .introduction.english .name{font-size:35px;font-weight:600}.bio .introduction.english .job{font-size:35px}.bio .introduction.english .description{font-size:20px;font-weight:200;margin-top:8px}.bio .introduction.english .social-links{display:flex;margin-top:20px}.bio .thumbnail-wrapper{display:none}@media(min-width:768px){.bio .thumbnail-wrapper{display:block}}.section-header-wrapper{display:flex;justify-content:center;margin-bottom:32px;width:100%}.section-header-wrapper .section-header{border-bottom:4px solid var(--primary-text-color);color:var(--primary-text-color);font-size:30px;font-weight:700;padding-bottom:5px}.timestamp-section{align-items:center;display:flex;flex-direction:column;justify-content:center;margin-bottom:50px;width:100%;word-break:keep-all}.timestamp-section .body{padding:0 10px;width:100%}.timestamp-section .body .timestamp{border-left:2px solid #bdbdbd;display:flex;font-size:18px;font-weight:400;justify-items:center;margin-left:5px;padding:10px 0;width:100%}.timestamp-section .body .timestamp:first-child{padding-top:7px}.timestamp-section .body .timestamp:last-child{padding-bottom:7px}.timestamp-section .body .timestamp:before{align-self:center;background-color:var(--background-color);border:2px solid #828282;border-radius:10px;content:"";height:10px;left:-1px;position:relative;-webkit-transform:translatex(-50%);transform:translatex(-50%);width:10px}.timestamp-section .body .timestamp .date{align-self:center;color:#828282;margin-left:5px;margin-right:5px;min-width:115px;width:115px}@media(min-width:768px){.timestamp-section .body .timestamp .date{min-width:200px;width:200px}}.timestamp-section .body .timestamp .activity{line-height:23px;width:100%}.project-section{align-items:center;justify-content:center}.project-section,.project-section .project{display:flex;flex-direction:column;width:100%}.project-section .project{margin-bottom:30px;padding:15px}.project-section .project .head{font-size:20px;font-weight:700;line-height:30px;margin-bottom:10px}.project-section .project .body{display:flex;flex-direction:column;width:100%}.project-section .project .body .thumbnail{margin-bottom:10px;width:100%}.project-section .project .body .tech-stack{display:flex;margin-bottom:10px}.project-section .project .body .tech-stack .tech{background-color:var(--chip-background-color);border-radius:10px;font-size:15px;font-weight:500;margin-right:5px;padding:5px 7px}.project-section .project .body .description{font-size:16px;font-weight:400;line-height:1.4}@media(min-width:768px){.project-section .project .body{flex-direction:column}.project-section .project .body .content{margin-top:0}}.post-header{border-bottom:1px solid var(--post-card-border-color);display:flex;flex-direction:column;justify-content:center;margin-bottom:40px;margin-top:20px;padding-bottom:10px;width:100%;word-break:keep-all}.post-header .emoji{font-size:78px;margin-bottom:20px}.post-header .categories{margin-bottom:5px}.post-header .categories .category{color:var(--primary-text-color);font-weight:600;margin-right:4px}.post-header .categories .category:hover{text-decoration:underline}.post-header .title{color:var(--primary-text-color);font-size:32px;font-weight:600;line-height:1.3;margin-bottom:6px}.post-header .info{color:var(--secondary-text-color);display:flex;flex-wrap:wrap;font-size:16px;font-weight:500;line-height:1.5;width:100%}.post-header .info .author{margin-right:4px}.post-header .info strong{color:var(--primary-text-color);font-weight:600}.post-navigator{-webkit-column-gap:1.4%;column-gap:1.4%;display:grid;grid-template-columns:49.3% 49.3%;width:100%}.post-navigator .post-card{border:1px solid var(--post-card-border-color);border-radius:6px;color:var(--primary-text-color);cursor:pointer;display:flex;flex-direction:column;padding:15px;transition:-webkit-transform .2s;transition:transform .2s;transition:transform .2s,-webkit-transform .2s;width:100%}.post-navigator .post-card:hover .title{text-decoration:underline}.post-navigator .post-card.prev{margin-right:auto}.post-navigator .post-card.next{margin-left:auto}.post-navigator .post-card .direction{color:gray;font-size:14px;font-weight:500;margin-bottom:5px}.post-navigator .post-card .title{font-size:16px;font-weight:600;line-height:1.4;margin-bottom:7px}.markdown .octicon{fill:currentColor;display:inline-block;vertical-align:text-bottom}.markdown .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown .anchor:focus{outline:none}.markdown h1 .octicon-link,.markdown h2 .octicon-link,.markdown h3 .octicon-link,.markdown h4 .octicon-link,.markdown h5 .octicon-link,.markdown h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown h1:hover .anchor,.markdown h2:hover .anchor,.markdown h3:hover .anchor,.markdown h4:hover .anchor,.markdown h5:hover .anchor,.markdown h6:hover .anchor{text-decoration:none}.markdown h1:hover .anchor .octicon-link,.markdown h2:hover .anchor .octicon-link,.markdown h3:hover .anchor .octicon-link,.markdown h4:hover .anchor .octicon-link,.markdown h5:hover .anchor .octicon-link,.markdown h6:hover .anchor .octicon-link{visibility:visible}.markdown h1:hover .anchor .octicon-link:before,.markdown h2:hover .anchor .octicon-link:before,.markdown h3:hover .anchor .octicon-link:before,.markdown h4:hover .anchor .octicon-link:before,.markdown h5:hover .anchor .octicon-link:before,.markdown h6:hover .anchor .octicon-link:before{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E");content:" ";display:inline-block;height:16px;width:16px}.markdown{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;word-wrap:break-word;color:var(--content-text-color);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;font-weight:500;line-height:1.5}.markdown details{display:block}.markdown summary{display:list-item}.markdown a{background-color:initial}.markdown a:active,.markdown a:hover{outline-width:0}.markdown strong{font-weight:inherit;font-weight:bolder}.markdown h1{margin:.67em 0}.markdown img{border-style:none}.markdown code,.markdown kbd,.markdown pre{font-family:monospace,monospace;font-size:1em}.markdown hr{box-sizing:initial;overflow:visible}.markdown input{font:inherit;margin:0;overflow:visible}.markdown [type=checkbox]{box-sizing:border-box;padding:0}.markdown *{box-sizing:border-box}.markdown input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown a{border-bottom:.05em solid;border-color:var(--link-text-color);color:var(--link-text-color);text-decoration:none}.markdown a.anchor{border-bottom:none}.markdown strong{font-weight:700}.markdown hr{background:transparent;border-bottom:1px solid var(--markdown-blockquote-border-color);height:0;margin:15px 0;overflow:hidden}.markdown hr:after,.markdown hr:before{content:"";display:table}.markdown hr:after{clear:both}.markdown table{border-collapse:collapse;border-spacing:0}.markdown td,.markdown th{padding:0}.markdown details summary{cursor:pointer}.markdown h1,.markdown h2,.markdown h3,.markdown h4,.markdown h5,.markdown h6{margin-bottom:0;margin-top:0}.markdown h1{font-size:32px}.markdown h1,.markdown h2{font-weight:600}.markdown h2{font-size:24px}.markdown h3{font-size:20px}.markdown h3,.markdown h4{font-weight:600}.markdown h4{font-size:16px}.markdown h5{font-size:14px}.markdown h5,.markdown h6{font-weight:600}.markdown h6{font-size:12px}.markdown p{margin-bottom:10px;margin-top:0}.markdown blockquote{margin:0}.markdown ol,.markdown ul{margin-bottom:0;margin-top:0;padding-left:0}.markdown ol ol,.markdown ul ol{list-style-type:lower-roman}.markdown ol ol ol,.markdown ol ul ol,.markdown ul ol ol,.markdown ul ul ol{list-style-type:lower-alpha}.markdown dd{margin-left:0}.markdown code,.markdown pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}.markdown code.language-text{border-radius:3px;font-size:85%;padding:.2em .4em}.markdown :not(pre)>code.language-text{background:hsla(44,6%,50%,.15);color:#eb5757;overflow-wrap:break-word}.markdown pre{margin-bottom:0;margin-top:0}.markdown input::-webkit-inner-spin-button,.markdown input::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}.markdown :checked+.radio-label{border-color:#0366d6;position:relative;z-index:1}.markdown .border{border:1px solid var(--markdown-border-color)!important}.markdown .border-0{border:0!important}.markdown .border-bottom{border-bottom:1px solid var(--markdown-border-color)!important}.markdown .rounded-1{border-radius:3px!important}.markdown .bg-white{background-color:transparent!important}.markdown .bg-gray-light{background-color:#fafbfc!important}.markdown .text-gray-light{color:#6a737d!important}.markdown .pl-3,.markdown .px-3{padding-left:16px!important}.markdown .px-3{padding-right:16px!important}.markdown .f6{font-size:12px!important}.markdown .lh-condensed{line-height:1.25!important}.markdown .text-bold{font-weight:600!important}.markdown .pl-c{color:#6a737d}.markdown .pl-c1,.markdown .pl-s .pl-v{color:#005cc5}.markdown .pl-e,.markdown .pl-en{color:#6f42c1}.markdown .pl-s .pl-s1,.markdown .pl-smi{color:#24292e}.markdown .pl-ent{color:#22863a}.markdown .pl-k{color:#d73a49}.markdown .pl-pds,.markdown .pl-s,.markdown .pl-s .pl-pse .pl-s1,.markdown .pl-sr,.markdown .pl-sr .pl-cce,.markdown .pl-sr .pl-sra,.markdown .pl-sr .pl-sre{color:#032f62}.markdown .pl-smw,.markdown .pl-v{color:#e36209}.markdown .pl-bu{color:#b31d28}.markdown .pl-ii{background-color:#b31d28;color:#fafbfc}.markdown .pl-c2{background-color:#d73a49;color:#fafbfc}.markdown .pl-c2:before{content:"^M"}.markdown .pl-sr .pl-cce{color:#22863a;font-weight:700}.markdown .pl-ml{color:#735c0f}.markdown .pl-mh,.markdown .pl-mh .pl-en,.markdown .pl-ms{color:#005cc5;font-weight:700}.markdown .pl-mi{color:#24292e;font-style:italic}.markdown .pl-mb{color:#24292e;font-weight:700}.markdown .pl-md{background-color:#ffeef0;color:#b31d28}.markdown .pl-mi1{background-color:#f0fff4;color:#22863a}.markdown .pl-mc{background-color:#ffebda;color:#e36209}.markdown .pl-mi2{background-color:#005cc5;color:#f6f8fa}.markdown .pl-mdr{color:#6f42c1;font-weight:700}.markdown .pl-ba{color:#586069}.markdown .pl-sg{color:#959da5}.markdown .pl-corl{color:#032f62;text-decoration:underline}.markdown .mb-0{margin-bottom:0!important}.markdown .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown .pl-0{padding-left:0!important}.markdown .py-0{padding-bottom:0!important;padding-top:0!important}.markdown .pl-1{padding-left:4px!important}.markdown .pl-2{padding-left:8px!important}.markdown .py-2{padding-bottom:8px!important;padding-top:8px!important}.markdown .pl-3{padding-left:16px!important}.markdown .pl-4{padding-left:24px!important}.markdown .pl-5{padding-left:32px!important}.markdown .pl-6{padding-left:40px!important}.markdown .pl-7{padding-left:48px!important}.markdown .pl-8{padding-left:64px!important}.markdown .pl-9{padding-left:80px!important}.markdown .pl-10{padding-left:96px!important}.markdown .pl-11{padding-left:112px!important}.markdown .pl-12{padding-left:128px!important}.markdown hr{border-bottom-color:#eee}.markdown kbd{background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da;color:#444d56;display:inline-block;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;padding:3px 5px;vertical-align:middle}.markdown:after,.markdown:before{content:"";display:table}.markdown:after{clear:both}.markdown>:first-child{margin-top:0!important}.markdown>:last-child{margin-bottom:0!important}.markdown a:not([href]){color:inherit;text-decoration:none}.markdown blockquote,.markdown details,.markdown dl,.markdown ol,.markdown p,.markdown pre,.markdown table,.markdown ul{margin-bottom:16px;margin-top:0}.markdown hr{background-color:var(--markdown-border-color);border:0;height:.25em;margin:24px 0;padding:0}.markdown blockquote{border-left:.25em solid var(--markdown-blockquote-border-color);color:#6a737d;padding:0 1em}.markdown blockquote>:first-child{margin-top:0}.markdown blockquote>:last-child{margin-bottom:0}.markdown h1,.markdown h2,.markdown h3,.markdown h4,.markdown h5,.markdown h6{font-weight:600;line-height:1.25;margin-bottom:16px;margin-top:24px}.markdown h1{font-size:2em}.markdown h2{font-size:1.5em}.markdown h3{font-size:1.25em}.markdown h4{font-size:1em}.markdown h5{font-size:.875em}.markdown h6{color:#6a737d;font-size:.85em}.markdown ol,.markdown ul{padding-left:2em}.markdown ol ol,.markdown ol ul,.markdown ul ol,.markdown ul ul{margin-bottom:0;margin-top:0}.markdown ol{list-style-type:decimal}.markdown ul{list-style-type:disc}.markdown li{word-wrap:break-all;display:list-item;text-align:-webkit-match-parent}.markdown li>p{margin-top:16px}.markdown li+li{margin-top:.25em}.markdown dl{padding:0}.markdown dl dt{font-size:1em;font-style:italic;font-weight:600;margin-top:16px;padding:0}.markdown dl dd{margin-bottom:16px;padding:0 16px}.markdown table{display:block;overflow:auto;width:100%}.markdown table th{font-weight:600}.markdown table td,.markdown table th{border:1px solid var(--markdown-table-border-color);padding:6px 13px}.markdown table tr{border-top:1px solid var(--markdown-table-border-color)}.markdown table tr:nth-child(2n){background-color:var(--markdown-table-even-cell-background-color)}.markdown img{background-color:transparent;box-sizing:initial;display:block;margin:0 auto;max-width:100%}.markdown img[align=right]{padding-left:20px}.markdown img[align=left]{padding-right:20px}.markdown code{background-color:rgba(27,31,35,.05);border-radius:3px;font-size:85%;margin:0;padding:.2em .4em}.markdown pre{word-wrap:normal}.markdown pre>code{background:transparent;border:0;font-size:100%;margin:0;padding:0;white-space:pre;word-break:normal}.markdown .highlight{margin-bottom:16px}.markdown .highlight pre{margin-bottom:0;word-break:normal}.markdown .highlight pre,.markdown pre{background-color:#f6f8fa;border-radius:3px;font-size:85%;line-height:1.45;overflow:auto;padding:16px}.markdown pre code{word-wrap:normal;background-color:initial;border:0;display:inline;line-height:inherit;margin:0;max-width:auto;overflow:visible;padding:0}.markdown .commit-tease-sha{color:#444d56;display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%}.markdown .full-commit .btn-outline:not(:disabled):hover{border-color:#005cc5;color:#005cc5}.markdown .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown .blob-num{color:rgba(27,31,35,.3);cursor:pointer;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;min-width:50px;padding-left:10px;padding-right:10px;text-align:right;-webkit-user-select:none;-ms-user-select:none;user-select:none;vertical-align:top;white-space:nowrap;width:1%}.markdown .blob-num:hover{color:rgba(27,31,35,.6)}.markdown .blob-num:before{content:attr(data-line-number)}.markdown .blob-code{line-height:20px;padding-left:10px;padding-right:10px;position:relative;vertical-align:top}.markdown .blob-code-inner{word-wrap:normal;color:#24292e;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;overflow:visible;white-space:pre}.markdown .pl-token.active,.markdown .pl-token:hover{background:#ffea7f;cursor:pointer}.markdown .tab-size[data-tab-size="1"]{-o-tab-size:1;tab-size:1}.markdown .tab-size[data-tab-size="2"]{-o-tab-size:2;tab-size:2}.markdown .tab-size[data-tab-size="3"]{-o-tab-size:3;tab-size:3}.markdown .tab-size[data-tab-size="4"]{-o-tab-size:4;tab-size:4}.markdown .tab-size[data-tab-size="5"]{-o-tab-size:5;tab-size:5}.markdown .tab-size[data-tab-size="6"]{-o-tab-size:6;tab-size:6}.markdown .tab-size[data-tab-size="7"]{-o-tab-size:7;tab-size:7}.markdown .tab-size[data-tab-size="8"]{-o-tab-size:8;tab-size:8}.markdown .tab-size[data-tab-size="9"]{-o-tab-size:9;tab-size:9}.markdown .tab-size[data-tab-size="10"]{-o-tab-size:10;tab-size:10}.markdown .tab-size[data-tab-size="11"]{-o-tab-size:11;tab-size:11}.markdown .tab-size[data-tab-size="12"]{-o-tab-size:12;tab-size:12}.markdown .task-list-item{list-style-type:none}.markdown .task-list-item+.task-list-item{margin-top:3px}.markdown .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}.markdown .table-of-contents{align-items:flex-start;display:flex;flex-direction:column;justify-content:center;position:fixed;right:0;top:75px;width:340px}@media(max-width:1300px){.markdown .table-of-contents{display:none}}.markdown .table-of-contents ul{cursor:pointer;list-style-type:none}.markdown .table-of-contents ul li a{border-bottom:none;color:var(--secondary-text-color);font-size:14px;height:30px;padding:6px 2px;width:100%}.markdown .table-of-contents ul p{margin:0}.markdown .gatsby-resp-image-wrapper{display:flex!important;justify-content:center!important;max-height:560px!important;width:100%!important}.markdown .gatsby-resp-image-wrapper img{height:auto!important;max-height:560px!important;max-width:100%!important;position:relative!important;width:auto!important}.markdown .gatsby-resp-image-wrapper+em{color:#6a737d;display:block;font-size:15px;font-style:italic;text-align:center}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}.post-content{margin-bottom:20px;width:100%}.category-page-header-wrapper,.post-content{display:flex;flex-direction:column;justify-content:center}.category-page-header-wrapper{align-items:center;margin-bottom:30px;margin-top:30px}.category-page-header-wrapper .category-page-title{border-bottom:3px solid var(--primary-text-color);font-size:40px;font-weight:700;margin-bottom:15px;padding-bottom:7px;text-align:center;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.category-page-header-wrapper .category-page-subtitle{font-size:20px;font-weight:500;padding-bottom:10px;text-align:center}.post-card-wrapper{display:flex;justify-content:center;min-height:150px;width:100%}.post-card-wrapper .post-card{border:1px solid var(--post-card-border-color);border-radius:6px;color:var(--primary-text-color);cursor:pointer;display:flex;flex-direction:column;height:100%;margin-bottom:15px;max-width:720px;padding:15px;transition:-webkit-transform .2s;transition:transform .2s;transition:transform .2s,-webkit-transform .2s;width:100%}.post-card-wrapper .post-card:hover .title{text-decoration:underline}@media(min-width:768px){.post-card-wrapper .post-card{margin-bottom:0}}.post-card-wrapper .post-card .title{font-size:18px;font-weight:600;line-height:1.4;margin-bottom:7px}.post-card-wrapper .post-card .description{-webkit-line-clamp:3;-webkit-box-orient:vertical;color:var(--primary-text-color);display:-webkit-box;font-size:13px;line-height:20px;margin-bottom:10px;overflow:hidden;text-overflow:ellipsis}.post-card-wrapper .post-card .info{color:var(--about-link-icon-color);display:flex;font-size:14px;justify-content:space-between;margin-top:auto}.post-card-wrapper .post-card .info .categories{display:flex}.post-card-wrapper .post-card .info .categories .category{margin-left:4px}.post-card-wrapper .post-card .info .categories .category:hover{text-decoration:underline}.post-card-column-wrapper{display:flex;justify-content:center;width:100%}.post-card-column-wrapper .post-card-column{align-items:center;display:flex;flex-direction:column;width:100%}.post-card-column-wrapper .post-card-column .post-card-wrapper{margin-bottom:10px}.post-card-column-wrapper .post-card-column .more-post-card-button{background-color:var(--button-background-color);color:var(--tab-hover-text-color);font-size:15px;font-weight:500;height:40px}.post-tabs-wrapper{align-self:flex-start;display:flex;flex-direction:column;justify-content:center;top:0;width:100%}.post-tabs-wrapper .post-tabs{display:flex;height:40px;justify-content:center;margin-bottom:12px;max-width:760px;width:100%}.post-tabs-wrapper .post-tabs .mui-tabs .MuiTab-root{color:var(--tab-text-color);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:17px;font-weight:500;height:40px;min-height:auto;min-width:auto;padding:10px 12px;transition:all .2s ease}.post-tabs-wrapper .post-tabs .mui-tabs .Mui-selected,.post-tabs-wrapper .post-tabs .mui-tabs .MuiTab-root :hover{color:var(--tab-hover-text-color);transition:all .2s ease}.post-tabs-wrapper .post-tabs .mui-tabs .Mui-selected{background-color:var(--tab-selected-background-color);border-radius:8px;font-weight:600}.post-tabs-wrapper .post-tabs .mui-tabs .MuiTabScrollButton-root{height:40px;width:20px}.post-tabs-wrapper .post-tabs .mui-tabs .MuiTabs-scrollable{height:40px}.post-tabs-wrapper .post-tabs .mui-tabs .MuiTabs-indicator{display:none}</style><style data-emotion="css-global o6gwfi">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;background-color:#fff;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#fff;}</style><style data-emotion="css-global 1prfaxn">@-webkit-keyframes mui-auto-fill{from{display:block;}}@keyframes mui-auto-fill{from{display:block;}}@-webkit-keyframes mui-auto-fill-cancel{from{display:block;}}@keyframes mui-auto-fill-cancel{from{display:block;}}</style><style data-emotion="css 1l6di18 feqhe6 11tfndm mnn31 vubbuv 1yxmbwk 6flbmm">.css-1l6di18.Mui-focused .MuiAutocomplete-clearIndicator{visibility:visible;}@media (pointer: fine){.css-1l6di18:hover .MuiAutocomplete-clearIndicator{visibility:visible;}}.css-1l6di18 .MuiAutocomplete-tag{margin:3px;max-width:calc(100% - 6px);}.css-1l6di18 .MuiAutocomplete-inputRoot{-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}.MuiAutocomplete-hasPopupIcon.css-1l6di18 .MuiAutocomplete-inputRoot,.MuiAutocomplete-hasClearIcon.css-1l6di18 .MuiAutocomplete-inputRoot{padding-right:30px;}.MuiAutocomplete-hasPopupIcon.MuiAutocomplete-hasClearIcon.css-1l6di18 .MuiAutocomplete-inputRoot{padding-right:56px;}.css-1l6di18 .MuiAutocomplete-inputRoot .MuiAutocomplete-input{width:0;min-width:30px;}.css-1l6di18 .MuiInput-root{padding-bottom:1px;}.css-1l6di18 .MuiInput-root .MuiInput-input{padding:4px 4px 4px 0px;}.css-1l6di18 .MuiInput-root.MuiInputBase-sizeSmall .MuiInput-input{padding:2px 4px 3px 0;}.css-1l6di18 .MuiOutlinedInput-root{padding:9px;}.MuiAutocomplete-hasPopupIcon.css-1l6di18 .MuiOutlinedInput-root,.MuiAutocomplete-hasClearIcon.css-1l6di18 .MuiOutlinedInput-root{padding-right:39px;}.MuiAutocomplete-hasPopupIcon.MuiAutocomplete-hasClearIcon.css-1l6di18 .MuiOutlinedInput-root{padding-right:65px;}.css-1l6di18 .MuiOutlinedInput-root .MuiAutocomplete-input{padding:7.5px 4px 7.5px 6px;}.css-1l6di18 .MuiOutlinedInput-root .MuiAutocomplete-endAdornment{right:9px;}.css-1l6di18 .MuiOutlinedInput-root.MuiInputBase-sizeSmall{padding:6px;}.css-1l6di18 .MuiOutlinedInput-root.MuiInputBase-sizeSmall .MuiAutocomplete-input{padding:2.5px 4px 2.5px 6px;}.css-1l6di18 .MuiFilledInput-root{padding-top:19px;padding-left:8px;}.MuiAutocomplete-hasPopupIcon.css-1l6di18 .MuiFilledInput-root,.MuiAutocomplete-hasClearIcon.css-1l6di18 .MuiFilledInput-root{padding-right:39px;}.MuiAutocomplete-hasPopupIcon.MuiAutocomplete-hasClearIcon.css-1l6di18 .MuiFilledInput-root{padding-right:65px;}.css-1l6di18 .MuiFilledInput-root .MuiFilledInput-input{padding:7px 4px;}.css-1l6di18 .MuiFilledInput-root .MuiAutocomplete-endAdornment{right:9px;}.css-1l6di18 .MuiFilledInput-root.MuiInputBase-sizeSmall{padding-bottom:1px;}.css-1l6di18 .MuiFilledInput-root.MuiInputBase-sizeSmall .MuiFilledInput-input{padding:2.5px 4px;}.css-1l6di18 .MuiInputBase-hiddenLabel{padding-top:8px;}.css-1l6di18 .MuiAutocomplete-input{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;text-overflow:ellipsis;opacity:1;}.css-feqhe6{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;position:relative;min-width:0;padding:0;margin:0;border:0;vertical-align:top;width:100%;}.css-11tfndm{font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.4375em;letter-spacing:0.00938em;color:rgba(0, 0, 0, 0.87);box-sizing:border-box;position:relative;cursor:text;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;position:relative;}.css-11tfndm.Mui-disabled{color:rgba(0, 0, 0, 0.38);cursor:default;}label+.css-11tfndm{margin-top:16px;}.css-11tfndm:after{border-bottom:2px solid #1976d2;left:0;bottom:0;content:"";position:absolute;right:0;-webkit-transform:scaleX(0);-moz-transform:scaleX(0);-ms-transform:scaleX(0);transform:scaleX(0);-webkit-transition:-webkit-transform 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;transition:transform 200ms cubic-bezier(0.0, 0, 0.2, 1) 0ms;pointer-events:none;}.css-11tfndm.Mui-focused:after{-webkit-transform:scaleX(1);-moz-transform:scaleX(1);-ms-transform:scaleX(1);transform:scaleX(1);}.css-11tfndm.Mui-error:after{border-bottom-color:#d32f2f;-webkit-transform:scaleX(1);-moz-transform:scaleX(1);-ms-transform:scaleX(1);transform:scaleX(1);}.css-11tfndm:before{border-bottom:1px solid rgba(0, 0, 0, 0.42);left:0;bottom:0;content:"\00a0";position:absolute;right:0;-webkit-transition:border-bottom-color 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:border-bottom-color 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;pointer-events:none;}.css-11tfndm:hover:not(.Mui-disabled):before{border-bottom:2px solid rgba(0, 0, 0, 0.87);}@media (hover: none){.css-11tfndm:hover:not(.Mui-disabled):before{border-bottom:1px solid rgba(0, 0, 0, 0.42);}}.css-11tfndm.Mui-disabled:before{border-bottom-style:dotted;}.css-mnn31{font:inherit;letter-spacing:inherit;color:currentColor;padding:4px 0 5px;border:0;box-sizing:content-box;background:none;height:1.4375em;margin:0;-webkit-tap-highlight-color:transparent;display:block;min-width:0;width:100%;-webkit-animation-name:mui-auto-fill-cancel;animation-name:mui-auto-fill-cancel;-webkit-animation-duration:10ms;animation-duration:10ms;}.css-mnn31::-webkit-input-placeholder{color:currentColor;opacity:0.42;-webkit-transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mnn31::-moz-placeholder{color:currentColor;opacity:0.42;-webkit-transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mnn31:-ms-input-placeholder{color:currentColor;opacity:0.42;-webkit-transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mnn31::-ms-input-placeholder{color:currentColor;opacity:0.42;-webkit-transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mnn31:focus{outline:0;}.css-mnn31:invalid{box-shadow:none;}.css-mnn31::-webkit-search-decoration{-webkit-appearance:none;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31::-webkit-input-placeholder{opacity:0!important;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31::-moz-placeholder{opacity:0!important;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:-ms-input-placeholder{opacity:0!important;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31::-ms-input-placeholder{opacity:0!important;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:focus::-webkit-input-placeholder{opacity:0.42;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:focus::-moz-placeholder{opacity:0.42;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:focus:-ms-input-placeholder{opacity:0.42;}label[data-shrink=false]+.MuiInputBase-formControl .css-mnn31:focus::-ms-input-placeholder{opacity:0.42;}.css-mnn31.Mui-disabled{opacity:1;-webkit-text-fill-color:rgba(0, 0, 0, 0.38);}.css-mnn31:-webkit-autofill{-webkit-animation-duration:5000s;animation-duration:5000s;-webkit-animation-name:mui-auto-fill;animation-name:mui-auto-fill;}.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}.css-1yxmbwk{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-1yxmbwk::-moz-focus-inner{border-style:none;}.css-1yxmbwk.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1yxmbwk{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1yxmbwk:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-1yxmbwk:hover{background-color:transparent;}}.css-1yxmbwk.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}.css-6flbmm{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:2.1875rem;}</style><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='0',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', '0', 'auto', {});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><link rel="icon" href="/favicon-32x32.png?v=ad9e124e5060ab5ddbaf24744e1cfc72" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=ad9e124e5060ab5ddbaf24744e1cfc72"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=ad9e124e5060ab5ddbaf24744e1cfc72"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=ad9e124e5060ab5ddbaf24744e1cfc72"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=ad9e124e5060ab5ddbaf24744e1cfc72"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=ad9e124e5060ab5ddbaf24744e1cfc72"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=ad9e124e5060ab5ddbaf24744e1cfc72"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=ad9e124e5060ab5ddbaf24744e1cfc72"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=ad9e124e5060ab5ddbaf24744e1cfc72"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><title data-react-helmet="true">Gasida Kubernetes Study 4주차</title><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fBBc4.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxK.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc4.woff2"/><style>@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:300;src:url(/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fBBc4.woff2) format("woff2")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:400;src:url(/static/webfonts/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxK.woff2) format("woff2")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:500;src:url(/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc4.woff2) format("woff2")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:300;src:url(/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fBBc-.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:400;src:url(/static/webfonts/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxM.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:500;src:url(/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc-.woff) format("woff")}</style><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link as="script" rel="preload" href="/webpack-runtime-121beace0d37eb670f34.js"/><link as="script" rel="preload" href="/framework-043f1197be387cb18d15.js"/><link as="script" rel="preload" href="/app-0f9980b68d4a425d9725.js"/><link as="script" rel="preload" href="/f9d3028dbef90a6e9b8db85387d63dd9f4edf538-07f7733d8d97d93498cb.js"/><link as="script" rel="preload" href="/component---src-templates-blog-template-js-e3a4bb3c9603d1ed8af7.js"/><link as="fetch" rel="preload" href="/page-data/Kubernetes/Gasida_Study_homework_4/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1073350324.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1956554647.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2938748437.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="page-wrapper"><header class="page-header-wrapper"><div class="page-header"><div class="front-section"><a class="link" href="/">korwoo93.github.io</a></div><div class="trailing-section"><a class="link" href="/about">about</a><a class="link" href="/posts">posts</a><div class="MuiAutocomplete-root MuiAutocomplete-hasPopupIcon css-1l6di18" role="combobox" aria-expanded="false"><div class="search-input-wrapper"><div class="MuiFormControl-root MuiFormControl-fullWidth MuiTextField-root search-input css-feqhe6"><div class="MuiInput-root MuiInput-underline MuiInputBase-root MuiInputBase-colorPrimary MuiInputBase-fullWidth MuiInputBase-formControl MuiInputBase-adornedEnd MuiAutocomplete-inputRoot css-11tfndm"><input type="text" aria-invalid="false" autoComplete="off" value="" class="MuiInput-input MuiInputBase-input MuiInputBase-inputAdornedEnd MuiAutocomplete-input MuiAutocomplete-inputFocused css-mnn31" aria-autocomplete="list" autoCapitalize="none" spellcheck="false"/><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium search-icon css-vubbuv" focusable="false" viewBox="0 0 24 24" aria-hidden="true" data-testid="SearchOutlinedIcon"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg></div></div></div></div></div></div></header><main class="page-content"><header class="post-header"><div class="emoji">🔮</div><div class="info"><div class="categories"><a class="category" href="/posts/Kubernetes">Kubernetes</a></div></div><h1 class="title">Gasida Kubernetes Study 4주차</h1><div class="info"><div class="author">posted by <strong>KORWOO</strong>,</div> <!-- -->February 08, 2023</div></header><div class="post-content"><div class="markdown"><p>가시다님 스터디 : <a href="https://www.notion.so/gasidaseo/23-7635cc4f02c04954a3260b317588113e">https://www.notion.so/gasidaseo/23-7635cc4f02c04954a3260b317588113e</a></p>
<p>4주차 Harbor를 이용한 이미지 저장소 구축 및 ArgoCD</p>
<h2 id="1argocd" style="position:relative;"><a href="#1argocd" aria-label="1argocd permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1.ArgoCD??</h2>
<p>어느덧 가시다님의 쿠버네티스 스터디도 4주차에 접어들었습니다.
이번주의 주제는 Harbor 구축 및 ArgoCD 입니다.
Harbor의 경우 제가 근무하고 있는 회사에서 한때 사용하였던 경험이 있어 나름 익숙한 Container Registry 였지만
ArgoCD같은 경우 여기저기서 많이 들어는봤지만 생소한 개념이었습니다..ㅜㅜ
그래서 ArgoCD가 무엇인지에 대해 설명하고 넘어가겠습니다.</p>
<p>ArgoCD에 대해 설명하기 위해서는 먼저 GitOps에 대해 알아야합니다.
GitOps는 어렵게 생각할것 없이 Git에서 사용하는 Devops의 실천 방법 중 하나입니다.
그중에서도 CD(Continous Deployment)에 초점을 두고 있습니다.</p>
<p>GitOps의 핵심 아이디어는</p>
<ol>
<li>배포에 관련된 모든 것을 선언형 기술서(Declarative Descriptions)형태로 작성하여 Config Repostiry에서 관리</li>
<li>Config Repositry의 선언형 기술서와 운영 환경 간 상태차이가 없도록 유지시키는 자동화 시스템 구성</li>
</ol>
<p>즉 GitOps는 K8S Manifest 파일을 Git에서 관리하고 배포할때에도 Git에 저장된 Manifest로 Cluster에 배포하는 과정입니다.
Manifest 파일에 배포된 상태가 어떤 모양을 가져아 할지 선언되어 있는 방식으로 정의하여 단일 진실의 원천(SSOT) 를 지킵니다.
GitOps를 사용하면 배포상태의 모습을 항상 Manifest에 정의된 대로 원천가 동일하게 맞추며 현재 배포환경의 상태를 쉽게 파악할 수 있습니다.</p>
<p>GitOps에 대해서 설명드릴 내용이 좀 더 많이 있으나 GitOps가 메인이 아닌지라 기회가 된다면 다음 포스팅에서 GitOps에 대해 다뤄볼수 있도록 하겠습니다.
이 GitOps를 구현체가 바로 ArgoCD 입니다!!</p>
<p>서론이 길었습니다.</p>
<p>바로 실습으로 넘어가도록 하겠습니다.</p>
<h2 id="2-harbor-container-registry-구축" style="position:relative;"><a href="#2-harbor-container-registry-%EA%B5%AC%EC%B6%95" aria-label="2 harbor container registry 구축 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Harbor Container Registry 구축</h2>
<p>Cluster 구성 과정은 지난번 포스팅을 참고하여 주시고 바로 진행하겠습니다.</p>
<p>먼저 지나번과 같이 Control Plane, Worker Node에 AWS LoadBalancer, ExternalDNS 에 대한 권한을 부여하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">aws iam attach-role-policy --policy-arn arn:aws:iam::<span class="token variable">$ACCOUNT_ID</span>:policy/AWSLoadBalancerControllerIAMPolicy --role-name masters.<span class="token variable">$KOPS_CLUSTER_NAME</span>
aws iam attach-role-policy --policy-arn arn:aws:iam::<span class="token variable">$ACCOUNT_ID</span>:policy/AWSLoadBalancerControllerIAMPolicy --role-name nodes.<span class="token variable">$KOPS_CLUSTER_NAME</span>
aws iam attach-role-policy --policy-arn arn:aws:iam::<span class="token variable">$ACCOUNT_ID</span>:policy/AllowExternalDNSUpdates --role-name masters.<span class="token variable">$KOPS_CLUSTER_NAME</span>
aws iam attach-role-policy --policy-arn arn:aws:iam::<span class="token variable">$ACCOUNT_ID</span>:policy/AllowExternalDNSUpdates --role-name nodes.<span class="token variable">$KOPS_CLUSTER_NAME</span></code></pre></div>
<p>다음 kops cluster 를 업데이트 해주도록하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kops edit cluster
-----
spec:
  certManager:
    enabled: <span class="token boolean">true</span>
  awsLoadBalancerController:
    enabled: <span class="token boolean">true</span>
  externalDns:
    provider: external-dns
-----

kops update cluster --yes <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token operator">&amp;&amp;</span> <span class="token function">sleep</span> <span class="token number">3</span> <span class="token operator">&amp;&amp;</span> kops rolling-update cluster</code></pre></div>
<p>다음은 이미지 저장소인 Harbor를 설치해주도록 하겠습니다.
Harbor 설치는 Helm Chart를 통해 설치를 진행하도록하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">helm repo <span class="token function">add</span> harbor https://helm.goharbor.io
helm fetch harbor/harbor --untar</code></pre></div>
<p>다음 value.yaml에 대한 수정이 필요합니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">vim</span> ~/harbor/values.yaml

expose.tls.certSource<span class="token operator">=</span>none  <span class="token comment"># 19줄</span>
expose.ingress.hosts.core<span class="token operator">=</span>harbor.<span class="token operator">&lt;</span>각자자신의도메인<span class="token operator">></span>    <span class="token comment"># 36줄</span>
expose.ingress.hosts.notary<span class="token operator">=</span>notary.<span class="token operator">&lt;</span>각자자신의도메인<span class="token operator">></span>  <span class="token comment"># 37줄</span>
expose.ingress.hosts.core<span class="token operator">=</span>harbor.gasida.link    
expose.ingress.hosts.notary<span class="token operator">=</span>notary.gasida.link  
expose.ingress.controller<span class="token operator">=</span>alb                      <span class="token comment"># 44줄</span>
expose.ingress.className<span class="token operator">=</span>alb                       <span class="token comment"># 47줄</span>
expose.ingress.annotations<span class="token operator">=</span>alb.ingress.kubernetes.io/scheme: internet-facing
expose.ingress.annotations<span class="token operator">=</span>alb.ingress.kubernetes.io/target-type: <span class="token function">ip</span>
expose.ingress.annotations<span class="token operator">=</span>alb.ingress.kubernetes.io/listen-ports: <span class="token string">'[{"HTTPS":443}, {"HTTP":80}]'</span>
expose.ingress.annotations<span class="token operator">=</span>alb.ingress.kubernetes.io/certificate-arn: <span class="token variable">${CERT_ARN}</span>
<span class="token assign-left variable">externalURL</span><span class="token operator">=</span>https://harbor.<span class="token operator">&lt;</span>각자자신의도메인<span class="token operator">></span>
<span class="token assign-left variable">externalURL</span><span class="token operator">=</span>https://harbor.gasida.link             <span class="token comment"># 131줄</span></code></pre></div>
<p>위의 yaml 파일 내용수정 중
51~54번째줄에 해당하는 내용은 주석처리를 해주시면 됩니다.
추가적으로 expore.ingress.annotations=alb.ingress.kubernetes.io/certificate-arn: ${CERT_ARN} 부분은
문자 그대로 넣어주시는것이 아니라
터미널에서 echo “alb.ingress.kubernetes.io/certificate-arn: $CERT_ARN” 명령어를 입력하여 나온 값을
${CERT_ARN} 값 대신에 넣어줄수 있도록 합니다.
단순히 ${CERN_ARN} 값을 넣으면 인증키 값이 꼬일수도 있기 떄문입니다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 48.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaUlEQVQoz41S2W6DQBDjdXf2ZEO4Q5BCUxKiJm2l/v+Xudojl6pWfbA8gOTxGGdMluD5HtzuwK3nCTyfwfNDek7fdA9SNbgZ4iwkSIgAQRRZCGRMVuB2BjMTmNmBuROYewNz58SXwKTKCOlAsgDJHIL4k2gQ5KaGrI7Q6wl6PYP8djOCm210c2W9CRwF8zuS4BWZLHq4ly+U4wLX7CD9ZmFBQoOkCSz8edI+IL8Je5d3EDLSBXR3gipnCN1EF6YH2RFCtRC6j5npLrrXTZrb9L5NSxxIKGRcaNjNAjtckI/vMJsz7PYDdvyEq19RqQpKrlOGRcxPre+Z+jk4LsI1GZkV3LjAdBN0NyEfDrDdDrbfw/q57NAQQRID3U5jD/hxsoOqZxTDGXV7BFctSNfxrOBI3SpB/0BGegXTLTB2gLI9uGpAqgqdCz/E1+HaM8+pHr8hOPQZ6nKCUg1EyGSVciqeOkZ/CF0FvwHfxu+W7OF8xAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="harbor_yaml.png"
        title="harbor_yaml.png"
        src="/static/27bd7c3179f7b59fbe00ce751b5300a8/37523/harbor_yaml.png"
        srcset="/static/27bd7c3179f7b59fbe00ce751b5300a8/e9ff0/harbor_yaml.png 180w,
/static/27bd7c3179f7b59fbe00ce751b5300a8/f21e7/harbor_yaml.png 360w,
/static/27bd7c3179f7b59fbe00ce751b5300a8/37523/harbor_yaml.png 720w,
/static/27bd7c3179f7b59fbe00ce751b5300a8/302a4/harbor_yaml.png 1080w,
/static/27bd7c3179f7b59fbe00ce751b5300a8/d4e7f/harbor_yaml.png 1416w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<p>수정이 완료 되었다면
아래의 명령어를 입력하여 helm install을 진행해주도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl create ns harbor
helm <span class="token function">install</span> harbor harbor/harbor -f ~/harbor/values.yaml --namespace harbor --version <span class="token number">1.11</span>.0</code></pre></div>
<p>헬름 인스톨 이후
harbor.자신의도메인 에 접속하시면 Harbor에 접속하실 수 있습니다.
이 작업또한 시간이 조금 필요하기에 느긋하게 5분정도 후에 접속해보시면 되겠습니다!</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 48.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkElEQVQoz5VSXW/UMBDMz4eHE4Veq9JW4lqQgH/BD+H1rrETu/FnnM9Bs3cH10csTSw7u7Mzu66+fP2B3befuL17wPvNR7zbfMLm6hqbqy0+bO9w8/CMm/snwfZ+h63sb3H9eYfbx2c8Pn1HhYuVckYZR/zvWvhxe+D3L1SdD5imGTFGtMagc07gQ0AIET5EOO4xwfsg/2JKCDEipYScM3LfI0ePYDUq5xzWdUXf90IyjiPmZQbWFdM0YeJ5nrHMM9q2Fch5WQSMkfO6YlmBisrOhM57hBBESSlF7qiACYTWDZTS6LpO4JwXF8MwCDljKkrnOhNaY2GtFaW8SzFhHCdRclRoTmhBd4wjYV+K7FXOvSTkEyErN00rBFTJPon1E+FLXaOuFRShNGqlYIwV0F3FBMqltUtCsUuF6Z9CYwx008j/pmnw+tpJHmMJUchBXFomYV3XUo0BTDg33lgrg+NdjAllGI7P5jQgomJSKYMMgsGmNdBa/63KobFPJFVK4XB4wX5PHMQy+xnkiR0L/QEMWfA7L5YhTAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="route53.png"
        title="route53.png"
        src="/static/903faa47dacc1ac1e0aff55bf6ec17dd/37523/route53.png"
        srcset="/static/903faa47dacc1ac1e0aff55bf6ec17dd/e9ff0/route53.png 180w,
/static/903faa47dacc1ac1e0aff55bf6ec17dd/f21e7/route53.png 360w,
/static/903faa47dacc1ac1e0aff55bf6ec17dd/37523/route53.png 720w,
/static/903faa47dacc1ac1e0aff55bf6ec17dd/302a4/route53.png 1080w,
/static/903faa47dacc1ac1e0aff55bf6ec17dd/07a9c/route53.png 1440w,
/static/903faa47dacc1ac1e0aff55bf6ec17dd/764d7/route53.png 1782w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span>
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABFklEQVQoz62Q3U7DMAyF8/YgNNaJjo2/Ale8By/CHXewJLbTtEvXg+IWVrRdTYtkJfZxP5/aPL6+oVw94HK2wMXVHLOixHVRoihXuFlXWKyf97GqNIrx/n3Pb5+wvH/B8q6CwXiatgURoe97nHT8J/DxDpNBMUZYa2GtAzHDOQfvPUREc08E7wkSgtacGzSRACLWqIMgkBscZjHUAV8UIXGrA1gEdV0jthFxG9E0DZhZtTysHY3E2Ghvhm9TB5NS0oJ1DhsvoDyVWXPnPUgYJDQ4z3nWrAOz6Ir2f+CVo8Ds8HuzAcsojo1/zZPa9D6mmdR1upsMJJaDDwbwIewYPL9NSt3Eofxzd0qYXZd0oecD7rqzAn8AxlTtPgY+RLwAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="LB.png"
        title="LB.png"
        src="/static/ab3be415cc7f015673ff282fb6f997a6/37523/LB.png"
        srcset="/static/ab3be415cc7f015673ff282fb6f997a6/e9ff0/LB.png 180w,
/static/ab3be415cc7f015673ff282fb6f997a6/f21e7/LB.png 360w,
/static/ab3be415cc7f015673ff282fb6f997a6/37523/LB.png 720w,
/static/ab3be415cc7f015673ff282fb6f997a6/302a4/LB.png 1080w,
/static/ab3be415cc7f015673ff282fb6f997a6/07a9c/LB.png 1440w,
/static/ab3be415cc7f015673ff282fb6f997a6/a2498/LB.png 1764w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<p>만약 접속이 잘 안되실 경우 IAM에서 역할 할당이 잘 되어있는지,
Route53에 harbor.도메인이 잘 등록되어 있는지,
LB는 잘 생성되어 있는지를 확인해주시면 되겠습니다.</p>
<p>정상적으로 접속이 되었습니다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB50lEQVQ4y42S3W/SUBjGe6Exw5h458Y2oDBpCy2nn4etBToQs6ZsIRtxTG+UqCTGSGRRFnUfipnJEo165Z/7mJ7ahgE6L355T29+5+n7HO7FxS88Ov2GrcEZ/OEntN+eozUcw3v9Ed7gDFuvTuEfjtE6/PxfcLcLFDfzBq5nCW7kVCTu6mxeyyhYKDq4ZTSxkDeRkNaREMtXwq1KKlIFDemizmBn2UBKJFizm9CfHkFyfeSNCoTyJgTq/hNuuaAjKWlISjqShQgDSwJBitZR6p9A6Y2Qq3jIaA540wVv1MCb8+FWZROK3UBOt7EkqgguYJcIBOlyA6Vn70D6Jyj1RlireOA1G1kmrSJr1mKib5YwkK4UDZZ0VvieQfrHf5VOypmQV9eZNCKlWFgWVaRpKCTPP1yZNJgBXJAspztMEu5SY3ucFUZJp6SWG8vk+na4w+JGnSHSKgRahUhrYdO0DjIhjOeUNChDaezA2j4AlyEUjfYD3N89wL32Ppq7XXjdx5A3NrFiukxyKeGEVPkjlV0f1s5DGP4+uOAXFwWCOxMsSuGziUqZSRhLj2G9HIN2ejC8DsxWNyxlHkmhNCOcPtPBOSpHP2EPL2DtPWHSS8K4kKlnMy8hHXyBM/oO+81XOKMfobTTw2+Rr8KoBCCugwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="harbor_conn.png"
        title="harbor_conn.png"
        src="/static/c18d41a9c1522c3738af3222150cd9bb/37523/harbor_conn.png"
        srcset="/static/c18d41a9c1522c3738af3222150cd9bb/e9ff0/harbor_conn.png 180w,
/static/c18d41a9c1522c3738af3222150cd9bb/f21e7/harbor_conn.png 360w,
/static/c18d41a9c1522c3738af3222150cd9bb/37523/harbor_conn.png 720w,
/static/c18d41a9c1522c3738af3222150cd9bb/302a4/harbor_conn.png 1080w,
/static/c18d41a9c1522c3738af3222150cd9bb/c9c3a/harbor_conn.png 1289w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<p>ID PW 는 기본
ID : admin
PW : Harbor12345로 설정이 되어있습니다.</p>
<p>접속이 되었다면 신규 프로젝트를 생성해주도록하겠습니다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 77.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACZklEQVQ4y5WT23LaMBCG3QR8kGRbtgGbhHAICYUQUiAk4RQITZOm05tOL/oCfZW+SR/07+zKENKZXvRi55fW0qd/tbIV1Foolo5xEGewdIp3UYbDpIqDuMrzv4Py9N2sO4IVmX00PoxSWI6vUZABCsLnKKoQtgpZ/ydspSF1DMtPKghLKYQuQUZliDCGpwLIQEMEmseuClhpTnnPDzkn/JBzIp8rAkqdMNn1NRwVwpE+HKH4o4oS3uwQ1A/hxyXOe4HmdQTjXJTAzQ+y+HTaJBRs6cMjh2EMlVRA7lVShopNBOXMjJMKZFyGiBKuyBgyLi06iYC2J6GzGgarZ4w2L7haP6M1nqMxmqIxmrE2RzMOHo/nqF1e79y6+dVYW+sEDLMazu7WOLu5x/ntCq3rxb9jskT96tZcy7ZK6b8CSYP0GN35Iy5Xz2hPluyst3hEd/4Rp5MlH0RBY4KeDCamidvmBHpbsnFIQAL0758Y0hzP0Fl/RWe24RL3gxwSkJrKwDCCDKNXIDWFSu4tP2Gw/sxgusN27oiUXHVnG7yfPhjw8A5H9SaOTxpI0ipcFe4BpQGSs/7yCZ3pA+rDKeZfvqG/eERzvGDwtlzj8AYiiPKmvOmyhi0kdPWEF1MnWcdzvjMaN/ION6nrwymaH25R64/edHnXlG3J0VEd7bsHnFKZHCu0JkZp3p5ucL56QfflB+5//cbF959wPLF7MuzQpgctFIqe5MeatnuotLu59lh3ubMLZJ0Bsu4Q9dkT0t4ILv1Zcg9IIAqGugIFx4XtCdiuMLofrkDR9VB0XBQOC6z8WzLUlP0HtOOGBpT0uh8AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="harbor_project.png"
        title="harbor_project.png"
        src="/static/a447318a43d2f000d1a332574afbcfce/37523/harbor_project.png"
        srcset="/static/a447318a43d2f000d1a332574afbcfce/e9ff0/harbor_project.png 180w,
/static/a447318a43d2f000d1a332574afbcfce/f21e7/harbor_project.png 360w,
/static/a447318a43d2f000d1a332574afbcfce/37523/harbor_project.png 720w,
/static/a447318a43d2f000d1a332574afbcfce/eafa0/harbor_project.png 939w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<p>이미지 레지스트리가 잘 생성 되었으므로 한번 이미지저장소에 이미지를 Push해보도록 하겠습니다.
아래 명령어를 통해 임의의 이미지를 내려받고 태그를 달아주도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">docker pull nginx
docker pull busybox
docker tag busybox harbor.<span class="token variable">$KOPS_CLUSTER_NAME</span>/pkos/busybox:0.1</code></pre></div>
<p>아래 명령어는 insecure 설정 명령어입니다. 진행해주도록 하겠습니다. 진행 후 daemor reload 및 docker 재시작을 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span>EOT<span class="token operator">></span> /etc/docker/daemon.json
<span class="token punctuation">{</span>
    <span class="token string">"insecure-registries"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">"harbor.<span class="token variable">$KOPS_CLUSTER_NAME</span>"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
EOT

systemctl daemon-reload <span class="token operator">&amp;&amp;</span> systemctl restart docker</code></pre></div>
<p>다음 아래 명령어를 통하여 Harbor에 로그인하고 이미지를 Push하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">docker login harbor.<span class="token variable">$KOPS_CLUSTER_NAME</span> -u admin -p Harbor12345
docker push harbor.<span class="token variable">$KOPS_CLUSTER_NAME</span>/pkos/busybox:0.1</code></pre></div>
<p>명령어 수행 후 Harbor에서 Image가 정상적으로 Push 된것을 확인하실 수 있습니다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB20lEQVQoz0WRS2sTURiGB+3CksnkPulcM5nJZTJJJpPLaI2lIMVNF7oSNxVScaG2Gatxlb/jVqgo7tyLqAtBEKkbBX/HI+dQ2sXLdzbn4Xm/T3n/4y9vPp9x+uUXp1/PePvtNx++/+Hdz3+8/viJ42VGlmW8enHCavWS9XpNdnTEMss4WR7z6PCQg4OHLBYLGaV+f8WVO4+5tv8M7e6Szf2nbO4/Qbv3nMrtB9iGSX3LQK/pVMpVqpUqer1OuVwmn89zdWMDRVEu05/v0Zzs4A6v04hTjG6M1Uvwp3PMdo9yzaVYt9H0ImpFRdVU1JwqYaqqymiaRqFQkFE66S7uIMWOprRnO/jjOcFkTu/WHl5/jKFvUbdcLNfGsAxMy8SyLAzDQNd1qtUqxWKRXC4n4YoTjbHCEUYnppls4462cQYz7EFKIxrT9Vs0Wx3iOKYf9YmiiHa7jeM4EiiqC6AwFlDFG6bYvURWDdJdGslNvNENOZuDiQTWDBvPa+AHAWEYyriuK01N06RUKl1YSkO3P8UME5xhiiPqnxu6YUzUCfH8FkEQ4Ps+3W6XJEkkVJh6nieBou654QxhKYBmb3yZaIoR9HBNi4bfptn05Gexu1qtdrE/8RZTHEYA/wOFg/XaGzCSwAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image_push.png"
        title="image_push.png"
        src="/static/f68d04d474061bc02b46c775f3ec70ed/37523/image_push.png"
        srcset="/static/f68d04d474061bc02b46c775f3ec70ed/e9ff0/image_push.png 180w,
/static/f68d04d474061bc02b46c775f3ec70ed/f21e7/image_push.png 360w,
/static/f68d04d474061bc02b46c775f3ec70ed/37523/image_push.png 720w,
/static/f68d04d474061bc02b46c775f3ec70ed/302a4/image_push.png 1080w,
/static/f68d04d474061bc02b46c775f3ec70ed/07a9c/image_push.png 1440w,
/static/f68d04d474061bc02b46c775f3ec70ed/e67dd/image_push.png 1801w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<p>다음은 YAML 파일의 컨테이너 이미지 저장소 주소를 Local Harbor로 변경해보겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> -s -O https://raw.githubusercontent.com/junghoon2/kube-books/main/ch13/busybox-deploy.yml
<span class="token function">sed</span> -i <span class="token string">"s|harbor.myweb.io/erp|harbor.<span class="token variable">$KOPS_CLUSTER_NAME</span>/pkos|g"</span> busybox-deploy.yml</code></pre></div>
<p>위의 명령어의 yaml 파일을 조회하시면 image가 저희가 방금 저장하였던 local Harbor의 이미지로 지정이 되어있습니다.
kubectl apply -f busybox-deply.yml 을 입력하시면
해당 이미지가 Pulling 되어 Pod가 기동될것입니다.</p>
<p>##3. GitLab 을 이용한 Local Git 소스 저장소 구축</p>
<p>Gitops 실습에 앞서 소스 저장소 구축을 위해 GitLab 이용해 Local Git 저장소를 구축해보겠습니다.
참고로 GitLab은 최소 요구사항이 제법 높은편입니다.(<a href="https://docs.gitlab.com/ee/install/requirements.html">https://docs.gitlab.com/ee/install/requirements.html</a>)
그래서 실습할때 높은 사양의 EC2를 생성해주는것을 권장드립니다.
아래의 명령어를 순차적으로 입력해주겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl create ns gitlab
helm repo <span class="token function">add</span> gitlab https://charts.gitlab.io/
helm repo update
helm fetch gitlab/gitlab --untar</code></pre></div>
<p>다음 yaml 파일을 아래와 같이 수정해주시면 되겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">vim</span> ~/gitlab/values.yaml
----------------------
global:
  hosts:
    domain: <span class="token operator">&lt;</span>각자자신의도메인<span class="token operator">></span>             <span class="token comment"># 52줄</span>
    https: <span class="token boolean">true</span>

  ingress:                  <span class="token comment"># 66줄</span>
    configureCertmanager: <span class="token boolean">false</span>
    provider: aws
    class: alb
    annotations:
      alb.ingress.kubernetes.io/scheme: internet-facing
      alb.ingress.kubernetes.io/target-type: <span class="token function">ip</span>
      alb.ingress.kubernetes.io/listen-ports: <span class="token string">'[{"HTTPS":443}, {"HTTP":80}]'</span>
      alb.ingress.kubernetes.io/certificate-arn: <span class="token variable">${CERT_ARN}</span>
      alb.ingress.kubernetes.io/success-codes: <span class="token number">200</span>-399
    tls:
      enabled: <span class="token boolean">false</span>

certmanager:           <span class="token comment"># 834줄</span>
  installCRDs: <span class="token boolean">false</span>
  install: <span class="token boolean">false</span>
  rbac:
    create: <span class="token boolean">false</span>

nginx-ingress:
  enabled: <span class="token boolean">false</span>

prometheus:    <span class="token comment">#904줄</span>
  install: <span class="token boolean">false</span>

gitlab-runner:       <span class="token comment">#1129줄</span>
  install: <span class="token boolean">false</span>
----------------------

helm <span class="token function">install</span> gitlab gitlab/gitlab -f ~/gitlab/values.yaml --namespace gitlab --version <span class="token number">6.8</span>.1</code></pre></div>
<p>수정 참고용 이미지 첨부하겠습니다.
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 46.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAABJ0AAASdAHeZh94AAAA1ElEQVQoz5WQy27CQAxFs65f87CJM5RJB5GWiKpSUf//21CgbBBUxbLuwtbRtW+nGnOd63rDzPhkdWYpbw45KCA8DatGfZ0jJ7yF4R/OqpRHpAxsyHbVFSyqyIb48J1uZTnvjlaaBI1AAAhAgIx07T+cc+TcPq3uxAZRD1ZULaVIhIRIdB+j86LLAWPd2/Rt7z+6/dLpWN7mjzr2Ekb3uW0HH9w9hICI7t73fSmltcbMnSaRYdLgzIFYLi0iv6HB/dgu8wVm3ydtvJz5cg4ZHjE3P58AQTgg6MQkVukAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="GitLab.png"
        title="GitLab.png"
        src="/static/ee0ddc74d7ccd7670a9e531830300551/37523/GitLab.png"
        srcset="/static/ee0ddc74d7ccd7670a9e531830300551/e9ff0/GitLab.png 180w,
/static/ee0ddc74d7ccd7670a9e531830300551/f21e7/GitLab.png 360w,
/static/ee0ddc74d7ccd7670a9e531830300551/37523/GitLab.png 720w,
/static/ee0ddc74d7ccd7670a9e531830300551/302a4/GitLab.png 1080w,
/static/ee0ddc74d7ccd7670a9e531830300551/07a9c/GitLab.png 1440w,
/static/ee0ddc74d7ccd7670a9e531830300551/d2782/GitLab.png 1864w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<p>헬름 인스톨이 완료되었다면 아래 명령어를 통해 Gitlab 접속 비밀번호를 출력하실 수 있습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl get secrets -n gitlab gitlab-gitlab-initial-root-password --template<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>.data.password<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">|</span> base64 -d <span class="token punctuation">;</span><span class="token builtin class-name">echo</span></code></pre></div>
<p>다음 gitlab.자신의 도메인으로 접속하시고
ID : root
PW : 위의 명령어의 출력값
을 입력하셔서 접속테스트를 해보시면 되겠습니다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACCUlEQVQ4y5WR30tUQRTH7/8ZZSZKSfQWUi9lCha99dgvzRVKi0AwJFRQeoqoNsva1cBs9+6yqbOz996Z+3s+ce9uuyoqduDDmTv3nO9854y18HKZ2bk1nk2/5dGTBZ5OLTJdWKIws3wiL+bW8jw5tUhhZonZ2VUeFuZ5Nb+CNTJwg/6+MfovjHLx/G36zt1ioO8OQ5fGGewfO5arl+9xZXCC4aG7DA9NcG34PtdHHjA++hgrbW0S/SkSNIq07CLN6if07gahKBGJMlGz3M6ddbYfNzdJW1skcqubcX6CqmA1qiXm331m9cMXZL3Mvl1G1jZo2eu49W84tXWc2tdD+Ls/CPdLBHslwr0SsShj5Cax3May6xUm137x5uNvIiXQriBRDdA2qBroDqrW/TbKJvVsTIayUc0Kcm8H1bSx7GqVRnWbNFS0w2C6KzDmBDr/snj+fpebr3dY+S6wlFI4rofvB0RRTBRFOb7vE8cxaZrmGGNOJIwT/CghCCMsISRCtNBa5yL/8DyPJEnyhjQ1pwrSuVNWbykV4HltN8fFaUI9QXqCLRmglUYr1XbmernbIAgOOEwPcFgsqwmCkDAM8x5LewnSUYimxHVcxL5ASonjuKjOIRlat7PyQ6Kkd81s9lmt63p5vZVbNWD4v2i/9uGu/MrdoZ5hVsc9xME55oJHN4+eeja3PcG/nF4OX3QmuVcAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="gitlab_login.png"
        title="gitlab_login.png"
        src="/static/0c1d74dca9fe89ca1edbd38f1ec9d007/37523/gitlab_login.png"
        srcset="/static/0c1d74dca9fe89ca1edbd38f1ec9d007/e9ff0/gitlab_login.png 180w,
/static/0c1d74dca9fe89ca1edbd38f1ec9d007/f21e7/gitlab_login.png 360w,
/static/0c1d74dca9fe89ca1edbd38f1ec9d007/37523/gitlab_login.png 720w,
/static/0c1d74dca9fe89ca1edbd38f1ec9d007/98b29/gitlab_login.png 937w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<p>Gitlab에 접속하신 후 신규 유저를 생성하겠습니다.
권한은 Admin으로 설정해주시면 되겠습니다.</p>
<p>계정 생성 후 상단의 Edit 버튼을 눌러 비밀번호를 설정 해주도록 합니다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 81.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAABuklEQVQ4y5VTy27bMBDUH/dc9FPyC+k3FAVyy7GnBo3dQxvHVkyFT5HLJadYSnKclxsvMCDFJZfDmVVHRBDkzIgxIhGh1opS6jwWMDOYS5s/x7RnTAwdMnxkdNv7LX7drtGvbsE/f4BWN6hEWEKK7XY9jLFwzkNrA2stUiJo7RBDwNfrHT5frnHxfYNODuScwTkjC1OimRE3FpJ7esU0n3IT+1oLQmIMnuCEoXMB+35ACGNjYK1rT/fOYxxjW0spwXsPZx2cc63oIocAtQKY0IWRYCNAuSInRqYCaiO3sc1zQYwEo90hf4wUcwOljC7qR/y9+obkPUoFykvx529h1XS0DsPwCKUG7PfqFdvO/F7h+ssnjLv7ZoJo8jLkgGDRdoFoWufnLns6WTSDas5prQ+Jt/BeHKc6oRzG2AyIYwLnqec4H4HLyYuO0YnYzgRwrg0kZiyGzKMYtDA8xfTAUFpBhJ766vWty/rHCiZxz0Ap1QpLlFrAhd/U8L8FpWnFjL5/wN3dBmqvsNUPWKs/TwzPKhgjYkzPeumUyx948sTQaHNo0vpO0bNMERhr4Y0BbTcocZz+zjML/gP81+cFQXYUWwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="gitlab_passwd.png"
        title="gitlab_passwd.png"
        src="/static/7ad2e554468c8cdef4752e9f94ce80f7/37523/gitlab_passwd.png"
        srcset="/static/7ad2e554468c8cdef4752e9f94ce80f7/e9ff0/gitlab_passwd.png 180w,
/static/7ad2e554468c8cdef4752e9f94ce80f7/f21e7/gitlab_passwd.png 360w,
/static/7ad2e554468c8cdef4752e9f94ce80f7/37523/gitlab_passwd.png 720w,
/static/7ad2e554468c8cdef4752e9f94ce80f7/1b1d5/gitlab_passwd.png 876w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<p>비밀번호 설정후 Impersonation Token 을 클릭하고 표시된 모든 scopes를 선택하여 Token을 생성해주도록 하겠습니다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 95.55555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAACP0lEQVQ4y51Uu47bQAzUfwdImS6/kCptkBRpUl+RKh9wTXDx3dmyVqvVat+SVhOQstfyPYDDLUCQprWj4ZBUNQwGbdviYX+A299j+nuLWTbgsyzsUkoIIbL33sM5j5RGOBcwhoCbW4XPvx7w/Y9ApbVZ7+aMKS+IZON0BZJiQowR1jo45zj32qkGbWGMgZQdpJRohYCzDvM8YxxHTNPE3piAvrfQ2sHagGVZiuW8YM4Zc15Q9Wo4AUpQ+RSTeR+YDXnvPMdUaggr2KrIxZ+t0tri8SixP0oMPsH4EYNLxbSLUCbAx+nZ5ZesUmpALRQe65ZBd/uG44eDYN/IHkep0Q8WMURmSI25WCg5kqfSvYG1lkumUkduRuAmkPg552csXsoVhsNgoVSPuq75bZTsOsWNeM/hsdE9AR6ZITEjhivLdVx8yghjfhtgpwwavZZHGtDAErutJZrLceZRem65xFxyiBP20kA0ojALLHRkdszQe87xCHlfntvG9DwDxpSxa9b125ZZLviwkSBeAZ1nleJzo6qUMurO4nCoIVsJ3Wtordn3J6Pf1Ki+7zlPICv7dKU5yVWFOGMnDIQQEKIt27Bl8XTmigwnIGJXmkKA98IyILEoQO7it4O81Y9eTs3YbtAK2Fo0xwZKqasLW2bsnwBszxXg3XGA6rp1Dmm9WOyVwZkpfbpohF7bkDNoNY4ZyqzfOl80u+7sVvgL+9P/p3EpgDGM+HJT4+OPf/j0c4cP3+7w9ff6xc7L21fuDPof2iXEAeqTLcIAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="gitlab_token.png"
        title="gitlab_token.png"
        src="/static/849ef182b38e758389f28c3163a874c8/37523/gitlab_token.png"
        srcset="/static/849ef182b38e758389f28c3163a874c8/e9ff0/gitlab_token.png 180w,
/static/849ef182b38e758389f28c3163a874c8/f21e7/gitlab_token.png 360w,
/static/849ef182b38e758389f28c3163a874c8/37523/gitlab_token.png 720w,
/static/849ef182b38e758389f28c3163a874c8/59000/gitlab_token.png 917w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<p>아래 명령어를 통해 인스토어 스토어 볼륨이 있는 c5모든 타입의 스토리지 크기를 조회하실 수 있습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">aws ec2 describe-instance-types <span class="token punctuation">\</span> --filters <span class="token string">"Name=instance-type,Values=c5*"</span> <span class="token string">"Name=instance-storage-supported,Values=true"</span> <span class="token punctuation">\</span> --query <span class="token string">"InstanceTypes[].[InstanceType, InstanceStorageInfo.TotalSizeInGB]"</span> <span class="token punctuation">\</span> --output table</code></pre></div>
<p>저희가 배포한 c5d.large는 50Gib 만큼의 크기를 제공하고 있습니다.</p>
<p>먼저 각 워커노드의 스토리지를 확인해 보도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W1PIP</span> <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> -y nvme-cli
<span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W2PIP</span> <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> -y nvme-cli
<span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W1PIP</span> <span class="token function">sudo</span> nvme list
<span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W2PIP</span> <span class="token function">sudo</span> nvme list</code></pre></div>
<p>nvm list를 통해서 보면 2개의 스토리지를 확인하실 수 있습니다.</p>
<p><img src="nvm_list.png" alt="nvm_list.png"></p>
<p>하지만 AWS Management Console를 통해서 보면 EC2에 할당된 디스크중에 50Gib짜리 디스크는 찾아보실 수 없습니다.</p>
<p><img src="EC2_Storage.png" alt="EC2_Storage.png"></p>
<p>인스턴스 스토어에 대한 정보는 스토리지 정보에 출력이 되지 않는다는 점을 확인하실 수 있습니다.</p>
<p>아래의 명령어를 통해 파일시스템 생성 및 /data를 마운트 시킬 수 있습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W1PIP</span> <span class="token function">sudo</span> <span class="token function">mkfs</span> -t xfs /dev/nvme1n1
<span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W2PIP</span> <span class="token function">sudo</span> <span class="token function">mkfs</span> -t xfs /dev/nvme1n1
<span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W1PIP</span> <span class="token function">sudo</span> <span class="token function">mkdir</span> /data
<span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W2PIP</span> <span class="token function">sudo</span> <span class="token function">mkdir</span> /data
<span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W1PIP</span> <span class="token function">sudo</span> <span class="token function">mount</span> /dev/nvme1n1 /data
<span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W2PIP</span> <span class="token function">sudo</span> <span class="token function">mount</span> /dev/nvme1n1 /data
<span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W1PIP</span> <span class="token function">df</span> -hT -t ext4 -t xfs
<span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W2PIP</span> <span class="token function">df</span> -hT -t ext4 -t xfs</code></pre></div>
<h2 id="2ingress" style="position:relative;"><a href="#2ingress" aria-label="2ingress permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.Ingress</h2>
<p>지난주에 진행했던 실습과 비슷한 실습입니다.
각 EC2에 LB생성 권한을 부여해 LB를 생성하고 여기에 배포를 하여 외부에 오픈해주는 작업을 진행해 보겠습니다.</p>
<p>각 컨트롤플레인, 워커노드에 LB 생성 권한을 부여하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">aws iam attach-role-policy --policy-arn arn:aws:iam::<span class="token variable">$ACCOUNT_ID</span>:policy/AWSLoadBalancerControllerIAMPolicy --role-name nodes.<span class="token variable">$KOPS_CLUSTER_NAME</span>
aws iam attach-role-policy --policy-arn arn:aws:iam::<span class="token variable">$ACCOUNT_ID</span>:policy/AWSLoadBalancerControllerIAMPolicy --role-name nodes.<span class="token variable">$KOPS_CLUSTER_NAME</span></code></pre></div>
<p>아래 명령어를 통해 IAM 권한또한 부여하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">aws iam attach-role-policy --policy-arn arn:aws:iam::<span class="token variable">$ACCOUNT_ID</span>:policy/AllowExternalDNSUpdates --role-name masters.<span class="token variable">$KOPS_CLUSTER_NAME</span>
aws iam attach-role-policy --policy-arn arn:aws:iam::<span class="token variable">$ACCOUNT_ID</span>:policy/AllowExternalDNSUpdates --role-name nodes.<span class="token variable">$KOPS_CLUSTER_NAME</span> ```<span class="token punctuation">\</span>n</code></pre></div>
<p>다음 kops cluster edit을 통해</p>
<p>spec.cerManager.enable:ture
spec.LoadBalancerController.enable:true
spec.externalDns.provider:external-dns</p>
<p>를 추가해준 후 업데이트를 진행해주도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kops update cluster --yes <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token operator">&amp;&amp;</span> <span class="token function">sleep</span> <span class="token number">3</span> <span class="token operator">&amp;&amp;</span> kops rolling-update cluster</code></pre></div>
<p>실습을 진행하기 전 항상 IAM에 해당 권한이 정상적으로 부여가 되었는지 확인 후 진행하기를 권장드립니다.
권한이 부여되어있지 않다면 LB가 생성되지 않습니다..ㅜㅜ
<img src="IAM_Check.png" alt="IAM_Check.png"></p>
<p>IAM 권한을 확인하였다면 POD를 배포해보도록 하겠습니다.
아래 명령어를 통해 POD를 배포해보도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl apply -f ~/pkos/3/ingress1.yaml</code></pre></div>
<p>배포 후 AWS Management Console 에서 LB가 생성된것을 확인하실 수 있습니다.</p>
<p><img src="Load_Balancer.png" alt="Load_Balancer.png"></p>
<p>아래 명렁어를 통해 Ingress를 확인하실 수 있습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl describe ingress -n game-2048 ingress-2048</code></pre></div>
<p>아래 명렁어를 통해 외부에서 접속 가능한 게임의 URL 주소가 생성이 됩니다. 해당 URL에 접속해보도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl get ingress -n game-2048 ingress-2048 -o <span class="token assign-left variable">jsonpath</span><span class="token operator">=</span><span class="token punctuation">{</span>.status.loadBalancer.ingress<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>.hostname<span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{ print "Game URL = http://"$1 }'</span></code></pre></div>
<p>정상적으로 접속 됩니다!</p>
<p><img src="game_url.png" alt="game_url.png"></p>
<p>명령어를 통해 POD의 IP를 조회해보겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl get pod -n game-2048 -owide</code></pre></div>
<p><img src="LB_BP.png" alt="LB_BP.png"></p>
<p>위의 POD의 IP가 LB의 백엔드풀에 정상적으로 등록된것을 확인하실 수 있습니다.</p>
<p><img src="LB_BP2.png" alt="LB_BP2.png"></p>
<p>만약 해당 POD의 갯수를 늘려준다면 백엔드풀에 등록된 IP또한 계속해서 늘어나게 됩니다.</p>
<p>이후 아래 명령어를 통해 실습 리소스를 제거해주도록 합니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl delete ingress ingress-2048 -n game-2048
kubectl delete svc service-2048 -n game-2048 <span class="token operator">&amp;&amp;</span> kubectl delete deploy deployment-2048 -n game-2048 <span class="token operator">&amp;&amp;</span> kubectl delete ns game-2048</code></pre></div>
<p>다음 실습으로 넘어가겠습니다.</p>
<p>아래의 명렁어를 입력하여 본인이 지정한 도메인에 pod를 배포해보도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token assign-left variable">WEBDOMAIN</span><span class="token operator">=</span>albweb.korwoo.net
<span class="token assign-left variable">WEBDOMAIN</span><span class="token operator">=</span><span class="token variable">$WEBDOMAIN</span> envsubst <span class="token operator">&lt;</span> ~/pkos/3/ingress2.yaml <span class="token operator">|</span> kubectl apply -f -</code></pre></div>
<p>AWS Management Console에서 본인이 지정한 도메인이 등록되어있는것을 확인하실 수 있습니다.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 48.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkElEQVQoz5VSXW/UMBDMz4eHE4Veq9JW4lqQgH/BD+H1rrETu/FnnM9Bs3cH10csTSw7u7Mzu66+fP2B3befuL17wPvNR7zbfMLm6hqbqy0+bO9w8/CMm/snwfZ+h63sb3H9eYfbx2c8Pn1HhYuVckYZR/zvWvhxe+D3L1SdD5imGTFGtMagc07gQ0AIET5EOO4xwfsg/2JKCDEipYScM3LfI0ePYDUq5xzWdUXf90IyjiPmZQbWFdM0YeJ5nrHMM9q2Fch5WQSMkfO6YlmBisrOhM57hBBESSlF7qiACYTWDZTS6LpO4JwXF8MwCDljKkrnOhNaY2GtFaW8SzFhHCdRclRoTmhBd4wjYV+K7FXOvSTkEyErN00rBFTJPon1E+FLXaOuFRShNGqlYIwV0F3FBMqltUtCsUuF6Z9CYwx008j/pmnw+tpJHmMJUchBXFomYV3XUo0BTDg33lgrg+NdjAllGI7P5jQgomJSKYMMgsGmNdBa/63KobFPJFVK4XB4wX5PHMQy+xnkiR0L/QEMWfA7L5YhTAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="route53.png"
        title="route53.png"
        src="/static/903faa47dacc1ac1e0aff55bf6ec17dd/37523/route53.png"
        srcset="/static/903faa47dacc1ac1e0aff55bf6ec17dd/e9ff0/route53.png 180w,
/static/903faa47dacc1ac1e0aff55bf6ec17dd/f21e7/route53.png 360w,
/static/903faa47dacc1ac1e0aff55bf6ec17dd/37523/route53.png 720w,
/static/903faa47dacc1ac1e0aff55bf6ec17dd/302a4/route53.png 1080w,
/static/903faa47dacc1ac1e0aff55bf6ec17dd/07a9c/route53.png 1440w,
/static/903faa47dacc1ac1e0aff55bf6ec17dd/764d7/route53.png 1782w"
        sizes="(max-width: 720px) 100vw, 720px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
    </span></p>
<p>저는 제 모바일기기를 통하여 해당 도메인에 접속을하였고 접속이 성공적으로 되었습니다.</p>
<p><img src="ExternalDomain.jpg" alt="ExternalDomain.jpg"></p>
<p>과제1. Ingress를 이용하여 /mario에는 mario 게임 접속, /tetris에는 tetris게임 접속되게 설정 및 SSL 적용 하기</p>
<p><img src="mario.png" alt="mario.png">
<img src="tetris.png" alt="tetris.png">
<img src="route53_2.png" alt="route53_2.png"></p>
<p>현재 화면에서 보시면 mario는 SSL이 적용되어 있으나, tetris는 SSL 이 적용되어 있지 않습니다..
현재 원인 분석 중 입니다..ㅜㅜ</p>
<h2 id="3-k8s-스토리지" style="position:relative;"><a href="#3-k8s-%EC%8A%A4%ED%86%A0%EB%A6%AC%EC%A7%80" aria-label="3 k8s 스토리지 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. K8S 스토리지</h2>
<p>K8S 스토리지에서 가장 중요한 부분을 뽑자면 파드 내부의 데이터는 파드가 정지되면 모두 제거가 된다는 점 입니다.
따라서 보존이 필요한 중요한 데이터가 있다면 PV같은 Stateful 애플리케이션으로 데이터를 보존해야된다는 점을 기억해주시면 되겠습니다.</p>
<p>간단한 실습으로 데이터의 보존 여부를 체크해보겠습니다.
아래의 명령어를 통해 10초마다 1번씩 데이터를 기록하는 POD를 배포해보겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl apply -f ~/pkos/3/date-busybox-pod.yaml</code></pre></div>
<p>해당 POD를 배포하면 주기적으로 데이터를 기록하게 되는데</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl delete pod busybox
kubectl apply -f ~/pkos/3/date-busybox-pod.yaml</code></pre></div>
<p>위의 명령어를 통해서 POD를 제거하였다가 다시 생성하였을 시 이전에 기록한 데이터가 남아있는지 확인합니다.</p>
<p>당연하게도 이전의 데이터는 모두 제거가 되게 됩니다.</p>
<p>과제2. HostPath 실습 및 문제점 확인과 성능 측정</p>
<p>먼저 HostPath를 사용하는 PV/PVC 스토리지 클래스를 배포하도록 하겠습니다!
local path 정의 파일 다운로드</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> -s -O https://raw.githubusercontent.com/rancher/local-path-provisioner/v0.0.23/deploy/local-path-storage.yaml</code></pre></div>
<p>vim local-path-storage.yaml 을 통해 각자 Control Plane의 이름 입력해줍니다.</p>
<p><img src="InputMaster.png" alt="InputMaster.png"></p>
<p>아래 명령어를 입력해서 배포해보도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl apply -f local-path-storage.yaml</code></pre></div>
<p>다음으로 PV/PVC를 사용하는 POD를 생성해보도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl apply -f ~/pkos/3/localpath1.yaml
kubectl get pvc
kubectl describe pvc</code></pre></div>
<p>를 입력해서 PVC를 확인해보도록 하겠습니다.</p>
<p><img src="check_pvc.png" alt="check_pvc.png"></p>
<p>위에서 진행하였던 실습과 똑같이 10초마다 1번씩 데이터를 입력하는 POD를 배포해보도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl apply -f ~/pkos/3/localpath2.yaml</code></pre></div>
<p>각 워커노드에 Tool을 설치해주도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W1PIP</span> <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> -y tree jq sysstat
<span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W2PIP</span> <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> -y tree jq sysstat</code></pre></div>
<p>배포된 POD에는 out.txt라는 파일이 있을것입니다. 아래 명령어로 확인 가능합니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W1PIP</span> tree /data</code></pre></div>
<p><img src="out.png" alt="out.png"></p>
<p>이 파일은 10초에 1번씩 입력되는 데이터를 저장하는 경로 입니다.
이제 POD를 제거하면 과연 데이터가 살아있을지 확인해보도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl delete pod app
kubectl get pod,pv,pvc</code></pre></div>
<p><img src="data_alive.png" alt="data_alive.png"></p>
<p>POD가 죽었음에도 PV가 살아있으니 데이터또한 같이 살아 있습니다!</p>
<p>다음으로 kubestr &#x26; sar을 활용하여 모니터링 및 성능측정 확인을 진행해보도록 하겠습니다.</p>
<p>아래 명령어로 kubestr를 다운로드 받아주도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">wget</span> https://github.com/kastenhq/kubestr/releases/download/v0.4.36/kubestr_0.4.36_Linux_amd64.tar.gz
<span class="token function">tar</span> xvfz kubestr_0.4.36_Linux_amd64.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token function">mv</span> kubestr /usr/local/bin/ <span class="token operator">&amp;&amp;</span> <span class="token function">chmod</span> +x /usr/local/bin/kubestr</code></pre></div>
<p>아래 명령어로 모니터링을 걸어주도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W1PIP</span> iostat -xmdz <span class="token number">1</span> -p nvme1n1
<span class="token function">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class="token variable">$W2PIP</span> iostat -xmdz <span class="token number">1</span> -p nvme1n1</code></pre></div>
<p>모니터링에서 표시되는 정보 관련 내용입니다.
rrqm/s : 초당 드라이버 요청 대기열에 들어가 병합된 읽기 요청 횟수
wrqm/s : 초당 드라이버 요청 대기열에 들어가 병합된 쓰기 요청 횟수
r/s : 초당 디스크 장치에 요청한 읽기 요청 횟수
w/s : 초당 디스크 장치에 요청한 쓰기 요청 횟수
rMB/s : 초당 디스크 장치에서 읽은 메가바이트 수
wMB/s : 초당 디스크 장치에 쓴 메가바이트 수
await : 가장 중요한 지표, 평균 응답 시간. 드라이버 요청 대기열에서 기다린 시간과 장치의 I/O 응답시간을 모두 포함 (단위: ms)</p>
<p>아래 명령어를 입력하여 측정을 시작하겠습니다.(5~10분정도 소요됩니다.)</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> -s -O https://raw.githubusercontent.com/wikibook/kubepractice/main/ch10/fio-read.fio
kubestr fio -f fio-read.fio -s local-path --size 10G</code></pre></div>
<p><img src="kubestr.png" alt="kubestr.png"></p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> -s -O https://raw.githubusercontent.com/wikibook/kubepractice/main/ch10/fio-write.fio
kubestr fio -f fio-write.fio -s local-path --size 10G</code></pre></div>
<p><img src="kubestr2.png" alt="kubestr2.png"></p>
<p>과제3. AWS EBS를 PVC로 사용 후 온라인 볼륨 증가 해보기</p>
<p>아래 명령어를 입력하여 aws-ebs-csi를 확인해봅니다. 미리 설치되어 있다고합니다.(친절한 가시다님ㅜㅜ)</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl get pod -n kube-system -l app.kubernetes.io/instance<span class="token operator">=</span>aws-ebs-csi-driver</code></pre></div>
<p>스토리지 클래스 확인</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl get sc kops-csi-1-21 kops-ssd-1-17
kubectl describe sc kops-csi-1-21 <span class="token operator">|</span> <span class="token function">grep</span> Parameters
kubectl describe sc kops-ssd-1-17 <span class="token operator">|</span> <span class="token function">grep</span> Parameters</code></pre></div>
<p>아래 명령어를 입력해 워커노드의 EBS 볼륨을 확인해봅시다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">aws ec2 describe-volumes --filters <span class="token assign-left variable">Name</span><span class="token operator">=</span>tag:k8s.io/role/node,Values<span class="token operator">=</span><span class="token number">1</span> --output table</code></pre></div>
<p><img src="image_volume.png" alt="image_volume.png"></p>
<p>아래 명령어는 Pod에 추가한 EBS 볼륨을 확인하는 명령어 입니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">aws ec2 describe-volumes --filters <span class="token assign-left variable">Name</span><span class="token operator">=</span>tag:ebs.csi.aws.com/cluster,Values<span class="token operator">=</span>true --output table</code></pre></div>
<p><img src="ebs_volume.png" alt="ebs_volume.png"></p>
<p>아래 명령어로 PVC,POD를 생성해주도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl apply -f ~/pkos/3/awsebs-pvc.yaml
kubectl apply -f ~/pkos/3/awsebs-pod.yaml</code></pre></div>
<p>다음 아래 명령어를 통해 볼륨 정보를 확인하실 수 있습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl <span class="token builtin class-name">exec</span> -it app -- <span class="token function">sh</span> -c <span class="token string">'df -hT --type=ext4'</span></code></pre></div>
<p><img src="volume_check.png" alt="volume_check.png"></p>
<p>또한 AWS Management Console -> EC2 -> 볼륨으로 들어가면 4Gi의 볼륨이 생성된것을 확인하실 수 있습니다.</p>
<p><img src="console_ebs.png" alt="console_ebs.png"></p>
<p>아래의 명령어를 통해 4Gi -> 10Gi 로 용량을 증가시켜 준다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl patch pvc ebs-claim -p <span class="token string">'{"spec":{"resources":{"requests":{"storage":"10Gi"}}}}'</span></code></pre></div>
<p>용량이 증가된것을 확인하실 수 있습니다.</p>
<p><img src="console_ebs2.png" alt="console_ebs2.png"></p>
<p>혹은 아래 명렁어를 통해서도 확인하실 수 있습니다!</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl <span class="token builtin class-name">exec</span> -it app -- <span class="token function">sh</span> -c <span class="token string">'df -hT --type=ext4'</span></code></pre></div>
<p>과제4. AWS Volume Snapshot 실습</p>
<p>kops edit 을 통해 아래 표시된 부분을 추가해준후 업데이트 해주도록 하겠습니다.</p>
<p><img src="snapshotcontroller.png" alt="snapshotcontroller.png"></p>
<p>아래 명령어를 통해 업데이트가 되었는지 확인해보겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl get crd <span class="token operator">|</span> <span class="token function">grep</span> volumesnapshot</code></pre></div>
<p><img src="volume_snapshot.png" alt="volume_snapshot.png"></p>
<p>아래 명령어를 통해 vsclass 생성해주도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl apply -f https://raw.githubusercontent.com/kubernetes-sigs/aws-ebs-csi-driver/master/examples/kubernetes/snapshot/manifests/classes/snapshotclass.yaml</code></pre></div>
<p>PVC, POD 생성 명령어</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl apply -f ~/pkos/3/awsebs-pvc.yaml
kubectl apply -f ~/pkos/3/awsebs-pod.yaml</code></pre></div>
<p>아래 명령어를 통해 볼륨 스냅샷을 생성해주도록 하겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl apply -f ~/pkos/3/ebs-volume-snapshot.yaml</code></pre></div>
<p>볼륨 스냅샷을 확인하는 명령어 입니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl get volumesnapshot</code></pre></div>
<p><img src="volume_snapshot_2.png" alt="volume_snapshot_2.png"></p>
<p>완료가 되었다면 복원을 해보겠습니다.
임의로 app &#x26; pvc를 제거하여 이슈를 만들어보겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl delete pod app <span class="token operator">&amp;&amp;</span> kubectl delete pvc ebs-claim</code></pre></div>
<p>이후 스냅샷에서 PVC로 복원을 해보겠습니다.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">kubectl apply -f ~/pkos/3/ebs-snapshot-restored-claim.yaml
kubectl apply -f ~/pkos/3/ebs-snapshot-restored-pod.yaml</code></pre></div>
<p><img src="snapshot_recovery.png" alt="snapshot_recovery.png"></p>
<p>완료되어 이전에 입력되었던 데이터가 그대로 살아있는것을 확인하실 수 있습니다.</p>
<div class="table-of-contents">
<ul>
<li><a href="#1argocd">1.ArgoCD??</a></li>
<li><a href="#2-harbor-container-registry-%EA%B5%AC%EC%B6%95">2. Harbor Container Registry 구축</a></li>
<li><a href="#2ingress">2.Ingress</a></li>
<li><a href="#3-k8s-%EC%8A%A4%ED%86%A0%EB%A6%AC%EC%A7%80">3. K8S 스토리지</a></li>
</ul>
</div>
<div class="gatsby-highlight" data-language="toc"><pre class="language-toc"><code class="language-toc"></code></pre></div></div></div><div class="post-navigator"><div class="post-navigator-card-wrapper"><a class="post-card prev" href="/Kubernetes/Gasida_Study_homework_3/"><div class="direction">이전 글</div><div class="title">Gasida Kubernetes Study 3주차</div></a></div><div class="post-navigator-card-wrapper"></div></div></main><footer class="page-footer-wrapper"><p class="page-footer">© <!-- -->2023<!-- --> <a href="https://www.github.com">장우석</a> powered by<a href="https://github.com/zoomKoding/zoomkoding-gatsby-blog"> zoomkoding-gatsby-blog</a></p></footer><div class="dark-mode-button-wrapper"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium dark-mode-button css-1yxmbwk" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeLarge dark-mode-icon css-6flbmm" focusable="false" viewBox="0 0 24 24" aria-hidden="true" data-testid="DarkModeIcon"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"></path></svg></button></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/Kubernetes/Gasida_Study_homework_4/";window.___webpackCompilationHash="be3df79066420fcf8434";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-9b356b5dc44213e24f34.js"],"app":["/app-0f9980b68d4a425d9725.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-0b8a70f65d0cff4a7a25.js"],"component---src-pages-404-js":["/component---src-pages-404-js-bc51420b294b9123f97d.js"],"component---src-pages-about-js":["/component---src-pages-about-js-39e57401fb032eafb2fb.js"],"component---src-pages-index-js":["/component---src-pages-index-js-0a6bbda26eb501968935.js"],"component---src-templates-blog-template-js":["/component---src-templates-blog-template-js-e3a4bb3c9603d1ed8af7.js"],"component---src-templates-category-template-js":["/component---src-templates-category-template-js-a0af7e239c6cf28d9bb9.js"]};/*]]>*/</script><script src="/polyfill-9b356b5dc44213e24f34.js" nomodule=""></script><script src="/component---src-templates-blog-template-js-e3a4bb3c9603d1ed8af7.js" async=""></script><script src="/f9d3028dbef90a6e9b8db85387d63dd9f4edf538-07f7733d8d97d93498cb.js" async=""></script><script src="/app-0f9980b68d4a425d9725.js" async=""></script><script src="/framework-043f1197be387cb18d15.js" async=""></script><script src="/webpack-runtime-121beace0d37eb670f34.js" async=""></script></body></html>