{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/Kubernetes/Gasida_Study_homework_3/",
    "result": {"data":{"cur":{"id":"94fc2da6-5859-5681-994b-46b2d79e6c0f","html":"<p>가시다님 스터디 : <a href=\"https://www.notion.so/gasidaseo/23-7635cc4f02c04954a3260b317588113e\">https://www.notion.so/gasidaseo/23-7635cc4f02c04954a3260b317588113e</a></p>\n<h2 id=\"1스토리지\" style=\"position:relative;\"><a href=\"#1%EC%8A%A4%ED%86%A0%EB%A6%AC%EC%A7%80\" aria-label=\"1스토리지 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.스토리지</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABm0lEQVQoz4WR627aQBCFef+naBqRVGqlPEElGhSghIAB3/D6GjCsL0CwMbTcvsqOml9FHeloZ460n87u1LIsI8+3rNdrVqsVxXZLkiRUfpaz3+0pioI8y6qzKLYcDgeOxyOnU6kT5/OZ4/FQ9bXg1cF1LcJ5gIxmRHHIMk2IE8lCTpEyxPMEszAgXcYkSYyUkrf1ms1mQ57n7Pc70vQ9RE0XLYTfw7A7WG4Xw26TruYEoYbldXFeX3CnfYT/XHn/q9rI+IHpdBiojQqmiyfChYdw+5U/NpuokycmbgfhDarnXS6Xq6opWgNdtBnqj2hWC3XSZBH52N6gguhWC0O0q972lQpYVnn5SsImptNF0R4xxE/KL5BRgDtVMZwultevZLrPeNPxB+gq0Bt/IhJ1YnFLNLlhZtYJ5YzA+Y60PiNFnci6JRI3+G6b03vA60Cl/xVt9MCg94Wx8o3x6IF5NMWaNFCVe4a9O0Yvd2jKPZZo85dzFbh8S7E9m6E6wvEdyvnX7x15kTGTIaqhoZo6i1iSF5sS9bGAfwH/AGhVnNs01MiRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Instance_Storage.png\"\n        title=\"Instance_Storage.png\"\n        src=\"/static/12c3e014bfbb4f5c8196afe93ea3abea/37523/Instance_Storage.png\"\n        srcset=\"/static/12c3e014bfbb4f5c8196afe93ea3abea/e9ff0/Instance_Storage.png 180w,\n/static/12c3e014bfbb4f5c8196afe93ea3abea/f21e7/Instance_Storage.png 360w,\n/static/12c3e014bfbb4f5c8196afe93ea3abea/37523/Instance_Storage.png 720w,\n/static/12c3e014bfbb4f5c8196afe93ea3abea/6bfd0/Instance_Storage.png 1011w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>아래 명령어를 통해 인스토어 스토어 볼륨이 있는 c5모든 타입의 스토리지 크기를 조회하실 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws ec2 describe-instance-types <span class=\"token punctuation\">\\</span> --filters <span class=\"token string\">\"Name=instance-type,Values=c5*\"</span> <span class=\"token string\">\"Name=instance-storage-supported,Values=true\"</span> <span class=\"token punctuation\">\\</span> --query <span class=\"token string\">\"InstanceTypes[].[InstanceType, InstanceStorageInfo.TotalSizeInGB]\"</span> <span class=\"token punctuation\">\\</span> --output table</code></pre></div>\n<p>저희가 배포한 c5d.large는 50Gib 만큼의 크기를 제공하고 있습니다.</p>\n<p>먼저 각 워커노드의 스토리지를 확인해 보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W1PIP</span> <span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> -y nvme-cli\r\n<span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W2PIP</span> <span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> -y nvme-cli\r\n<span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W1PIP</span> <span class=\"token function\">sudo</span> nvme list\r\n<span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W2PIP</span> <span class=\"token function\">sudo</span> nvme list</code></pre></div>\n<p>nvm list를 통해서 보면 2개의 스토리지를 확인하실 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAh0lEQVQI1z2PUQ6EIAxEvYKKgEBcWsDI/Q84m2nW/Zi8SQOvsEgucCHhUyukVpRSUH/MOeO6Luvee+spJYQQsO87tm2z+XEc1snlFoU/C7Q1zOdB792iqhARtNZM5JwzWYzRFpAUkwxlPLPcfSCeCaKKOafJxhh/IcmXrutqFynlDzhjf/NKv1IRT1SyLB+BAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"nvm_list.png\"\n        title=\"nvm_list.png\"\n        src=\"/static/ffc128c6dcb73798f062ef69639e1681/37523/nvm_list.png\"\n        srcset=\"/static/ffc128c6dcb73798f062ef69639e1681/e9ff0/nvm_list.png 180w,\n/static/ffc128c6dcb73798f062ef69639e1681/f21e7/nvm_list.png 360w,\n/static/ffc128c6dcb73798f062ef69639e1681/37523/nvm_list.png 720w,\n/static/ffc128c6dcb73798f062ef69639e1681/302a4/nvm_list.png 1080w,\n/static/ffc128c6dcb73798f062ef69639e1681/07a9c/nvm_list.png 1440w,\n/static/ffc128c6dcb73798f062ef69639e1681/6fa81/nvm_list.png 1856w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>하지만 AWS Management Console를 통해서 보면 EC2에 할당된 디스크중에 50Gib짜리 디스크는 찾아보실 수 없습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABJUlEQVQoz2VRB27DMAz0/1+Z1k4RJ9EeHpJyxdGRG6AECImbdxyU1rDOwRgL7z2Ui1AuIMaAlDNCjMg5Y993lFJEa60otZz2pw5KabDpsix4vV6iFDbojbqvvzFGbNt++j7rBq0NnPNitNbOILeoraG97R6jbNuGWhs+pdcNIUT4cMBb1xUpvd+cZcNt3xFTQqlVUCzrKs05kH7msIZ+gXx/anzfnrgpC20sxnGCMQbzPEMpBW00LtcLQgi4Px4Ypwm3eYbWGsZapJSEMiIl3wL5axwxXX+k6JiY/imR9I3IIXPJLzfNeYHzXuyBcNm5B7k+4fJPH5sRNq9KO8Z0XppckgYO4GLMG+hkAnmh0qZ2njiQVBjrZNhxkCpHKTK0/B2yNfwCEBJuCkHD/hUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"EC2_Storage.png\"\n        title=\"EC2_Storage.png\"\n        src=\"/static/efe6ce1c54a77ba30a28e6a28ea97833/37523/EC2_Storage.png\"\n        srcset=\"/static/efe6ce1c54a77ba30a28e6a28ea97833/e9ff0/EC2_Storage.png 180w,\n/static/efe6ce1c54a77ba30a28e6a28ea97833/f21e7/EC2_Storage.png 360w,\n/static/efe6ce1c54a77ba30a28e6a28ea97833/37523/EC2_Storage.png 720w,\n/static/efe6ce1c54a77ba30a28e6a28ea97833/302a4/EC2_Storage.png 1080w,\n/static/efe6ce1c54a77ba30a28e6a28ea97833/07a9c/EC2_Storage.png 1440w,\n/static/efe6ce1c54a77ba30a28e6a28ea97833/93582/EC2_Storage.png 1524w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>인스턴스 스토어에 대한 정보는 스토리지 정보에 출력이 되지 않는다는 점을 확인하실 수 있습니다.</p>\n<p>아래의 명령어를 통해 파일시스템 생성 및 /data를 마운트 시킬 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W1PIP</span> <span class=\"token function\">sudo</span> <span class=\"token function\">mkfs</span> -t xfs /dev/nvme1n1\r\n<span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W2PIP</span> <span class=\"token function\">sudo</span> <span class=\"token function\">mkfs</span> -t xfs /dev/nvme1n1\r\n<span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W1PIP</span> <span class=\"token function\">sudo</span> <span class=\"token function\">mkdir</span> /data\r\n<span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W2PIP</span> <span class=\"token function\">sudo</span> <span class=\"token function\">mkdir</span> /data\r\n<span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W1PIP</span> <span class=\"token function\">sudo</span> <span class=\"token function\">mount</span> /dev/nvme1n1 /data\r\n<span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W2PIP</span> <span class=\"token function\">sudo</span> <span class=\"token function\">mount</span> /dev/nvme1n1 /data\r\n<span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W1PIP</span> <span class=\"token function\">df</span> -hT -t ext4 -t xfs\r\n<span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W2PIP</span> <span class=\"token function\">df</span> -hT -t ext4 -t xfs</code></pre></div>\n<h2 id=\"2ingress\" style=\"position:relative;\"><a href=\"#2ingress\" aria-label=\"2ingress permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.Ingress</h2>\n<p>지난주에 진행했던 실습과 비슷한 실습입니다.\r\n각 EC2에 LB생성 권한을 부여해 LB를 생성하고 여기에 배포를 하여 외부에 오픈해주는 작업을 진행해 보겠습니다.</p>\n<p>각 컨트롤플레인, 워커노드에 LB 생성 권한을 부여하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws iam attach-role-policy --policy-arn arn:aws:iam::<span class=\"token variable\">$ACCOUNT_ID</span>:policy/AWSLoadBalancerControllerIAMPolicy --role-name nodes.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span>\r\naws iam attach-role-policy --policy-arn arn:aws:iam::<span class=\"token variable\">$ACCOUNT_ID</span>:policy/AWSLoadBalancerControllerIAMPolicy --role-name nodes.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span></code></pre></div>\n<p>아래 명령어를 통해 IAM 권한또한 부여하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws iam attach-role-policy --policy-arn arn:aws:iam::<span class=\"token variable\">$ACCOUNT_ID</span>:policy/AllowExternalDNSUpdates --role-name masters.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span>\r\naws iam attach-role-policy --policy-arn arn:aws:iam::<span class=\"token variable\">$ACCOUNT_ID</span>:policy/AllowExternalDNSUpdates --role-name nodes.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span> ```<span class=\"token punctuation\">\\</span>n</code></pre></div>\n<p>다음 kops cluster edit을 통해</p>\n<p>spec.cerManager.enable:ture\r\nspec.LoadBalancerController.enable:true\r\nspec.externalDns.provider:external-dns</p>\n<p>를 추가해준 후 업데이트를 진행해주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kops update cluster --yes <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">echo</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">sleep</span> <span class=\"token number\">3</span> <span class=\"token operator\">&amp;&amp;</span> kops rolling-update cluster</code></pre></div>\n<p>실습을 진행하기 전 항상 IAM에 해당 권한이 정상적으로 부여가 되었는지 확인 후 진행하기를 권장드립니다.\r\n권한이 부여되어있지 않다면 LB가 생성되지 않습니다..ㅜㅜ\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABU0lEQVQoz6VRy26DMBDkn0ND2yTkkFcv6V9SEbABAwEDNlPNRkRtr10x2vUynn04eNufEW4OCF+3WK03CKPffv2+R7Q74WV3xjq+CKL4gtXmiHBzRLT/QHz6RHy6Ynu4ImjbFipXWMzjfxZM0wQ/z/DeYxhHDPYOa3v0fY/eWtzvd4mttXDewzknIH+eZzjnJfYSOwRVVYkQ5pkfTFWirCrYYcQ4PsCi9IsYz13XwRiDYRgkbppGhAPTdhLQWJEkpTXKspS4bhohL50SFGAjSinx5N5uN5ki6O2AybnH/rwXQpIkQlBKQ2slFwmtNbIsQ57nKIpCzmmaPv+zmIxMZRHk2N6jbnukRQdtLDo7SecCQEZnx8/cH8grL4JMtG2DLFdIswKVqVHXj5EJcrkGdrfkiLquRUN2yDZZdTG2/pUkMlpljAhwCl4iKLDs8SeY4yt/A7+fnxqKjB04AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"IAM_Check.png\"\n        title=\"IAM_Check.png\"\n        src=\"/static/57a292d75a61f385cbb26bb82cc8d10a/37523/IAM_Check.png\"\n        srcset=\"/static/57a292d75a61f385cbb26bb82cc8d10a/e9ff0/IAM_Check.png 180w,\n/static/57a292d75a61f385cbb26bb82cc8d10a/f21e7/IAM_Check.png 360w,\n/static/57a292d75a61f385cbb26bb82cc8d10a/37523/IAM_Check.png 720w,\n/static/57a292d75a61f385cbb26bb82cc8d10a/302a4/IAM_Check.png 1080w,\n/static/57a292d75a61f385cbb26bb82cc8d10a/07a9c/IAM_Check.png 1440w,\n/static/57a292d75a61f385cbb26bb82cc8d10a/5c684/IAM_Check.png 1829w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>IAM 권한을 확인하였다면 POD를 배포해보도록 하겠습니다.\r\n아래 명령어를 통해 POD를 배포해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f ~/pkos/3/ingress1.yaml</code></pre></div>\n<p>배포 후 AWS Management Console 에서 LB가 생성된것을 확인하실 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABG0lEQVQoz51QXUsDMRDMfy+09qS9imJbBH2w+Bv8FfrugyBC2/vI3WWTXBLvYGSXPqj4ogvDLhN2ZifqcnOHze0Oy4srTGbnmEwzwSxbYjpfIFuskK3WmK82mH/t+Vr6WX6NfLtDfvOA5fYeCj/KWouUPvCn2j8BL4/A/hmq7Tp47xFihNYNyqqC1hrGEDpjQNaKiSECkRXeeY++72Gtk9nVe9jjK9rjG1QfAsZxxDAMIky+hyaPPiZ0XQciQggBzp2WnRNhFuQD2DSkAT4OIB+gmqZFjFFi1lrjUNZ4P5QyF2WJY1FI58urukZVVcJxL4pS3phnc2MMFLtzsSMvWb7AkkQUnOJ+w2/cCYpPTimBo7MTC8p/WfsvfALowQL93W36HAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Load_Balancer.png\"\n        title=\"Load_Balancer.png\"\n        src=\"/static/2b298198fcc1666b92844b5cd0bfd277/37523/Load_Balancer.png\"\n        srcset=\"/static/2b298198fcc1666b92844b5cd0bfd277/e9ff0/Load_Balancer.png 180w,\n/static/2b298198fcc1666b92844b5cd0bfd277/f21e7/Load_Balancer.png 360w,\n/static/2b298198fcc1666b92844b5cd0bfd277/37523/Load_Balancer.png 720w,\n/static/2b298198fcc1666b92844b5cd0bfd277/302a4/Load_Balancer.png 1080w,\n/static/2b298198fcc1666b92844b5cd0bfd277/07a9c/Load_Balancer.png 1440w,\n/static/2b298198fcc1666b92844b5cd0bfd277/e216b/Load_Balancer.png 1904w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>아래 명렁어를 통해 Ingress를 확인하실 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl describe ingress -n game-2048 ingress-2048</code></pre></div>\n<p>아래 명렁어를 통해 외부에서 접속 가능한 게임의 URL 주소가 생성이 됩니다. 해당 URL에 접속해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get ingress -n game-2048 ingress-2048 -o <span class=\"token assign-left variable\">jsonpath</span><span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>.status.loadBalancer.ingress<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>.hostname<span class=\"token punctuation\">}</span> <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'{ print \"Game URL = http://\"$1 }'</span></code></pre></div>\n<p>정상적으로 접속 됩니다!</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABWUlEQVQoz52RWU/CQBSF+f8/xcim4sLWSEQom0KEqNgUqbQsbacbtJ0Wj5lhURN9gIeTk5t77zdnchM0cOCvLHiusZfr6NwD3+ZaLk2slgRh4IBSD8F2h/WYLz2TO7FUJELfBA1MRAFBFJK9Bysd08kQ2scrXFvDZ+zCnMmQ+g1Y+hgxtbDbpQHhHocWEqwIfcKbO0WhBYdo6HdFPHXrmE9lRNTGfDJETyxB1yTE1NnOk1+e2NC/tXmVwPcWsAwFtqHAnI+gT2UoUg8P1Wss1CHiyNnP/tSfQDa8UN/QKGchljLcm8IZ2rcXaFdymCkvxwFr+SRawjm693nUCynUCkncXZ1gIvexjl2EvnE4cNAQMH7u8IRiMc2h6miwBR6YsF5Mo1nOolO55DBWV69PoY6OTMgA7KsbpdEoZ9ASMtDeB1hHRyRkqZjYUWqFFLrVHKTHG+iT/4/yBXxd58iWhIyFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"game_url.png\"\n        title=\"game_url.png\"\n        src=\"/static/0f802fbb586b9d1ca39900d20b63169d/37523/game_url.png\"\n        srcset=\"/static/0f802fbb586b9d1ca39900d20b63169d/e9ff0/game_url.png 180w,\n/static/0f802fbb586b9d1ca39900d20b63169d/f21e7/game_url.png 360w,\n/static/0f802fbb586b9d1ca39900d20b63169d/37523/game_url.png 720w,\n/static/0f802fbb586b9d1ca39900d20b63169d/302a4/game_url.png 1080w,\n/static/0f802fbb586b9d1ca39900d20b63169d/07a9c/game_url.png 1440w,\n/static/0f802fbb586b9d1ca39900d20b63169d/3e992/game_url.png 1902w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>명령어를 통해 POD의 IP를 조회해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get pod -n game-2048 -owide</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 6.666666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAQklEQVQI1z2JOwrAMAzFegQvNgE7/uCG3P+EryRDB4GQnt0Ny8a7FqoK7o6IQGZCVTHGgJldZ+b/nz7nhIhcjhMRPitHGn9lEV2pAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"LB_BP.png\"\n        title=\"LB_BP.png\"\n        src=\"/static/f1c1241feb033a61199490793283e1cd/37523/LB_BP.png\"\n        srcset=\"/static/f1c1241feb033a61199490793283e1cd/e9ff0/LB_BP.png 180w,\n/static/f1c1241feb033a61199490793283e1cd/f21e7/LB_BP.png 360w,\n/static/f1c1241feb033a61199490793283e1cd/37523/LB_BP.png 720w,\n/static/f1c1241feb033a61199490793283e1cd/302a4/LB_BP.png 1080w,\n/static/f1c1241feb033a61199490793283e1cd/07a9c/LB_BP.png 1440w,\n/static/f1c1241feb033a61199490793283e1cd/92bb4/LB_BP.png 1824w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>위의 POD의 IP가 LB의 백엔드풀에 정상적으로 등록된것을 확인하실 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaUlEQVQoz4WRb0/CMBDG981NTNQYhBkBA0Ii8aP5wjBGx9r137XdHnMFpq+0yZNrr5fnftcW5WqHl9U7ps9L3D1McHN7j8dJicenMsdpOcdsvsZ0vsFssUG52J7jcjtq8bbD6+YD8/UOBX6tlCL+X8Oft4VSCs57OOdQHQ7QxoAoIKWEGCOOooGjgJB6eAqwzo13IUZ01qM1Ho5izhfGmOwcQoBoBKy1GIYzBQWCpQTjA07KwKchE7IZr77vMfT9OF02ZAPuxIZHIeCI4JnYe0gtQSHAOwunVTbiPFNy/c8+5shTFl3XwVibu1V1jc+vCvuqQi0E6qMYY9O2aJWCvKiVctSJdbnPhESUx+T33O/3ONQ1uk5nCibMkWjU9ay1yVQs0TSQUqHotM50LN4zLRPw2ObS7DoOG3FeKjmaa60zCF2equBCfhs25A/iJHdjYi7ivHMeQjToUw+KhFpW5w8ZhvOPpzSevwF8m6X2Zc710gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"LB_BP2.png\"\n        title=\"LB_BP2.png\"\n        src=\"/static/e1e98acfa0bccaea67c7da82fda3088b/37523/LB_BP2.png\"\n        srcset=\"/static/e1e98acfa0bccaea67c7da82fda3088b/e9ff0/LB_BP2.png 180w,\n/static/e1e98acfa0bccaea67c7da82fda3088b/f21e7/LB_BP2.png 360w,\n/static/e1e98acfa0bccaea67c7da82fda3088b/37523/LB_BP2.png 720w,\n/static/e1e98acfa0bccaea67c7da82fda3088b/302a4/LB_BP2.png 1080w,\n/static/e1e98acfa0bccaea67c7da82fda3088b/07a9c/LB_BP2.png 1440w,\n/static/e1e98acfa0bccaea67c7da82fda3088b/a95f7/LB_BP2.png 1853w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>만약 해당 POD의 갯수를 늘려준다면 백엔드풀에 등록된 IP또한 계속해서 늘어나게 됩니다.</p>\n<p>이후 아래 명령어를 통해 실습 리소스를 제거해주도록 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl delete ingress ingress-2048 -n game-2048\r\nkubectl delete svc service-2048 -n game-2048 <span class=\"token operator\">&amp;&amp;</span> kubectl delete deploy deployment-2048 -n game-2048 <span class=\"token operator\">&amp;&amp;</span> kubectl delete ns game-2048</code></pre></div>\n<p>다음 실습으로 넘어가겠습니다.</p>\n<p>아래의 명렁어를 입력하여 본인이 지정한 도메인에 pod를 배포해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">WEBDOMAIN</span><span class=\"token operator\">=</span>albweb.korwoo.net\r\n<span class=\"token assign-left variable\">WEBDOMAIN</span><span class=\"token operator\">=</span><span class=\"token variable\">$WEBDOMAIN</span> envsubst <span class=\"token operator\">&lt;</span> ~/pkos/3/ingress2.yaml <span class=\"token operator\">|</span> kubectl apply -f -</code></pre></div>\n<p>AWS Management Console에서 본인이 지정한 도메인이 등록되어있는것을 확인하실 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB40lEQVQoz11Ry2pUQRDtH3AzimiEoGYhKCQLv0AQIQmI+QeR6MosRAMuREXMmIXGvb8jOMJIPkAkc999X9P31bfv40jVnWSMDYeurq46dapKvDs4wtsPh9h//Qa3Hz3Dtc1drG4/xej+E1y49xijB7u4tP0cF7f2GKP/sbmHyw9f4OrOS6zsvILAP2fr2zHufJ7i7tdfWD+aMja+THHr8CfWPk2wNv6B6wdL3BhPcHM8werH4X3l/XeIWBVA3yPLMsxcH0GiMPMkYpUjUTlknMKPUngL0P8f28dvy4Ufz0H5p6A/kec5qyvLEmqeAn0HU+ul7K4dgH7h6OG7DmYnJzBan/k4tDEQKlsSRkmCSmvIMERZVmiahv1FWULXNZqmhTENPD+A47rwA8m25/mI4pjjRFlVZ4QxEVYVByil0LYttNYcWNc1v6mIlJKLhmE02DIcCIsSoiiKc4R0W5aFJE1hjOF3nheskAjJZ9sOFyUiQiAl4jgBiRN1bZiQlBEJ3ZRg2zYvqqo08qI4p5DatR0XDoFs22FSyhUqy1Abg67rQAsiZ7Bog0gGlRXHnBKGYYi5UuyncVCXNBrqQlASHQrOshxUgKpalo00nfNclMqGxWjNBV3X44WEUcSgeSZJykv5CxcOw8BDqakUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"route53.png\"\n        title=\"route53.png\"\n        src=\"/static/e3bc2a19b8f0126efc47ae811db7a369/37523/route53.png\"\n        srcset=\"/static/e3bc2a19b8f0126efc47ae811db7a369/e9ff0/route53.png 180w,\n/static/e3bc2a19b8f0126efc47ae811db7a369/f21e7/route53.png 360w,\n/static/e3bc2a19b8f0126efc47ae811db7a369/37523/route53.png 720w,\n/static/e3bc2a19b8f0126efc47ae811db7a369/302a4/route53.png 1080w,\n/static/e3bc2a19b8f0126efc47ae811db7a369/07a9c/route53.png 1440w,\n/static/e3bc2a19b8f0126efc47ae811db7a369/b5cfe/route53.png 1767w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>저는 제 모바일기기를 통하여 해당 도메인에 접속을하였고 접속이 성공적으로 되었습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 214.44444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAArABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAECAwQF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQD/2gAMAwEAAhADEAAAAe5BUjqERnr0xGwkQ1MZDK//xAAdEAACAgIDAQAAAAAAAAAAAAABAgARITISICIx/9oACAEBAAEFAsWWojIZqJ9FcK+0TVls8IPlSuv/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AV//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AV//xAAdEAABAgcAAAAAAAAAAAAAAAAAATEQICEwQWGR/9oACAEBAAY/AtlY57Ig49j/xAAcEAADAAIDAQAAAAAAAAAAAAAAAREhMRAgcYH/2gAIAQEAAT8hoFSp/B1RLZUWSVZXwLBVv038pNYQoeokg2I6/wD/2gAMAwEAAgADAAAAENMVfzjv/8QAFhEBAQEAAAAAAAAAAAAAAAAAERAg/9oACAEDAQE/ECOP/8QAFhEBAQEAAAAAAAAAAAAAAAAAEQAQ/9oACAECAQE/EGYwi//EAB4QAQACAgMAAwAAAAAAAAAAAAEAETFBIVGxEGGh/9oACAEBAAE/EKGCCOoFs6vCDGBowKXhXIxsKwrAO4Y4Cy3bnufR15N6zPd7ESY1wkG78JXWuNkrGi7aq4Gupv5//9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ExternalDomain.jpg\"\n        title=\"ExternalDomain.jpg\"\n        src=\"/static/e72f25624c600bddedda98955389a7b0/80e3c/ExternalDomain.jpg\"\n        srcset=\"/static/e72f25624c600bddedda98955389a7b0/4ec73/ExternalDomain.jpg 180w,\n/static/e72f25624c600bddedda98955389a7b0/158ba/ExternalDomain.jpg 360w,\n/static/e72f25624c600bddedda98955389a7b0/80e3c/ExternalDomain.jpg 720w,\n/static/e72f25624c600bddedda98955389a7b0/47311/ExternalDomain.jpg 1080w,\n/static/e72f25624c600bddedda98955389a7b0/644c5/ExternalDomain.jpg 1440w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>과제1. Ingress를 이용하여 /mario에는 mario 게임 접속, /tetris에는 tetris게임 접속되게 설정 및 SSL 적용 하기</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABtklEQVQoz43S30tTcRjH8f0l/R/dFHXlTTfhVV2Uwy4WMyGZURaOwTZQm3MarezH5o+OVBdjbsw8FdvaimxyoIW1FHbaTnY8Z5trIUF6vu9QqEs9D3zguXle8IHH8X2rTVVr8lnVqVR1aloHVbeomztomybfNAO1bvBjq4lptmg0W5iNbTZ142Dfj9Fo0f7Zod35heNOZpfJzC7hu1+JzJUJP00SnQkzOpJlfHGHsRTM5/ewO45nWZVUxs9tr5+I340veJHQ5AA3PCFi9weZiK2yuNIG/iAECCEOjePjuyke3ztJIDKENHaW0M1TLKQfEY0PE3AdIz48xVpNBfHbHrjy0sv71wGUF7d4FXeSSiQoFvKUkn2k593kstOsKRLCsg4q7R8dWlnJB0lKfYz3d5HxdVGM9ZNLR1iKO1madfE24aGiTGNZwh5YXPYyN3ga6fIJUs4zSBe6mY158AV7SAddyBPXqJQfIvZsgtnEVWb83fh6jiP3nuOB28XCkysMXT9PdOASz0d7KeVG/mNHgtpGno31AsqqTK36hoZRQlcL1L8sU/4gs/5JRq+V7IN2/+so6B/4F+q8v44PnujwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"mario.png\"\n        title=\"mario.png\"\n        src=\"/static/a7b62fab03f4e1b313f00379d030ec05/37523/mario.png\"\n        srcset=\"/static/a7b62fab03f4e1b313f00379d030ec05/e9ff0/mario.png 180w,\n/static/a7b62fab03f4e1b313f00379d030ec05/f21e7/mario.png 360w,\n/static/a7b62fab03f4e1b313f00379d030ec05/37523/mario.png 720w,\n/static/a7b62fab03f4e1b313f00379d030ec05/302a4/mario.png 1080w,\n/static/a7b62fab03f4e1b313f00379d030ec05/07a9c/mario.png 1440w,\n/static/a7b62fab03f4e1b313f00379d030ec05/0d292/mario.png 1620w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+ElEQVQoz62Ry07DMBBF8wdJBIFV3ciOU4KgcVO3S/qAZtkVOz4ISCGP0kXFz140TiIWjRBSszjS2B4fja+t4/EbZfmFbJfjPfvE7qNAWR0MRblHXlQntOctebFHVR3wmr3Bsu1LOM4VXPcXWjtOvc/YPQaDOwPVnsdg2xdNj9dQ1657DUuIG3TB+QhBcAutN9D6yTCbpYgiDc5DCBF13rN8X6KL4VDA90dQaok4XmA8foBSK0gZgzHe9AQn9/4lnExWSJK1EYahOk9I06XpM7bbF0ynj/1MSPnN5xskSU9Cyq/N8Ownk1CphYGylLIHIeVI1L/8t/AHxvk2W8lsbXEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"tetris.png\"\n        title=\"tetris.png\"\n        src=\"/static/7f2b4e8575fa3ea7c2457640404585bf/37523/tetris.png\"\n        srcset=\"/static/7f2b4e8575fa3ea7c2457640404585bf/e9ff0/tetris.png 180w,\n/static/7f2b4e8575fa3ea7c2457640404585bf/f21e7/tetris.png 360w,\n/static/7f2b4e8575fa3ea7c2457640404585bf/37523/tetris.png 720w,\n/static/7f2b4e8575fa3ea7c2457640404585bf/302a4/tetris.png 1080w,\n/static/7f2b4e8575fa3ea7c2457640404585bf/07a9c/tetris.png 1440w,\n/static/7f2b4e8575fa3ea7c2457640404585bf/a88f6/tetris.png 1900w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAByUlEQVQoz22S227TQBCG/ejQqKXYQJtcUMhFn4Bn4IYLJISUlsSqIE7UOAd8iI/r+LRr/9WMY4sLVhrN7nr+b/8dr3b78R7X7ycYvTFwcaVjdEXZwOtLndeX+g1Gb8e4vrmDPp5CH3+GMZni3WTKmfS3d/cwxp/wSjegLa0VdvsDFqaJ2eMvzBcmzKcnzB4e8XM2x+L7V8y/fMDixzeY1ga/lytY62csrTX+WGus1s8c3dyGptCNqqpQlCWUUqil5L2mbdEqiaYUnNu2RVmWOOU5VHNWti2UkqhlzUstFRlP4iRBKgSDSUTiuq4ZXtUSUipIKeG6LrbbHaqqRj+olg9RCpoQgjeTJGVgnucM78FFUfC8aRoWeJ6H3W6PIAgRRhGiKAYx8qLgGi3Piw6YdsA4jnE4/GUQwU+n03A6OXQcF67nwfeP8Dwfnu+zmQFIgs5hgjRNkWUZjseAXfUuqbgHkrNjECCKIoRhyEG6AUgiGiLLOMjhxrYhRHZ2WbDLHkju6bu93XLebGx2OgBJSA2nH0BXo344joM4Tv7rkNwHYcg3ohoyQK0ZgP0TITEBqY/7/QFhGA1P6d8eUs/oZ1Br6HAKvskZ+AJWseZgCZtS2gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"route53_2.png\"\n        title=\"route53_2.png\"\n        src=\"/static/e62ccdf1c02d6963854a3683f2b1a0a7/37523/route53_2.png\"\n        srcset=\"/static/e62ccdf1c02d6963854a3683f2b1a0a7/e9ff0/route53_2.png 180w,\n/static/e62ccdf1c02d6963854a3683f2b1a0a7/f21e7/route53_2.png 360w,\n/static/e62ccdf1c02d6963854a3683f2b1a0a7/37523/route53_2.png 720w,\n/static/e62ccdf1c02d6963854a3683f2b1a0a7/302a4/route53_2.png 1080w,\n/static/e62ccdf1c02d6963854a3683f2b1a0a7/07a9c/route53_2.png 1440w,\n/static/e62ccdf1c02d6963854a3683f2b1a0a7/85bc8/route53_2.png 1875w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>현재 화면에서 보시면 mario는 SSL이 적용되어 있으나, tetris는 SSL 이 적용되어 있지 않습니다..\r\n현재 원인 분석 중 입니다..ㅜㅜ</p>\n<h2 id=\"3-k8s-스토리지\" style=\"position:relative;\"><a href=\"#3-k8s-%EC%8A%A4%ED%86%A0%EB%A6%AC%EC%A7%80\" aria-label=\"3 k8s 스토리지 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. K8S 스토리지</h2>\n<p>K8S 스토리지에서 가장 중요한 부분을 뽑자면 파드 내부의 데이터는 파드가 정지되면 모두 제거가 된다는 점 입니다.\r\n따라서 보존이 필요한 중요한 데이터가 있다면 PV같은 Stateful 애플리케이션으로 데이터를 보존해야된다는 점을 기억해주시면 되겠습니다.</p>\n<p>간단한 실습으로 데이터의 보존 여부를 체크해보겠습니다.\r\n아래의 명령어를 통해 10초마다 1번씩 데이터를 기록하는 POD를 배포해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f ~/pkos/3/date-busybox-pod.yaml</code></pre></div>\n<p>해당 POD를 배포하면 주기적으로 데이터를 기록하게 되는데</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl delete pod busybox\r\nkubectl apply -f ~/pkos/3/date-busybox-pod.yaml</code></pre></div>\n<p>위의 명령어를 통해서 POD를 제거하였다가 다시 생성하였을 시 이전에 기록한 데이터가 남아있는지 확인합니다.</p>\n<p>당연하게도 이전의 데이터는 모두 제거가 되게 됩니다.</p>\n<p>과제2. HostPath 실습 및 문제점 확인과 성능 측정</p>\n<p>먼저 HostPath를 사용하는 PV/PVC 스토리지 클래스를 배포하도록 하겠습니다!\r\nlocal path 정의 파일 다운로드</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -s -O https://raw.githubusercontent.com/rancher/local-path-provisioner/v0.0.23/deploy/local-path-storage.yaml</code></pre></div>\n<p>vim local-path-storage.yaml 을 통해 각자 Control Plane의 이름 입력해줍니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACIklEQVQ4y42TW2+cMBCF96W7gA2GBYy52CywsMleo0p9SJX2//+rU81kSWlSKXkYjUD253PmskqaEVt7gCos4iSDKQoYY1CWJYqiQNM0iOMYQghIKT+NlcorpN0ZcbOHkhG89TesNxus12ts7tn3fT5M0M/AKylDpP0F+vgT5XhD6QboPGd1WmtWm2XZ1xXKSIFtt0fk2sCYgu1WVcWZgsBfB0qJxE7Ij89Iqj18z4Pn+/Ao32O2LMU93kGWj63oI1Qx1zGtB7imhnMOXbdD27YcXd9jm6YIggBiUctlTee8EiKA0jWSeg+VlVC6gtrmCGWIMAz5YJIkSOIYkRCIpOQIZ4UEXVqeyelwQ3H5jfzxGXHZQ5mWHxHaYWw7nGsL6wXoRYgmkNgFErmQr7CFyldgGCHOCobmuyO6rsc0jRjHkZtDc6iUYqVknfN2iyiKPlhfvZIDCN9D3Iwo7IC23+Ph4RHTNHENrbVvnbdNg9IYtM4hTdN/GnJXGCBUCdLhCfr8C/r0gtgeYMYbTGVRVSUDqVGU5yA4/avr+u3Rv5ZlyJa3uxMy4+DqEs7W6HYtXNvyRbpENsn6HFSKuXHvLAu2nB1+IO1v2E0n7M/f0XZ7XM5n3G5PuF6vXFNSQvtNCkndcs9Z4dI/zaK9vkA3PXTtoE0NZy26rmMQXaYhp7M0kzyXH+fw/oPA/gZNZXA6HjEOA/I8452mILsE+N+6LTflD/a8b1rS6LsRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"InputMaster.png\"\n        title=\"InputMaster.png\"\n        src=\"/static/504a5641015a79a04bd7c740e86a6f74/37523/InputMaster.png\"\n        srcset=\"/static/504a5641015a79a04bd7c740e86a6f74/e9ff0/InputMaster.png 180w,\n/static/504a5641015a79a04bd7c740e86a6f74/f21e7/InputMaster.png 360w,\n/static/504a5641015a79a04bd7c740e86a6f74/37523/InputMaster.png 720w,\n/static/504a5641015a79a04bd7c740e86a6f74/83e77/InputMaster.png 889w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>아래 명령어를 입력해서 배포해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f local-path-storage.yaml</code></pre></div>\n<p>다음으로 PV/PVC를 사용하는 POD를 생성해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f ~/pkos/3/localpath1.yaml\r\nkubectl get pvc\r\nkubectl describe pvc</code></pre></div>\n<p>를 입력해서 PVC를 확인해보도록 하겠습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+0lEQVQoz3VS2Y6EMAzjkVvihnLDDmhhEMv/f5xHjlTESN0HK2lxYyfB+lU1iqJBUg94vX6wLAv6vsc8z3feti3SNEWWZei6TnLC8zz4vv8F61xWKNWibHoc7zf2fUddU6RAVVUSeY6iSIqweBzHSJLEXPC6LlHlw23bJPIDyRqu696wbfvOn7y74HEcyPNcVMdxRBiGRmUTjA7/zhPruko7wzBIpACdEiaB51nnOopDDp8zappGBq/JQRD864QtGx3SnXbEYo7jiCsKcF4kcQHPORLkshvyedbR4tamaZK22TIXRAGlFMqyFCFyuGneEfqOXBbm38DvfPcBTLHELpDEwKAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"check_pvc.png\"\n        title=\"check_pvc.png\"\n        src=\"/static/a49d1bf689e82d60b29c254383740ce6/37523/check_pvc.png\"\n        srcset=\"/static/a49d1bf689e82d60b29c254383740ce6/e9ff0/check_pvc.png 180w,\n/static/a49d1bf689e82d60b29c254383740ce6/f21e7/check_pvc.png 360w,\n/static/a49d1bf689e82d60b29c254383740ce6/37523/check_pvc.png 720w,\n/static/a49d1bf689e82d60b29c254383740ce6/302a4/check_pvc.png 1080w,\n/static/a49d1bf689e82d60b29c254383740ce6/85e74/check_pvc.png 1436w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>위에서 진행하였던 실습과 똑같이 10초마다 1번씩 데이터를 입력하는 POD를 배포해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f ~/pkos/3/localpath2.yaml</code></pre></div>\n<p>각 워커노드에 Tool을 설치해주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W1PIP</span> <span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> -y tree jq sysstat\r\n<span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W2PIP</span> <span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> -y tree jq sysstat</code></pre></div>\n<p>배포된 POD에는 out.txt라는 파일이 있을것입니다. 아래 명령어로 확인 가능합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W1PIP</span> tree /data</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhElEQVQI1zWO2QrFIBBD+1hQ8GpdKha3ov//h7lkoA+HBONM5qjO4/e8sLnhvm/03jHGEJ9SQikF13XBWiu+1ioZ/ZwTay3xOWfJjtob3tGFEIIMU733wue5nMrcOScFXxFVa43zPHHEEFBbw95biDHKMOElhO2fJ/xDeBkL+WaMgVIKf1bsTIF3fpSYAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"out.png\"\n        title=\"out.png\"\n        src=\"/static/14add20f445371a797254a23bc4559d5/37523/out.png\"\n        srcset=\"/static/14add20f445371a797254a23bc4559d5/e9ff0/out.png 180w,\n/static/14add20f445371a797254a23bc4559d5/f21e7/out.png 360w,\n/static/14add20f445371a797254a23bc4559d5/37523/out.png 720w,\n/static/14add20f445371a797254a23bc4559d5/d5bfb/out.png 1072w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>이 파일은 10초에 1번씩 입력되는 데이터를 저장하는 경로 입니다.\r\n이제 POD를 제거하면 과연 데이터가 살아있을지 확인해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl delete pod app\r\nkubectl get pod,pv,pvc</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABDUlEQVQoz01R227FIAzjtfc7baHQlpaeTnvY/3+dJ2dC2oOV4MQOAXUZB//+IFwRx3FgXVdM0wRrLZZlkbMxBsMwoCgKlGUpqKpKIrmUEyo4j36x0HqGWVc453DfN87zFIQQhBvHUYz7vpeYBm/bJoPJk1N3jNi9x3Hs8N5j33e87ytmFPKmMUYxbJpGwDzPc7RtK2a8Ifl5nqFIeO9kEomu61DXtTRrreXMGjkKU6QBcyLdnF5qMwafr2/E+OC6AuLziDHNGNN70pSrM6YzV+TbcjiN2atO62DPB3peRMBmFmjGZoqSOeuMXJm1LMtkdX4MwVxNWuMKf49PYRKnH04chzDSjCtTnH72P34BTRSwcBOYngkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"data_alive.png\"\n        title=\"data_alive.png\"\n        src=\"/static/7d94d1d8fabcf8a23e026c917ecb6ceb/37523/data_alive.png\"\n        srcset=\"/static/7d94d1d8fabcf8a23e026c917ecb6ceb/e9ff0/data_alive.png 180w,\n/static/7d94d1d8fabcf8a23e026c917ecb6ceb/f21e7/data_alive.png 360w,\n/static/7d94d1d8fabcf8a23e026c917ecb6ceb/37523/data_alive.png 720w,\n/static/7d94d1d8fabcf8a23e026c917ecb6ceb/302a4/data_alive.png 1080w,\n/static/7d94d1d8fabcf8a23e026c917ecb6ceb/07a9c/data_alive.png 1440w,\n/static/7d94d1d8fabcf8a23e026c917ecb6ceb/7b775/data_alive.png 1445w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>POD가 죽었음에도 PV가 살아있으니 데이터또한 같이 살아 있습니다!</p>\n<p>다음으로 kubestr &#x26; sar을 활용하여 모니터링 및 성능측정 확인을 진행해보도록 하겠습니다.</p>\n<p>아래 명령어로 kubestr를 다운로드 받아주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> https://github.com/kastenhq/kubestr/releases/download/v0.4.36/kubestr_0.4.36_Linux_amd64.tar.gz\r\n<span class=\"token function\">tar</span> xvfz kubestr_0.4.36_Linux_amd64.tar.gz <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">mv</span> kubestr /usr/local/bin/ <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">chmod</span> +x /usr/local/bin/kubestr</code></pre></div>\n<p>아래 명령어로 모니터링을 걸어주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W1PIP</span> iostat -xmdz <span class=\"token number\">1</span> -p nvme1n1\r\n<span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W2PIP</span> iostat -xmdz <span class=\"token number\">1</span> -p nvme1n1</code></pre></div>\n<p>모니터링에서 표시되는 정보 관련 내용입니다.\r\nrrqm/s : 초당 드라이버 요청 대기열에 들어가 병합된 읽기 요청 횟수\r\nwrqm/s : 초당 드라이버 요청 대기열에 들어가 병합된 쓰기 요청 횟수\r\nr/s : 초당 디스크 장치에 요청한 읽기 요청 횟수\r\nw/s : 초당 디스크 장치에 요청한 쓰기 요청 횟수\r\nrMB/s : 초당 디스크 장치에서 읽은 메가바이트 수\r\nwMB/s : 초당 디스크 장치에 쓴 메가바이트 수\r\nawait : 가장 중요한 지표, 평균 응답 시간. 드라이버 요청 대기열에서 기다린 시간과 장치의 I/O 응답시간을 모두 포함 (단위: ms)</p>\n<p>아래 명령어를 입력하여 측정을 시작하겠습니다.(5~10분정도 소요됩니다.)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -s -O https://raw.githubusercontent.com/wikibook/kubepractice/main/ch10/fio-read.fio\r\nkubestr fio -f fio-read.fio -s local-path --size 10G</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNklEQVQoz3WS2Y6DMAxFeey+r1AKlLKWQv//5+7ouPJo1Goerpw4ycm1k6CKr6qyXFndqagaVVWlx+OhpmkURZEOh4N2u53W67VF5tvtVpvN5neN8fF41HK5VNC/Bj37p9qmVtu2BhyGQXVd63Q66Xw+KwxDO8whcsT9fm8CyB7ieDxWcL/flee5sixTkiS2mQ2LxUKTyUTz+Vyz2exL5D9FPgAC7HK52O3MuY2y3AXuPLKH8qfT6ZcMWBSFcAmEQ14WArparQzgol/0ygF/RS4oy1JA6RPucEqM49jg9AWNRiNrAXLYJ9SAgLquM5e8bt/39ijkEBfebjeD+6H/ZCXzNa5xYiWmaWqiVP8atMK/Cw9F84k+9jnx7TAKlZZvIK+NG8Y4xxUgLvWvQ2ROS+i5j8kD/AGbP+K2Qi7SUgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"kubestr.png\"\n        title=\"kubestr.png\"\n        src=\"/static/8313841c9a840f411832d8ad604b1663/37523/kubestr.png\"\n        srcset=\"/static/8313841c9a840f411832d8ad604b1663/e9ff0/kubestr.png 180w,\n/static/8313841c9a840f411832d8ad604b1663/f21e7/kubestr.png 360w,\n/static/8313841c9a840f411832d8ad604b1663/37523/kubestr.png 720w,\n/static/8313841c9a840f411832d8ad604b1663/302a4/kubestr.png 1080w,\n/static/8313841c9a840f411832d8ad604b1663/e72de/kubestr.png 1198w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -s -O https://raw.githubusercontent.com/wikibook/kubepractice/main/ch10/fio-write.fio\r\nkubestr fio -f fio-write.fio -s local-path --size 10G</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABI0lEQVQoz4WSWW+EMAyEeWKB5RL3VQqkIpRjl///56YaS5FohdSHkeMk/uIxWPpzRK8PfOlvLFpj33dordH3Peq6RlmWSJIEWZZJXhQF0jSVvG1biXmey1kQBLCO1wvrorGtq4BezNcVXdfJxaZpJFKEE2hyA+N+FEXwPA+WUgqTUhjHUQ6GYZAOns8n4jgWhWEoYtGdzB3WWLTGLghj5IVr8XV9LbyKnTH6vg9rmiYB0QrhnAvnUVWViA+ZaB5moQFcJR3O8yxDZxFnQjDX3LNtG47jwHVd6cJEA7uDWu/3G8uy4DgOcH2ep6y3bZO5cui0etfN3z0BqkmhaRsppn3aNtb5gWiTMvO6g/wC5h+ZWKVN2uW/9Hg8xJqxSf3XmQH+ANQi3nIJKTo5AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"kubestr2.png\"\n        title=\"kubestr2.png\"\n        src=\"/static/7bd07c922e926794b4153996168395ab/37523/kubestr2.png\"\n        srcset=\"/static/7bd07c922e926794b4153996168395ab/e9ff0/kubestr2.png 180w,\n/static/7bd07c922e926794b4153996168395ab/f21e7/kubestr2.png 360w,\n/static/7bd07c922e926794b4153996168395ab/37523/kubestr2.png 720w,\n/static/7bd07c922e926794b4153996168395ab/302a4/kubestr2.png 1080w,\n/static/7bd07c922e926794b4153996168395ab/84f4d/kubestr2.png 1208w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>과제3. AWS EBS를 PVC로 사용 후 온라인 볼륨 증가 해보기</p>\n<p>아래 명령어를 입력하여 aws-ebs-csi를 확인해봅니다. 미리 설치되어 있다고합니다.(친절한 가시다님ㅜㅜ)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get pod -n kube-system -l app.kubernetes.io/instance<span class=\"token operator\">=</span>aws-ebs-csi-driver</code></pre></div>\n<p>스토리지 클래스 확인</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get sc kops-csi-1-21 kops-ssd-1-17\r\nkubectl describe sc kops-csi-1-21 <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> Parameters\r\nkubectl describe sc kops-ssd-1-17 <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> Parameters</code></pre></div>\n<p>아래 명령어를 입력해 워커노드의 EBS 볼륨을 확인해봅시다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws ec2 describe-volumes --filters <span class=\"token assign-left variable\">Name</span><span class=\"token operator\">=</span>tag:k8s.io/role/node,Values<span class=\"token operator\">=</span><span class=\"token number\">1</span> --output table</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA80lEQVQoz42RUW/DIAyEedyCwYZAgCRLVm1a//8vvAm36apprfbw6SA631nBnLYTQttQa8O+76i1opSC1pqyLItqSkm/9/u6rpjn+cbhyTnDTFMGewfnHIhI9R7vvQb1wT7U7789914jIugw80PGcdT2rs98HTOOEcwe/tpwwV1hhVl0w1784/kbk0tDTAUSJ4QQEGKCxAyJSYvYk/4SPbP8Y8P5jFA+QJy1QfI7pJwh5QtOCjjt4PEN5APsMMBa+xQT6yc4VgyvL5fAtIG8gJwHOYbzQSHqj2b14Z5hYl41qKd31W3Iwdpjm+F27gOHPgr8BnoOviGT/xQuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image_volume.png\"\n        title=\"image_volume.png\"\n        src=\"/static/d72baa3d042f2ed0c2e152f49f3efabd/37523/image_volume.png\"\n        srcset=\"/static/d72baa3d042f2ed0c2e152f49f3efabd/e9ff0/image_volume.png 180w,\n/static/d72baa3d042f2ed0c2e152f49f3efabd/f21e7/image_volume.png 360w,\n/static/d72baa3d042f2ed0c2e152f49f3efabd/37523/image_volume.png 720w,\n/static/d72baa3d042f2ed0c2e152f49f3efabd/302a4/image_volume.png 1080w,\n/static/d72baa3d042f2ed0c2e152f49f3efabd/4c5bd/image_volume.png 1435w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>아래 명령어는 Pod에 추가한 EBS 볼륨을 확인하는 명령어 입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws ec2 describe-volumes --filters <span class=\"token assign-left variable\">Name</span><span class=\"token operator\">=</span>tag:ebs.csi.aws.com/cluster,Values<span class=\"token operator\">=</span>true --output table</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9.444444444444445%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAUklEQVQI13WKQQqAMAwEe0z6gLQhaKlV+/8XriSgoOBhyGZ20yIK7RN9G2htRa0VIoJSSqCqgWf33pvZ4+6Ne79p7APzPGJERMg5v2Dm4Pv/uQvWFTDSIoecsgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ebs_volume.png\"\n        title=\"ebs_volume.png\"\n        src=\"/static/f32add800e89c713257998804e271ede/37523/ebs_volume.png\"\n        srcset=\"/static/f32add800e89c713257998804e271ede/e9ff0/ebs_volume.png 180w,\n/static/f32add800e89c713257998804e271ede/f21e7/ebs_volume.png 360w,\n/static/f32add800e89c713257998804e271ede/37523/ebs_volume.png 720w,\n/static/f32add800e89c713257998804e271ede/302a4/ebs_volume.png 1080w,\n/static/f32add800e89c713257998804e271ede/bed7a/ebs_volume.png 1437w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>아래 명령어로 PVC,POD를 생성해주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f ~/pkos/3/awsebs-pvc.yaml\r\nkubectl apply -f ~/pkos/3/awsebs-pod.yaml</code></pre></div>\n<p>다음 아래 명령어를 통해 볼륨 정보를 확인하실 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl <span class=\"token builtin class-name\">exec</span> -it app -- <span class=\"token function\">sh</span> -c <span class=\"token string\">'df -hT --type=ext4'</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9.444444444444445%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAZ0lEQVQI1z2MuwrAIBRDu+tUH1hRa6+iDg7+/8+leKEdQnJCyPH4iDNUXOFGIcIYAzlnFhGh986+OcYIay201iznHJRS8N4jpQRjDI61Fhd73FpDKeU/qrVynnMy7xMpJYQQv3/54xfVpTSWWXbkHQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"volume_check.png\"\n        title=\"volume_check.png\"\n        src=\"/static/eb8ce2bfd6828f47e0ea3e904d9d1880/37523/volume_check.png\"\n        srcset=\"/static/eb8ce2bfd6828f47e0ea3e904d9d1880/e9ff0/volume_check.png 180w,\n/static/eb8ce2bfd6828f47e0ea3e904d9d1880/f21e7/volume_check.png 360w,\n/static/eb8ce2bfd6828f47e0ea3e904d9d1880/37523/volume_check.png 720w,\n/static/eb8ce2bfd6828f47e0ea3e904d9d1880/302a4/volume_check.png 1080w,\n/static/eb8ce2bfd6828f47e0ea3e904d9d1880/22c86/volume_check.png 1143w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>또한 AWS Management Console -> EC2 -> 볼륨으로 들어가면 4Gi의 볼륨이 생성된것을 확인하실 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 39.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABYklEQVQoz42Q224TMRCG90V5DVogpa1UpQkIVJpW0EsueBVeokhEgpKFPdhen72bfshOWm4QYqRPY49//2NPtbr5yMXqA0fztxycLjk4WfD0+JzD0yWzs9e8XF4yW1wxW6w4Wl7zfH7Ji8WKZ/N3HJ5dcPzqmpM3N5y//8ST2RUV+/AT2BFGIPH/EYAYA6w/8+XHTyptDCEEmqZBiB7vHM7akr3foZRCa13qehgwWmONKVmpgUH29N9vcaKhcs6RUiIbq2Gg63t6ITDW4oqpRxjPujF02pda1jrniyamRBpH4nTP3aalGsexGOZDY2wxjDGy3W4LOWyc+NY7hI3EELDOFU1uNk1TIWtzrcod8kJKSdO2bDY1dV0jhCgXQvAobamFRZrdPjfOL3R74wfzr+s7qjyXXMgzbNuumGa6rqPdk1+dx5EZ9PBnXfb6ESEVVUq77z2I/oZU6p8IKfnVtiX/BrDCUBVKe72WAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"console_ebs.png\"\n        title=\"console_ebs.png\"\n        src=\"/static/b66c0a583a190ab0e3141f0f5d514500/37523/console_ebs.png\"\n        srcset=\"/static/b66c0a583a190ab0e3141f0f5d514500/e9ff0/console_ebs.png 180w,\n/static/b66c0a583a190ab0e3141f0f5d514500/f21e7/console_ebs.png 360w,\n/static/b66c0a583a190ab0e3141f0f5d514500/37523/console_ebs.png 720w,\n/static/b66c0a583a190ab0e3141f0f5d514500/302a4/console_ebs.png 1080w,\n/static/b66c0a583a190ab0e3141f0f5d514500/07a9c/console_ebs.png 1440w,\n/static/b66c0a583a190ab0e3141f0f5d514500/7970d/console_ebs.png 1908w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>아래의 명령어를 통해 4Gi -> 10Gi 로 용량을 증가시켜 준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl patch pvc ebs-claim -p <span class=\"token string\">'{\"spec\":{\"resources\":{\"requests\":{\"storage\":\"10Gi\"}}}}'</span></code></pre></div>\n<p>용량이 증가된것을 확인하실 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVQoz41QSU4DQQyc/7+FS0iIBFk0UsgChBy4cEUaiJIwM73Y3T0bKeSGsJ2wVHKXXapWOVnerHG3ecDteoP+eIaz4fQDFyP0rlIMJjMM0yUG0wUG0yUu0hXOJ/PIe+Nr9EYz9CdzDNMVxot7JMfjEaci51F33/y/Vb8BrXpB+3iJxDkH5zyapkGe51BKgayFMQZEBO89vHMolEZpHSxx3MvuJ0RXFAUSZo6k6zrYKGQopUHMCFWFqqrR1DVKrvCUMzTLrAKzi92HgLZtIUlDCEjETIgMLVFEWZZRLJ98nSO02JkADk1MI0bSRXcyFH00dN7H4X6/x3a7RZY9I8syHA6HeALBa6mxKwmaGHImSSPpJIlwMVZaIwlk4L2LhnlRwBDByA0/oY2JkLcl+2v3F5LuHUz3EMxvudH/AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"console_ebs2.png\"\n        title=\"console_ebs2.png\"\n        src=\"/static/b0ce2ec5fca46e5c6cfa1df46c28a4c9/37523/console_ebs2.png\"\n        srcset=\"/static/b0ce2ec5fca46e5c6cfa1df46c28a4c9/e9ff0/console_ebs2.png 180w,\n/static/b0ce2ec5fca46e5c6cfa1df46c28a4c9/f21e7/console_ebs2.png 360w,\n/static/b0ce2ec5fca46e5c6cfa1df46c28a4c9/37523/console_ebs2.png 720w,\n/static/b0ce2ec5fca46e5c6cfa1df46c28a4c9/302a4/console_ebs2.png 1080w,\n/static/b0ce2ec5fca46e5c6cfa1df46c28a4c9/07a9c/console_ebs2.png 1440w,\n/static/b0ce2ec5fca46e5c6cfa1df46c28a4c9/3e992/console_ebs2.png 1902w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>혹은 아래 명렁어를 통해서도 확인하실 수 있습니다!</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl <span class=\"token builtin class-name\">exec</span> -it app -- <span class=\"token function\">sh</span> -c <span class=\"token string\">'df -hT --type=ext4'</span></code></pre></div>\n<p>과제4. AWS Volume Snapshot 실습</p>\n<p>kops edit 을 통해 아래 표시된 부분을 추가해준후 업데이트 해주도록 하겠습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAABJ0AAASdAHeZh94AAABAklEQVQoz42Oy26DMBBF3V1ijz2YmKdtQkIMNA+pG6qqi/5AWYNaiR/g/z+gipNFVg1Hs7gazRldsgrcKmjXQUNlTWWzli2Th+sEpZ/iHsIDCyyIBDADLgEYABCzbTNbJ/kuTm2UlqnZ8zCjwAGov+Bw55bFwwZI27jXtjY6U5tQCR6jiDiE/uopZFdVp8ulci7JMslAMYiBK+B4a/a//LEtv+rmc1+9m2InkPq6dIF5lSut35qmyvMUMaRLlAc5TtP2eDRFESq1iSJEZGzpC6K17rrudD4brZVSUkrBuRACF0AQ0TlnrRVCEEJePGQh4zjO8zxN06/nxzMMQ9/338/4A3HeNOWZaJfUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"snapshotcontroller.png\"\n        title=\"snapshotcontroller.png\"\n        src=\"/static/3f0e9f235210c84e7367c41db20dd179/37523/snapshotcontroller.png\"\n        srcset=\"/static/3f0e9f235210c84e7367c41db20dd179/e9ff0/snapshotcontroller.png 180w,\n/static/3f0e9f235210c84e7367c41db20dd179/f21e7/snapshotcontroller.png 360w,\n/static/3f0e9f235210c84e7367c41db20dd179/37523/snapshotcontroller.png 720w,\n/static/3f0e9f235210c84e7367c41db20dd179/302a4/snapshotcontroller.png 1080w,\n/static/3f0e9f235210c84e7367c41db20dd179/fbfd6/snapshotcontroller.png 1357w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>아래 명령어를 통해 업데이트가 되었는지 확인해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get crd <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> volumesnapshot</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 11.666666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAeklEQVQI1zXKzQ7CIBhE0W67IqKSWqoggdDyJwQ3Lnz/xxrDl7g8M3dy5ws8O+FxU7hvBlo/Ya1FCAHGDGuy954spSQ753AcB+3/ljGG6XVd8FkkvsuK97oh54xaK2KMaK1R3HvHvu9QSoFzjlIKdeMfe0oJQgjM84wfjJ44jdHM95gAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"volume_snapshot.png\"\n        title=\"volume_snapshot.png\"\n        src=\"/static/69a8f22fbdd1471e5d22b165218144e6/37523/volume_snapshot.png\"\n        srcset=\"/static/69a8f22fbdd1471e5d22b165218144e6/e9ff0/volume_snapshot.png 180w,\n/static/69a8f22fbdd1471e5d22b165218144e6/f21e7/volume_snapshot.png 360w,\n/static/69a8f22fbdd1471e5d22b165218144e6/37523/volume_snapshot.png 720w,\n/static/69a8f22fbdd1471e5d22b165218144e6/7a3d6/volume_snapshot.png 990w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>아래 명령어를 통해 vsclass 생성해주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f https://raw.githubusercontent.com/kubernetes-sigs/aws-ebs-csi-driver/master/examples/kubernetes/snapshot/manifests/classes/snapshotclass.yaml</code></pre></div>\n<p>PVC, POD 생성 명령어</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f ~/pkos/3/awsebs-pvc.yaml\r\nkubectl apply -f ~/pkos/3/awsebs-pod.yaml</code></pre></div>\n<p>아래 명령어를 통해 볼륨 스냅샷을 생성해주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f ~/pkos/3/ebs-volume-snapshot.yaml</code></pre></div>\n<p>볼륨 스냅샷을 확인하는 명령어 입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get volumesnapshot</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAcklEQVQI11WMSQoDIQAE5wVKXKNx1wgaB/z/5zog5JBbVxfUtVICF088lMXLWowx4JxDSglzTvTesffGWut8jDFYa6G1hpQSIYS/fX3uG+/W0GpBjBGllCNyzqi1nrgQAsaYE6OUQikFQsjhn+ecw3uPL+p6NSuXuYK1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"volume_snapshot_2.png\"\n        title=\"volume_snapshot_2.png\"\n        src=\"/static/a8186a5f27f924820eb18032d47fe0ad/37523/volume_snapshot_2.png\"\n        srcset=\"/static/a8186a5f27f924820eb18032d47fe0ad/e9ff0/volume_snapshot_2.png 180w,\n/static/a8186a5f27f924820eb18032d47fe0ad/f21e7/volume_snapshot_2.png 360w,\n/static/a8186a5f27f924820eb18032d47fe0ad/37523/volume_snapshot_2.png 720w,\n/static/a8186a5f27f924820eb18032d47fe0ad/302a4/volume_snapshot_2.png 1080w,\n/static/a8186a5f27f924820eb18032d47fe0ad/07a9c/volume_snapshot_2.png 1440w,\n/static/a8186a5f27f924820eb18032d47fe0ad/f470a/volume_snapshot_2.png 1443w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>완료가 되었다면 복원을 해보겠습니다.\r\n임의로 app &#x26; pvc를 제거하여 이슈를 만들어보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl delete pod app <span class=\"token operator\">&amp;&amp;</span> kubectl delete pvc ebs-claim</code></pre></div>\n<p>이후 스냅샷에서 PVC로 복원을 해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f ~/pkos/3/ebs-snapshot-restored-claim.yaml\r\nkubectl apply -f ~/pkos/3/ebs-snapshot-restored-pod.yaml</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUElEQVQoz3WS247CMAxE8wrlqrZQ6D29QKs2IP7/37w6XoXtrtiHke0mHs84NXVWSdo7ud/v8nBObreb9H2vNWjbVpGmqSLLsnfusd1uZbfbaTR5mkuYpHK5XN6Xya/Xq0ZQ17Xs93uJ41iOx6NG6tPppHkYhlKWpd415/NZ4jjSwyiK9HAJJvsmr4IIITmgDx5gINpsAlmv13I4HFQlBxAwkXOaqJMk+fWdQTjyynFlpnGSYXpI1/W6v3meZRgGtYkN9mitVQKaICVnOATkq9VKa1XYlo0Uw1PKspKu66QoClUJGTHPc1VUVdX7Gyr9eiAKgkCBS2OLWqrByTiO8nq99IVpbJpGVaIOJbw05N8r2mgzgIjaw9jayjjNahdSLGGBvXGB6Jv8gywJwJLUoMQ5p3uDEHsQehv/4S/Rj0Jrlcj/yCjECko+NXxStST8AkxK/KfEiwM0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"snapshot_recovery.png\"\n        title=\"snapshot_recovery.png\"\n        src=\"/static/9ee56640ccec21e9bdc416fd3e5a9a66/37523/snapshot_recovery.png\"\n        srcset=\"/static/9ee56640ccec21e9bdc416fd3e5a9a66/e9ff0/snapshot_recovery.png 180w,\n/static/9ee56640ccec21e9bdc416fd3e5a9a66/f21e7/snapshot_recovery.png 360w,\n/static/9ee56640ccec21e9bdc416fd3e5a9a66/37523/snapshot_recovery.png 720w,\n/static/9ee56640ccec21e9bdc416fd3e5a9a66/302a4/snapshot_recovery.png 1080w,\n/static/9ee56640ccec21e9bdc416fd3e5a9a66/07a9c/snapshot_recovery.png 1440w,\n/static/9ee56640ccec21e9bdc416fd3e5a9a66/bd9eb/snapshot_recovery.png 1442w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>완료되어 이전에 입력되었던 데이터가 그대로 살아있는것을 확인하실 수 있습니다.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#1%EC%8A%A4%ED%86%A0%EB%A6%AC%EC%A7%80\">1.스토리지</a></li>\n<li><a href=\"#2ingress\">2.Ingress</a></li>\n<li><a href=\"#3-k8s-%EC%8A%A4%ED%86%A0%EB%A6%AC%EC%A7%80\">3. K8S 스토리지</a></li>\n</ul>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"toc\"><pre class=\"language-toc\"><code class=\"language-toc\"></code></pre></div>","excerpt":"가시다님 스터디 : https://www.notion.so/gasidaseo/23-7635cc4f02c04954a3260b317588113e 1.스토리지  아래 명령어를 통해 인스토어 스토어 볼륨이 있는 c5모든 타입의 스토리지 크기를 조회하실 수 있습니다. 저희가 배포한 c5d.large는 50Gib 만큼의 크기를 제공하고 있습니다. 먼저 각 워커노드의 스토리지를 확인해 보도록 하겠습니다. nvm list를 통해서 보면 2개의 스토리지를 확인하실 수 있습니다.  하지만 AWS Management Console를 통해서 보면 EC2에 할당된 디스크중에 50Gib짜리 디스크는 찾아보실 수 없습니다.  인스턴스 스토어에 대한 정보는 스토리지 정보에 출력이 되지 않는다는 점을 확인하실 수 있습니다. 아래의 명령어를 통해 파일시스템 생성 및 /data를 마운트 시킬 수 있습니다. 2.Ingress 지난주에 진행했던 실습과 비슷한 실습입니다.\r\n각 EC2에 LB생성 권한을 부여해 LB를 생…","frontmatter":{"date":"February 05, 2023","title":"Gasida Kubernetes Study 3주차","categories":"Kubernetes","author":"KORWOO","emoji":"🔮"},"fields":{"slug":"/Kubernetes/Gasida_Study_homework_3/"}},"next":{"id":"1fb5e8d0-d94f-544d-ae1b-f83ff6323242","html":"<p>가시다님 스터디 : <a href=\"https://www.notion.so/gasidaseo/23-7635cc4f02c04954a3260b317588113e\">https://www.notion.so/gasidaseo/23-7635cc4f02c04954a3260b317588113e</a></p>\n<p>가시다님의 쿠버네티스 스터디 2주차 쿠버네티스 네트워크 입니다.\r\n이번주차는 저를 포함한 이번 스터디를 수행하는 모든 문들이 어려움을 많이 느꼈던것으로 알고 있습니다.\r\n저역시 쉽지 않아서 원래대로 라면 지난주에 포스팅해야했을것을 과제만 우선 제출하고 현재 포스팅을 하고 있습니다.ㅜㅜ</p>\n<h2 id=\"1-kops-원클릭-배포\" style=\"position:relative;\"><a href=\"#1-kops-%EC%9B%90%ED%81%B4%EB%A6%AD-%EB%B0%B0%ED%8F%AC\" aria-label=\"1 kops 원클릭 배포 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. KOPS 원클릭 배포</h2>\n<p>지난번 1주차에서 스터디장님인 가시다님이 제공해주신 CloudFormation을 통해 EC2등을 배포하고\r\n거기서 aws configure 등의 작업을 진행해 주었습니다.\r\n하지만 가시다님의 노력으로 인하여 저희는 몇줄의 명령어 만으로 쉽게 배포할 수 있게 되었습니다.</p>\n<p>kops 원클릭 배포</p>\n<p>원클릭 배포를 위해서는 먼저 SSH 키페어, IAM 계정 키, S3 버킷이 필요합니다.</p>\n<p>위에서 말씀드린 것들은 1주차에서 생성하였으므로 이번 포스팅에서는 생략하겠습니다.</p>\n<p>먼저 cloudformation에서 사용할 yaml 파일이 필요합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -O https://s3.ap-northeast-2.amazonaws.com/cloudformation.cloudneta.net/K8S/kops-oneclick.yaml</code></pre></div>\n<p>해당 파일을 다운받았다면 아래 명렁어를 통하여 배포해줍니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws cloudformation deploy --template-file kops-oneclick.yaml --stack-name mykops --parameter-overrides <span class=\"token assign-left variable\">KeyName</span><span class=\"token operator\">=</span>본인의 키페어 이름 <span class=\"token assign-left variable\">SgIngressSshCidr</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">curl</span> -s ipinfo.io/ip<span class=\"token variable\">)</span></span>/32  <span class=\"token assign-left variable\">MyIamUserAccessKeyID</span><span class=\"token operator\">=</span>액세스키 <span class=\"token assign-left variable\">MyIamUserSecretAccessKey</span><span class=\"token operator\">=</span><span class=\"token string\">'시크릿키'</span> <span class=\"token assign-left variable\">ClusterBaseName</span><span class=\"token operator\">=</span><span class=\"token string\">'korwoo.net'</span> <span class=\"token assign-left variable\">S3StateStore</span><span class=\"token operator\">=</span><span class=\"token string\">'hellokorwoo'</span> <span class=\"token assign-left variable\">MasterNodeInstanceType</span><span class=\"token operator\">=</span>c5d.large <span class=\"token assign-left variable\">WorkerNodeInstanceType</span><span class=\"token operator\">=</span>c5d.large --region ap-northeast-2</code></pre></div>\n<p><img src=\"OneClick_Deploy.png\" alt=\"OneClick_Deploy.png\"></p>\n<p>5~10분 정도의 시간이 지나면 위에 화면과 같이 컨트롤플레인 및 워커노드가 모두 생성이 되어있는것을 확인하실 수 있습니다.</p>\n<p>다시한번 가시다님의 노고에 감사드립니다ㅜㅜ</p>\n<h2 id=\"2-aws-vpc-cni\" style=\"position:relative;\"><a href=\"#2-aws-vpc-cni\" aria-label=\"2 aws vpc cni permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. AWS VPC CNI</h2>\n<p><code class=\"language-text\">C</code>ontainer <code class=\"language-text\">N</code>etwork <code class=\"language-text\">I</code>nterface</p>\n<p>CNI는 공식 Github(<a href=\"https://github.com/containernetworking/cni\">https://github.com/containernetworking/cni</a>) 에 들어가서 내용을 확인하실 수 있습니다.\r\n간단하게 말하자면 컨테이너 간 네트워킹을 제어할 수 있는 플러그인을 만들기 위한 도구 정도라고 정리가 됩니다.</p>\n<p>지원되는 플러그인은 (<a href=\"https://kubernetes.io/docs/concepts/cluster-administration/addons/#networking-and-network-policy\">https://kubernetes.io/docs/concepts/cluster-administration/addons/#networking-and-network-policy</a>) 에서 확인 가능합니다.</p>\n<p>가시다님의 스터디에서 소개되는 내용은 AWS VPC CNI에 대해서 소개가 되었습니다.</p>\n<p>AWS VPC CNI의 강조되는 특징중 하나는 POD와 NODE의 네트워크 대역이 같다는 점 입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABSElEQVQoz42T266CQAxF+f8/Ux58MSFqlICKghcuAfGC1qwmJTPmPJwmDTNkzW53BwJx4na7Sdd1+nTj8/l4+77vpa5raZpG2rb1uOD9fsvj8ZDX6yW73U6SJJHz+SzDMIzvDWYPn+e5rNdr2e/3cjgcRlYFn8+nkGzSNFVwtVppdeJ+v6sICUd3m81GrterirFG2BOkApFlmURRJMvlUg8TPE2QbjlIh2VZqpPj8aji1lRgC2DsAhZFoYfohveuIPx2u1XudDrpmBD2BKlKInS5XBTgcrDrWqYAPAxdkay5RHIUtIuZzWYynU4lDEOpqkot20UYQ8znc+Umk4nO3WbtCVKBC8HOYrFQ+3TkCmKZRIR5x3Gs1s2hJ4hFbovOgBk2Rf4ShEMIBsueoH1DCNvQ7aDNF5DE1i9nzGjZPlrr4jfdv+Q/3BdonVHxtDvc3QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Network_Diff\"\n        title=\"Network_Diff\"\n        src=\"/static/8f73f4f2e4e0f0a214625aa888864ed3/37523/Network_Diff.png\"\n        srcset=\"/static/8f73f4f2e4e0f0a214625aa888864ed3/e9ff0/Network_Diff.png 180w,\n/static/8f73f4f2e4e0f0a214625aa888864ed3/f21e7/Network_Diff.png 360w,\n/static/8f73f4f2e4e0f0a214625aa888864ed3/37523/Network_Diff.png 720w,\n/static/8f73f4f2e4e0f0a214625aa888864ed3/82b28/Network_Diff.png 931w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>같은 네트워크 대역대를 사용함으로서 노드와 파드간의 소통이 좀더 원활하다는 장점을 가지게 됩니다.</p>\n<p>간단하게 내용들을 확인해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl describe daemonset aws-node --namespace kube-system <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> Image <span class=\"token operator\">|</span> <span class=\"token function\">cut</span> -d <span class=\"token string\">\"/\"</span> -f <span class=\"token number\">2</span></code></pre></div>\n<p>명령어를 입력하게 되면</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 7.777777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABJ0AAASdAHeZh94AAAAUUlEQVQI14WKsQoAIQxDXZWOitZaKtT//8UcdrjtuOFBkpfEurG3wd0x58QYA6oa+bLWin5h5ui1VphZeBF5/713pOMesrUGIkLO+ZdSyuf+AAUlMSPWxmd3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"CNI_Info\"\n        title=\"CNI_Info\"\n        src=\"/static/6183460e8a33438ffc018aedcff3fb0b/37523/CNI_Info.png\"\n        srcset=\"/static/6183460e8a33438ffc018aedcff3fb0b/e9ff0/CNI_Info.png 180w,\n/static/6183460e8a33438ffc018aedcff3fb0b/f21e7/CNI_Info.png 360w,\n/static/6183460e8a33438ffc018aedcff3fb0b/37523/CNI_Info.png 720w,\n/static/6183460e8a33438ffc018aedcff3fb0b/302a4/CNI_Info.png 1080w,\n/static/6183460e8a33438ffc018aedcff3fb0b/1bba3/CNI_Info.png 1433w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>다음과 같이 CNI 정보를 확인하실 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws ec2 describe-instances --query <span class=\"token string\">\"Reservations[*].Instances[*].{PublicIPAdd:PublicIpAddress,PrivateIPAdd:PrivateIpAddress,InstanceName:Tags[?Key=='Name']|[0].Value,Status:State.Name}\"</span> --filters <span class=\"token assign-left variable\">Name</span><span class=\"token operator\">=</span>instance-state-name,Values<span class=\"token operator\">=</span>running --output table</code></pre></div>\n<p>명령어를 입력하면</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA8UlEQVQY01WMy26FMAxE2ROQyMuBJARKCVe8Llf9/2+bKpa66OJoPLZnqiMl5O1Avj44jgPP87C+Xi+c54l937FtG+77Zs05Y1kW1nVdef6j7CpDhL538EMP5xwcEav3ngOFeZ7Zl71SClJKdF2h47ltWzRNw1TGGD5KqeBDwDTNsJb42RiNGEd8LQtCiCAipDQhxgjnCHEcUfKlqK5rptL9N2R4IIcLOn6g/QkV3mhVgBA1pI3Q4w/UsENTguL7DWUGqJIzHk0juEwIgYr8ChMvaDdDUeKCooz1sBRgwgFFE6yL0ENmT8MEEy5oCv8KfwHA6YM5lOc4igAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Node_IP.png\"\n        title=\"Node_IP.png\"\n        src=\"/static/44982c1575e76de722c6c47e62f64de6/37523/Node_IP.png\"\n        srcset=\"/static/44982c1575e76de722c6c47e62f64de6/e9ff0/Node_IP.png 180w,\n/static/44982c1575e76de722c6c47e62f64de6/f21e7/Node_IP.png 360w,\n/static/44982c1575e76de722c6c47e62f64de6/37523/Node_IP.png 720w,\n/static/44982c1575e76de722c6c47e62f64de6/302a4/Node_IP.png 1080w,\n/static/44982c1575e76de722c6c47e62f64de6/bed7a/Node_IP.png 1437w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>다음과 같이 노드의 IP를 확인할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get pod -n kube-system -o<span class=\"token operator\">=</span>custom-columns<span class=\"token operator\">=</span>NAME:.metadata.name,IP:.status.podIP,STATUS:.status.phase</code></pre></div>\n<p>명령어를 입력하여 Pod의 IP를 확인해보도록합시다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABJklEQVQoz42SS4+CQBCEOZgAKh4QAgo4gOExg8rLi///h9WmOhmTTTa6h06Hmeqvq6dxtFJQRYm8btE0Dfq+R13XSNMUSZLgfD4jjmP5Vkq9z5l5x3w6neQsiiI42hg0bYOqVHJghUEQwPM8ZFmG6/UqRWxYFAVc18V2u4Xv+78ywzFaY1kWcUYnBG02G+x2OxHQ1TRNuFwu0FoLnID9fv9nOBTd73fcbjes64pxHFGWJY7HoxQSxHs67boOVVV9BlJEdwS2bStB4OFweAMfj4cA7ft+BFI0DIMU5XmOMAzfD02BBbKJMea7Q47MMZlZwDdiE+vSjkwQNV+BdMegeJ5nKeY2+RtwSRbI5fwLSDFHYn4+n3i9XuKQW+ZvQ6fcMoFs/G3LP4pF6glfQdmrAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"POD_IP.png\"\n        title=\"POD_IP.png\"\n        src=\"/static/29d902bb840a0e6bd2d9677d08750a2e/37523/POD_IP.png\"\n        srcset=\"/static/29d902bb840a0e6bd2d9677d08750a2e/e9ff0/POD_IP.png 180w,\n/static/29d902bb840a0e6bd2d9677d08750a2e/f21e7/POD_IP.png 360w,\n/static/29d902bb840a0e6bd2d9677d08750a2e/37523/POD_IP.png 720w,\n/static/29d902bb840a0e6bd2d9677d08750a2e/302a4/POD_IP.png 1080w,\n/static/29d902bb840a0e6bd2d9677d08750a2e/07a9c/POD_IP.png 1440w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>위에서 확인했던 노드의 Private IP 대역대와 파드의 IP 대역대가 일치하는것을 확인하실 수 있습니다.</p>\n<p>##3. 노드 간 파드 통신</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABk0lEQVQoz0WR63KiQBSE8/5PltrUmqirsqKCXAQGkeE6MDB8W2DWdNX5M9Wn53T3m+/7+L6H414RiUDKgrZVJIngkUvqukEIQRiGuK6L47hEcUwuC+qmJRUpeS7puo4Zb3xDFhW7ry9uYUTVdHz83nC6eFR1jRnH/zSCW8L7r0+8IEYWNYfNGs8P6Xv9FJymickYZFlz2lnEsaAoa+xLQHBLKcuKvu+ZecYY0kxyvASkd4msmmUn8EK6vn8KbjZbLMvCDxKOqw1pnKB6jWX7i6BSLe71ysw7WBaJyDjYHlle0rQK+3NNHInl00VwdzgSJ3cGbWiKiiaJGIcBPTwtzNm4Xsh2vl5kr7fRGFSWoWTOBGj9bdn3A7KHfGVkVAuqRsqGKLpTliVxkuI41xfPTBNMhkE+aHu9lNK27VNQlu1ybqc69DBwti9sV2uOJ4+P1Z4sLxjGkX4Ylpmzmvnns8tu/YeTG/G++ruUugj2+qfBGc7lxmG9R2V3UA1jXaGr8mfKAi1znL2F4waYCUbDYptp4h/gkV4Q3J4lbgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Node&amp;Pod\"\n        title=\"Node&amp;Pod\"\n        src=\"/static/4c44c334b2ddbc4d1517b4c3ff673298/37523/Node%26Pod.png\"\n        srcset=\"/static/4c44c334b2ddbc4d1517b4c3ff673298/e9ff0/Node%26Pod.png 180w,\n/static/4c44c334b2ddbc4d1517b4c3ff673298/f21e7/Node%26Pod.png 360w,\n/static/4c44c334b2ddbc4d1517b4c3ff673298/37523/Node%26Pod.png 720w,\n/static/4c44c334b2ddbc4d1517b4c3ff673298/76823/Node%26Pod.png 1038w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 21.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAlUlEQVQY012QWw7FIAhEu/9l9rPW2qh9WXWaQ2Jyc0lwBAcYmUopwu/71rIs2vddWM5Z67paDM7zrG3bFGO0+HkeXddlOThgCEHT+746z9OS3ntDyOTA3rtaa6q1atj/Hc7AST9GIUpxph/HYUpBlKWUzMnxjsOlDmHWkGNMQh0F48vEEClCPauhCauBxxDnnK1grOcDNhE2VAMutwYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Pod_Commu\"\n        title=\"Pod_Commu\"\n        src=\"/static/7674f1355507182fbefd3849981e31d7/37523/Pod_Commu.png\"\n        srcset=\"/static/7674f1355507182fbefd3849981e31d7/e9ff0/Pod_Commu.png 180w,\n/static/7674f1355507182fbefd3849981e31d7/f21e7/Pod_Commu.png 360w,\n/static/7674f1355507182fbefd3849981e31d7/37523/Pod_Commu.png 720w,\n/static/7674f1355507182fbefd3849981e31d7/38124/Pod_Commu.png 953w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>파드간 통신 흐름 : 별도의 오버레이 통신 기술 없이, VPC Native 하게 파드간 직접 통신이 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f ~/pkos/2/netshoot-2pods.yaml</code></pre></div>\n<p>먼저 위 명령어를 통해 테스트용 POD를 배포해주도록 하겠습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9.444444444444445%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAeUlEQVQI1z2OSwrDIABEs1Vj0NaqsTZ+caHk/seboIsuBgaG95jt634woSLGgJwzSikIIeC6LpznCeccGGMQQkApBUIIKKXgnP93rfXK7JsxGp/3C7VWeO8hpcRxHEs8gRgjUkqw1mKMgd477vteW2ttifZ9X2cm/wAg5zQY9TlbDAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"get_pod.png\"\n        title=\"get_pod.png\"\n        src=\"/static/055537801416ac118a5bfdf851ab21af/37523/get_pod.png\"\n        srcset=\"/static/055537801416ac118a5bfdf851ab21af/e9ff0/get_pod.png 180w,\n/static/055537801416ac118a5bfdf851ab21af/f21e7/get_pod.png 360w,\n/static/055537801416ac118a5bfdf851ab21af/37523/get_pod.png 720w,\n/static/055537801416ac118a5bfdf851ab21af/302a4/get_pod.png 1080w,\n/static/055537801416ac118a5bfdf851ab21af/daed9/get_pod.png 1426w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>배포한 POD를 보면 각각 다른 Node에 배포가 되어 있는것을 확인할 수 있습니다.</p>\n<p>이때 이 POD 끼리의 통신을 테스트해보도록 하겠습니다.</p>\n<p>먼저 각 워커 노드에 접속하여</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W1PIP</span>\r\n<span class=\"token function\">ssh</span> -i ~/.ssh/id_rsa ubuntu@<span class=\"token variable\">$W2PIP</span></code></pre></div>\n<p><code class=\"language-text\">  </code>\r\n<code class=\"language-text\">  </code></p>\n<p>아래 명령어를 통하여 패킷 덤프를 확인하는 명령어를 실행시켜 두도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> tcpdump -i any -nn icmp\r\n<span class=\"token function\">sudo</span> tcpdump -i ens5 -nn icmp\r\n<span class=\"token function\">sudo</span> tcpdump -i ens6 -nn icmp</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">POD1</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span>kubectl get pod pod-1 -o <span class=\"token assign-left variable\">jsonpath</span><span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>.status.podIP<span class=\"token punctuation\">}</span><span class=\"token variable\">)</span></span>\r\n<span class=\"token assign-left variable\">POD2</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span>kubectl get pod pod-2 -o <span class=\"token assign-left variable\">jsonpath</span><span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>.status.podIP<span class=\"token punctuation\">}</span><span class=\"token variable\">)</span></span>\r\nkubectl <span class=\"token builtin class-name\">exec</span> -it pod-1 -- <span class=\"token function\">ping</span> -c <span class=\"token number\">2</span> <span class=\"token variable\">$POD2</span></code></pre></div>\n<p>pod 1 shell 에서 pod2 로 ping 테스트</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl <span class=\"token builtin class-name\">exec</span> -it pod-2 -- <span class=\"token function\">ping</span> -c <span class=\"token number\">2</span> <span class=\"token variable\">$POD1</span></code></pre></div>\n<p>pod 2 shell 에서 pod1 로 ping 테스트</p>\n<p>먼저 any 에서의 패킷 덤프는 확인이 되었습니다.\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABS0lEQVQoz02Sx47CQBBEfUSICxLBeQk2DoyNAwLt/v9/1eq1NJYPrelQU1VtT5C5VHEdKWpCxW2kpIuUlz9q6kZFWagoCmVZpsvlovv9bvn5fFYURTqdTtrtdhabzUbb7VZB73oR8zCrrVq5xmkaRrnO6fF4qKoq1XWttm0tnHPq+9567/fb5kmSmGCapgoA1U2t379fAwF4vV7mDMLn82kk9IdhWOqmaYyYPtjP52OkQVmWtgpDBuSI3G43Xa/XpUcgSA0ZM4/L89xyzgAQTuZ5XhziAiBi9Kjpd11nWB84RQhnzIyQJuzf79eUIWA1//3WK47jaBfZhvk0TYZHnByegAFO/Hcj9w5R98TMuEDtV1079PmyMupcXK8Cif/Lvs+JWwhx6gkxgRlb+XA42K8/Ho8WcRzbGyNfn7y9MAztHfra3+HJ7Pd7/QMOEgEQwKacuwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"tcpdump_any.png\"\n        title=\"tcpdump_any.png\"\n        src=\"/static/75e22e2353f5bf36b48572b7ffddad8b/37523/tcpdump_any.png\"\n        srcset=\"/static/75e22e2353f5bf36b48572b7ffddad8b/e9ff0/tcpdump_any.png 180w,\n/static/75e22e2353f5bf36b48572b7ffddad8b/f21e7/tcpdump_any.png 360w,\n/static/75e22e2353f5bf36b48572b7ffddad8b/37523/tcpdump_any.png 720w,\n/static/75e22e2353f5bf36b48572b7ffddad8b/302a4/tcpdump_any.png 1080w,\n/static/75e22e2353f5bf36b48572b7ffddad8b/d93d9/tcpdump_any.png 1243w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>다음 ens5에서의 패킷 덤프또한 확인이 되었습니다.\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA20lEQVQY0z2QyRKDIBBEPapHD0ailiuySdAD+f8/61RPlTl0NUzDm4Gi92+8ncLLtlC+gwovDHqENQ760Nj3HeM4YpomrOsq3nUdlFJomgZlWaKua1RVJSqij/DGI51J3B0O6ZMQzgDvPZxz0FrDWosQAo7jQIzxX2/bVjQMA/q+RxE/USbJ3wznHYw1SFeSw7xMyAO47xvneYqYX9cljbjOOcuZwhgjz0opCYAhIdu2iZg/lzgx93RmBNOXZfmvC3Zn4YHwnwhgjWKzB84694Qz40TzPMu/sgn9B+6pjmNpwf+TAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"tcpdump_ens5\"\n        title=\"tcpdump_ens5\"\n        src=\"/static/e82dd90aa0f24c71e1ab89eb6585c705/37523/tcpdump_ens5.png\"\n        srcset=\"/static/e82dd90aa0f24c71e1ab89eb6585c705/e9ff0/tcpdump_ens5.png 180w,\n/static/e82dd90aa0f24c71e1ab89eb6585c705/f21e7/tcpdump_ens5.png 360w,\n/static/e82dd90aa0f24c71e1ab89eb6585c705/37523/tcpdump_ens5.png 720w,\n/static/e82dd90aa0f24c71e1ab89eb6585c705/302a4/tcpdump_ens5.png 1080w,\n/static/e82dd90aa0f24c71e1ab89eb6585c705/91608/tcpdump_ens5.png 1251w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>하지만 ens6에서는 패킷 덤프가 확인이 되지 않습니다.\r\npod간의 통신은 무조건 첫번째 ENI로만 빠져나가게끔 설정이 되어 있어서 ens6 로의 패킷 덤프는 확인이 되지 않는것입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 19.444444444444443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5UlEQVQY0z3NwXKCMABFUXZgEpRYcShMCBWMQRTQwdHa//+u22kWXdx5u/MiVcWoOkHWMeZWYZeabZFjqgJ/zHFtju/2FLnAWhsqyzKsMYYsy0jTFKUUUkoiXTp00aI/HR9NxVZrRCLZrFe4JqFvE4YuwTUrbvOF9/uHeZ653+8h733YYRgCHu1OCzt3Y9+/WR8qRBajpCJNFV9GcO4Ep4OkszFn3/B6fTONI9frlWmaArgsS0DzPCfSxqGrlm3tWds9aiOQQpFtJEcr6FuBawSdXTFPPc/ni3Ec//sDH49HONBa8wvtl2yAjtxjZQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ENI.png\"\n        title=\"ENI.png\"\n        src=\"/static/3754d512ee4bc3220c94e9d34cf19588/37523/ENI.png\"\n        srcset=\"/static/3754d512ee4bc3220c94e9d34cf19588/e9ff0/ENI.png 180w,\n/static/3754d512ee4bc3220c94e9d34cf19588/f21e7/ENI.png 360w,\n/static/3754d512ee4bc3220c94e9d34cf19588/37523/ENI.png 720w,\n/static/3754d512ee4bc3220c94e9d34cf19588/302a4/ENI.png 1080w,\n/static/3754d512ee4bc3220c94e9d34cf19588/dcccd/ENI.png 1127w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"4-pod에서-외부-통신\" style=\"position:relative;\"><a href=\"#4-pod%EC%97%90%EC%84%9C-%EC%99%B8%EB%B6%80-%ED%86%B5%EC%8B%A0\" aria-label=\"4 pod에서 외부 통신 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Pod에서 외부 통신</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVQY00VR/WvCMBD1//8jxn6U4RxDpkOdU5xTJ0wHk7FPEJyzLkmbpk3T9OONntYdPJK73L33jlSstYjjGEXcPT+iNmwjiDTlOgzRnY1w0qyh2rvCaauOi2GH3lbOBmeDazQmfTSmfVT7LTx9vaJijEGBQCmstxu8fL4jTVOUEScWTHnQ1sANffg6pHqSJmDSBfc9yFDBcTmi2KBSDhYkNrFwdjswxiCEABcCggu4nodIR1BKAXmOLMv2Z54dhdNsf6/keY4CpWqS/bsrQ5sIodZwpSQxzjkE5yT+yxjV1ME5OSwJS3Jyay2B1rYxYmMQmQhBEBCZlBJaa8oL98V2R8LsQDh7W6Laa+J7+0MDvpQYzB/oQxr3tzgftnGzmFLvmjm4HPfQmY/RXUxQH3WxXH3gD/BNw0drQQsWAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Pod_ExtCommu\"\n        title=\"Pod_ExtCommu\"\n        src=\"/static/bf19c100540a56b83c6f5d90db90acec/37523/Pod_ExtComm.png\"\n        srcset=\"/static/bf19c100540a56b83c6f5d90db90acec/e9ff0/Pod_ExtComm.png 180w,\n/static/bf19c100540a56b83c6f5d90db90acec/f21e7/Pod_ExtComm.png 360w,\n/static/bf19c100540a56b83c6f5d90db90acec/37523/Pod_ExtComm.png 720w,\n/static/bf19c100540a56b83c6f5d90db90acec/d7abb/Pod_ExtComm.png 959w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>파드에서 외부 통신 흐름 : iptable에 SNAT을 통하여 노드의 eth0 IP로 변경되어 외부와 통신합니다.</p>\n<p>VPC CNI의 External source network address translation 설정에 따라, 외부 통신 시 SNAT 하거나 혹은 SNAT 없이 통신 가능합니다.</p>\n<p>작업용 EC2에서 pod-1 shell에서 외부로 ping을 날려보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl <span class=\"token builtin class-name\">exec</span> -it pod-1 -- <span class=\"token function\">ping</span> -c <span class=\"token number\">1</span> www.google.com</code></pre></div>\n<p>다음 Pod-1에 접속해서 tcpdump를 해주겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> tcpdump -i any -nn icmp</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABEUlEQVQoz22R226DMBBEeUWgXCAmYMAYm6sDqdT//7epZqugNOrDapG9c5hZR6PW0LVBaXp459D3Pay1aNtWSmuNy+WCPM9xvV6RpqmUUkruiqKQ77qu5T7y3kOpAqooME0TqqrC6XSSQQ51XSfgpmmwLIsUNcYYOSOcnTP8joK18H6GHRc8HgHruooghCA1z7OcUUDnBI3jCOecOIvjWEBJkkhFum0weAfX/w5TyNhlWR5xGJexKXiJX9HfYeJwcw5r2BG+vrFtG/Z9P/rz+TwcE3673ZBl2fGz8/n8By4OrTGwvUNruuNBuLf33bHf73cBsfMxWIR/uo0I4Z6WecYwDOKGi39BKSSIsT/F/8X/AQXNtXAFFn4aAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"tcpdump_out.png\"\n        title=\"tcpdump_out.png\"\n        src=\"/static/4856f17c7f26d3939046356c461df536/37523/tcpdump_out.png\"\n        srcset=\"/static/4856f17c7f26d3939046356c461df536/e9ff0/tcpdump_out.png 180w,\n/static/4856f17c7f26d3939046356c461df536/f21e7/tcpdump_out.png 360w,\n/static/4856f17c7f26d3939046356c461df536/37523/tcpdump_out.png 720w,\n/static/4856f17c7f26d3939046356c461df536/302a4/tcpdump_out.png 1080w,\n/static/4856f17c7f26d3939046356c461df536/07a9c/tcpdump_out.png 1440w,\n/static/4856f17c7f26d3939046356c461df536/95e59/tcpdump_out.png 1460w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>tcpdump 에서 확인해보면 POD1의 IP 에서 외부로의 트래픽을 확인하실 수 있습니다.</p>\n<p>작업용 EC2에서 해당 명령어를 입력하여 작업용 EC2에서 외부와 통신할 때 사용하는 public IP 를 확인합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl <span class=\"token builtin class-name\">exec</span> -it pod-1 -- <span class=\"token function\">curl</span> -s ipinfo.io/ip <span class=\"token punctuation\">;</span> <span class=\"token builtin class-name\">echo</span></code></pre></div>\n<p>다음은 워커노드에서 아래 명령어를 입력하여 public IP를 확인합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -s ipinfo.io/ip <span class=\"token punctuation\">;</span> <span class=\"token builtin class-name\">echo</span></code></pre></div>\n<p>흥미로운 점은 2개의 Public IP가 같다는 점을 확인하실 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABk0lEQVQoz0WR63KiQBSE8/5PltrUmqirsqKCXAQGkeE6MDB8W2DWdNX5M9Wn53T3m+/7+L6H414RiUDKgrZVJIngkUvqukEIQRiGuK6L47hEcUwuC+qmJRUpeS7puo4Zb3xDFhW7ry9uYUTVdHz83nC6eFR1jRnH/zSCW8L7r0+8IEYWNYfNGs8P6Xv9FJymickYZFlz2lnEsaAoa+xLQHBLKcuKvu+ZecYY0kxyvASkd4msmmUn8EK6vn8KbjZbLMvCDxKOqw1pnKB6jWX7i6BSLe71ysw7WBaJyDjYHlle0rQK+3NNHInl00VwdzgSJ3cGbWiKiiaJGIcBPTwtzNm4Xsh2vl5kr7fRGFSWoWTOBGj9bdn3A7KHfGVkVAuqRsqGKLpTliVxkuI41xfPTBNMhkE+aHu9lNK27VNQlu1ybqc69DBwti9sV2uOJ4+P1Z4sLxjGkX4Ylpmzmvnns8tu/YeTG/G++ruUugj2+qfBGc7lxmG9R2V3UA1jXaGr8mfKAi1znL2F4waYCUbDYptp4h/gkV4Q3J4lbgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Node&amp;Pod\"\n        title=\"Node&amp;Pod\"\n        src=\"/static/4c44c334b2ddbc4d1517b4c3ff673298/37523/Node%26Pod.png\"\n        srcset=\"/static/4c44c334b2ddbc4d1517b4c3ff673298/e9ff0/Node%26Pod.png 180w,\n/static/4c44c334b2ddbc4d1517b4c3ff673298/f21e7/Node%26Pod.png 360w,\n/static/4c44c334b2ddbc4d1517b4c3ff673298/37523/Node%26Pod.png 720w,\n/static/4c44c334b2ddbc4d1517b4c3ff673298/76823/Node%26Pod.png 1038w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>위의 그림을 다시가져와 설명하자면\r\nPOD가 외부로 인터넷을 사용할 때 POD의 IP가 워커노드의 ENI0로 NAT가 되고\r\nENI0(192.168.1.64) -> 그림상 192.168.1.64로 표시되어 있지만 해당 실습에서는 다른 IP주소를 가지고 있습니다.\r\nENI0가 외부로 통신할 때에는 Public IP가 인터넷 게이트웨이를 통해 NAT가 되는 구조입니다.</p>\n<h2 id=\"5-노드에서-pod-생성갯수-제한\" style=\"position:relative;\"><a href=\"#5-%EB%85%B8%EB%93%9C%EC%97%90%EC%84%9C-pod-%EC%83%9D%EC%84%B1%EA%B0%AF%EC%88%98-%EC%A0%9C%ED%95%9C\" aria-label=\"5 노드에서 pod 생성갯수 제한 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. 노드에서 POD 생성갯수 제한</h2>\n<p>아래의 명렁어를 통해 EC2 사이즈 별 생성 가능한 POD의 갯수를 확인해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws ec2 describe-instance-types --filters <span class=\"token assign-left variable\">Name</span><span class=\"token operator\">=</span>instance-type,Values<span class=\"token operator\">=</span>c5.* <span class=\"token punctuation\">\\</span> --query <span class=\"token string\">\"InstanceTypes[].{Type: InstanceType, MaxENI: NetworkInfo.MaximumNetworkInterfaces, IPv4addr: NetworkInfo.Ipv4AddressesPerInterface}\"</span> <span class=\"token punctuation\">\\</span> --output table</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA4klEQVQoz5WQy3KEIBBFXSsPaUB8gaUYxUxlkU3m/7/sTsmUWY+LU7eh6QNFEQePbkmI6xeO48C6rgghYNu2XKeUEGPM6zOXZcG+75lzb57n/7Nnv/AhIO0bjiPl4RPn2izt+x5EBM45pJQQQuS86pOrd2XhvUeYpmxv2xbjOMA1FqquUVUVyrLM+SmFdSMa10FrC20s7PiAHb+hTQPBOaqKgbHPKZi0UGTBpIEiDRp+ocMfyA7g7H3rLaFQHcg4CNWAyMBMzwyZFpyz+0Jev1/IJUEpAvU/UN0Dda3yR98VvgClFaukrcnKQwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"EC2_SIZE.png\"\n        title=\"EC2_SIZE.png\"\n        src=\"/static/4c045fef5ec7a933660702295241d464/37523/EC2_SIZE.png\"\n        srcset=\"/static/4c045fef5ec7a933660702295241d464/e9ff0/EC2_SIZE.png 180w,\n/static/4c045fef5ec7a933660702295241d464/f21e7/EC2_SIZE.png 360w,\n/static/4c045fef5ec7a933660702295241d464/37523/EC2_SIZE.png 720w,\n/static/4c045fef5ec7a933660702295241d464/302a4/EC2_SIZE.png 1080w,\n/static/4c045fef5ec7a933660702295241d464/07a9c/EC2_SIZE.png 1440w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>현재 제가 생성한 워커노드의 사이즈는 C5d.large 입니다.</p>\n<p>생성가능한 POD의 계산법은 ((MaxENI * (IPv4addr-1)) + 2) 입니다.</p>\n<p>즉 C5d.large의 경우\r\n((3*(10-1))+2) 즉 29개의 POD를 생성할 수 있습니다.</p>\n<p>아래의 명렁어를 통해 생성가능한 POD의 갯수를 직접 확인하실 수도 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl describe node <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> Allocatable: -A6</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9ElEQVQoz51Sy26DMBD0lZcx5WEwGLUmHAohR6Ko+f/fmmpWbZRDD6GH0Xrt8Xh212pMNWz/AWM9uq5DCAHeezRNA2stxnHEMAzo+172ySHatn3skUM+oT47h6GooHWOoihQVZUc1HUteZ7n0FoL/lozElmWCdT1dsN6PmNdV3mJrn5fpos4jpEkyctQX/c7ptNJBHjZOYdpmiSSkKbpIajROWRRjCiKRLAsS3FpjBHCUVEV6gbevEH/9OC5T8wPC26XC95DwDzPMk2WyvK55mDo+pDgvu9YlkW+Cx1xwhSl2HPJrzpV27Y9SmMfOVmKM/5H8BvdPtlj//lHNQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"MAX_POD.png\"\n        title=\"MAX_POD.png\"\n        src=\"/static/532e5ec1bdca2ab0becc2928b132e9a5/37523/MAX_POD.png\"\n        srcset=\"/static/532e5ec1bdca2ab0becc2928b132e9a5/e9ff0/MAX_POD.png 180w,\n/static/532e5ec1bdca2ab0becc2928b132e9a5/f21e7/MAX_POD.png 360w,\n/static/532e5ec1bdca2ab0becc2928b132e9a5/37523/MAX_POD.png 720w,\n/static/532e5ec1bdca2ab0becc2928b132e9a5/e2e58/MAX_POD.png 1069w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>그렇다면 여기서 POD의 갯수가 생성가능한 POD의 갯수를 초과했을 때 어떻게 생성 가능한 POD의 최대 갯수를\r\n늘릴 수 있을것인지에 대해 확인해보도록 하겠습니다.</p>\n<p>아래 명령의를 통하여 Test용 POD를 배포해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f ~/pkos/2/nginx-dp.yaml</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAr0lEQVQY052QRw6FMBBDs6VG9F6EgAVL7n83f72RwgH+wpoW2zNxbduq6zqN46iQ932vpmmUZZm89xbLsrQ8TdMPcRxrGAZDVVWm4c7z1LqumqZJ931r33cTBHVd24wYSPM8W40hJkVRWI+cvnuex0QQft9Xx3GYE2Q22rbNHiZJYsCUOViW5TOFd12XHETWx4lz8zy3EwH9UIczwxeAMCMCZo5/wJkYRdG3yT9A4wdk+XpTL+NZqwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"POD_WATCH.png\"\n        title=\"POD_WATCH.png\"\n        src=\"/static/bc401920973e7a174795d609b2edac4d/37523/POD_WATCH.png\"\n        srcset=\"/static/bc401920973e7a174795d609b2edac4d/e9ff0/POD_WATCH.png 180w,\n/static/bc401920973e7a174795d609b2edac4d/f21e7/POD_WATCH.png 360w,\n/static/bc401920973e7a174795d609b2edac4d/37523/POD_WATCH.png 720w,\n/static/bc401920973e7a174795d609b2edac4d/302a4/POD_WATCH.png 1080w,\n/static/bc401920973e7a174795d609b2edac4d/07a9c/POD_WATCH.png 1440w,\n/static/bc401920973e7a174795d609b2edac4d/fe720/POD_WATCH.png 1448w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>POD가 정상적으로 기동되고 있는것을 확인하실 수 있습니다.</p>\n<p>그렇다면 POD의 갯수를 천천히 증가시켜보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl scale deployment nginx-deployment --replicas<span class=\"token operator\">=</span><span class=\"token number\">10</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/ElEQVQoz3WSR27FMAwFvXbvvfdy//MxGAYyguRnIZCi6OF7kq15nqWqKinLUvI815xYFIUkSaIriiLdx3EsQRCI7/ti27bmdV1LGIbaw7l1nqccxyHDMMi+7/I8j/R9L2maakPbtgoDkmWZAhhCnXP25F3Xad0Csq6rNE2jYAaglmYmU0cxiqiZYUQAOJqmSXDKYAVu2/YCr+t6VfwEOo6jNQNEERHgOI4KpO8FIvsT0FhGobFK5IoA4gaFuHwV/rZM/p9C1BiF3OkfhQCA8iHq7vv+aNkoNMOwbv4KgMuyfCvkkMv2PO99enLXdXXxuuxRyN6cEc2ix/R9AbeFzQPc5X+XAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"POD_WATCH2.png\"\n        title=\"POD_WATCH2.png\"\n        src=\"/static/9a121df361351d8b8cd13e383d9dd077/37523/POD_WATCH2.png\"\n        srcset=\"/static/9a121df361351d8b8cd13e383d9dd077/e9ff0/POD_WATCH2.png 180w,\n/static/9a121df361351d8b8cd13e383d9dd077/f21e7/POD_WATCH2.png 360w,\n/static/9a121df361351d8b8cd13e383d9dd077/37523/POD_WATCH2.png 720w,\n/static/9a121df361351d8b8cd13e383d9dd077/302a4/POD_WATCH2.png 1080w,\n/static/9a121df361351d8b8cd13e383d9dd077/07a9c/POD_WATCH2.png 1440w,\n/static/9a121df361351d8b8cd13e383d9dd077/16068/POD_WATCH2.png 1451w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>아직 POD 생성가능 갯수를 넘기지는 않았기에 별다른 이슈없이 POD 가 증가되었습니다.</p>\n<p>그렇다면 MAX POD를 넘어선갯수로 POD를 증가시켜 보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl scale deployment nginx-deployment --replicas<span class=\"token operator\">=</span><span class=\"token number\">40</span></code></pre></div>\n<p>다음 아래의 명령어를 통하여 Pending된 POD와 해당 원인에 대해 조회할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get pods <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> Pending\r\nkubectl describe pod <span class=\"token operator\">&lt;</span>Pending 파드<span class=\"token operator\">></span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> Events: -A5</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.111111111111107%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7klEQVQY021P23KEIBTzsa5OvQGirALe1xZXrf3/T0vnMLN9aR8ynBySEAI3L3CfGz62Hfv+xHVdcM7BWAtZlviqFPpaIc0y1HUNKSXCMEQcx4ii6A+C1Tkcx+HDzvP0gdu2odUaLM/xzUr0ssLb7QbOuQ99Bf6H4Nm06MyAZlgwDgMe6wpjDLTWqKTEou4w6g4uBJRSaNsWQggfXJaln+khxhiyLENgawXBuRfSMkkSLyQD8fc0RcEY+r5HURRI09QbSUc8z3N/vuZAG4Ou6zBNE+Z59kYCcWo6juPvzlrrNaSnOyrRNI3/DbWn3Q/FroOM9PFc+QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"POD_Pendding.png\"\n        title=\"POD_Pendding.png\"\n        src=\"/static/679eaf44b813df148ec5724906b7638c/37523/POD_Pendding.png\"\n        srcset=\"/static/679eaf44b813df148ec5724906b7638c/e9ff0/POD_Pendding.png 180w,\n/static/679eaf44b813df148ec5724906b7638c/f21e7/POD_Pendding.png 360w,\n/static/679eaf44b813df148ec5724906b7638c/37523/POD_Pendding.png 720w,\n/static/679eaf44b813df148ec5724906b7638c/302a4/POD_Pendding.png 1080w,\n/static/679eaf44b813df148ec5724906b7638c/07a9c/POD_Pendding.png 1440w,\n/static/679eaf44b813df148ec5724906b7638c/ab3e6/POD_Pendding.png 1441w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>해당 이슈를 해결하기 위한 아주 간단한 방법은\r\nEC2의 성능을 업그레이드 해주어 자본주의의 참맛을 보여주면 됩니다.</p>\n<p>자본주의의 참맛을 보여주기 어렵다면 다른방법을 찾아봐야 합니다.</p>\n<p>해당 방법은 가시다님이 참조해주신 블로그\r\n<a href=\"https://blog.psnote.co.kr/186\">https://blog.psnote.co.kr/186</a>\r\n<a href=\"https://trans.yonghochoi.com/translations/aws_vpc_cni_increase_pods_per_node_limits.ko\">https://trans.yonghochoi.com/translations/aws_vpc_cni_increase_pods_per_node_limits.ko</a>\r\n에서 안내해준 방법을 참고하였습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl scale deployment nginx-deployment --replicas<span class=\"token operator\">=</span><span class=\"token number\">0</span></code></pre></div>\n<p>먼저 replicas를 0으로 조절해줍니다.(Deployment를 지우는것이 아닙니다.)</p>\n<p>다음 아래 명령어를 통해 limitrange를 제거해주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl delete limitranges limits</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1klEQVQY01VQy46EMAzjylvALNDhWVrawtAOqx2hPfD/v+VVetuDlTqJ7LjB77ZjznI8ucb6vqDMDikElFKYpgmMMXRd59/jOP7jQgjUdY0wDBFFEeI4RuCsxdfjAcae2F8HjDHgnKPvewzDgKqqkOc5sixDmqa+EpIk8ZxmRVGgLEvfDz6LxE8/gm8nOn1CbS/Y48B937DWom1bfxVdtCyLNyJDMpNSYl1Xv0N9Eg0+ZoObObT9xmwc7PuE0RrXdcE552ORMH0BiTRN40EmxKlSZAJF/gNKQ2tXv/vgwAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"limit_range.png\"\n        title=\"limit_range.png\"\n        src=\"/static/79dcb12f3a86b8f13244da83ad007fcf/37523/limit_range.png\"\n        srcset=\"/static/79dcb12f3a86b8f13244da83ad007fcf/e9ff0/limit_range.png 180w,\n/static/79dcb12f3a86b8f13244da83ad007fcf/f21e7/limit_range.png 360w,\n/static/79dcb12f3a86b8f13244da83ad007fcf/37523/limit_range.png 720w,\n/static/79dcb12f3a86b8f13244da83ad007fcf/cc488/limit_range.png 928w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>다음 아래 명령어를 통해 POD를 증가시켜 보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl scale deployment nginx-deployment --replicas<span class=\"token operator\">=</span><span class=\"token number\">50</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAs0lEQVQI1z2OQWuEMBhEPbvarlQLIfliNFE2Rra2kUIvxf//p17RQ08Dw8ybKZIbcPUr91bxohztu8IYjfcerTXOOWKMzPPMOI6sKdFby7IsTNOEiFDXNWVZUlUVxdfzg1EEIxYZ/KUn5Awrpa5CCIGu65jCxOA99/aNR4yXdw5Zay/Y7XajyI9IHkbWbWf9/mV9frLvmeM4yDmzbdv/My3CrA0/YSYYQfoeo/UFTCnRNA1/cl1S2IW4StgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"MAX_POD2.png\"\n        title=\"MAX_POD2.png\"\n        src=\"/static/86d59b41a7d5c7fe097a66c74a8d4f6a/37523/MAX_POD2.png\"\n        srcset=\"/static/86d59b41a7d5c7fe097a66c74a8d4f6a/e9ff0/MAX_POD2.png 180w,\n/static/86d59b41a7d5c7fe097a66c74a8d4f6a/f21e7/MAX_POD2.png 360w,\n/static/86d59b41a7d5c7fe097a66c74a8d4f6a/37523/MAX_POD2.png 720w,\n/static/86d59b41a7d5c7fe097a66c74a8d4f6a/82b28/MAX_POD2.png 931w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>POD의 최대갯수가 49개까지 늘어났습니다만… 아직 목표인 100대 이상에는 모자릅니다.\r\n다시 replicas를 0으로 조절해주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl scale deployment nginx-deployment --replicas<span class=\"token operator\">=</span><span class=\"token number\">0</span></code></pre></div>\n<p>수정하기 전에 Node의 External IP 주소를 확인해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get node -owide</code></pre></div>\n<p>저희가 해볼 방법은 kops cluster 를 수정하는 방법입니다.\r\n이 과정에서 노드에 대한 rolling update를 진행해 줄것인데 Node가 재배포되가 될것입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 16.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAjklEQVQI1zWOSw6EIBBEOQIaQVAHBggysMP7360m1YmLF2i6Pqj8CfiGiFQbUkporWGMIez7Du89rutCzhnOOdEYY4RSCrZtE12MEVprqBAjfr3jmRO9d1nUWnHfN0IIYqTphQUMWNdVipZlgbUW53lKoWILfzPnIydnBhIaKGIAofE4Dnln+FtIDe/c/QEbhFBRe6BnpgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"node_externalIP1.png\"\n        title=\"node_externalIP1.png\"\n        src=\"/static/d4d4d062dd2c123151a536aaf59ea452/37523/node_externalIP1.png\"\n        srcset=\"/static/d4d4d062dd2c123151a536aaf59ea452/e9ff0/node_externalIP1.png 180w,\n/static/d4d4d062dd2c123151a536aaf59ea452/f21e7/node_externalIP1.png 360w,\n/static/d4d4d062dd2c123151a536aaf59ea452/37523/node_externalIP1.png 720w,\n/static/d4d4d062dd2c123151a536aaf59ea452/302a4/node_externalIP1.png 1080w,\n/static/d4d4d062dd2c123151a536aaf59ea452/07a9c/node_externalIP1.png 1440w,\n/static/d4d4d062dd2c123151a536aaf59ea452/8b640/node_externalIP1.png 1454w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>다음 kops cluster 를 수정해주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kops edit cluster</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAABJ0AAASdAHeZh94AAAByElEQVQoz6XR227aMBjA8SC1DbHjJBAndjgkjnMgRyhpoYNm6qS16s32CHsStCIkrvKgiHuuIdM0saKJdpr21yff/WxZn1D27bskGdp2SMiA0MAw7wiVIZSPIYREUeScb7fbuq73+319TCj7zvNs/jyZPt3efvvydWQ7/4A9x7nJ85s8T3yfdTp900QAQAgRQn/HbV13GCOUtnRd0TSIkI6xqqqSJIHjLW/i8XhcluXsw+x+Pv/08BANBsM8Hw2HaZpy1+WcM8YMw3Bd9wzmnhelaZxlXhj+njCOTctqGxgipKpqs9k8/3Loup8nk4+j66TXswC0Va2LlJ6iEEmiAJjw3T9nhnmfZSljgWVxSh2MfUoZxj4hnNLMJJaiXFxdeWexL8t9hMbhIHNYyf2ibyeOE/V6OXMj2yk63a6iXIjieXwdx0/T6eNkOomigrHU6uSMxd1uZtsBIQQAVVHEtzC1rEGShHHcxvhSkpoQNiGU5F+nDN7fMyXU930DY03T2q1Wu/UzTVVfR9MAAEEQnMGmaRZFoes6OgYhFE5qNBqCIBBCNpvNn3i9XldVtVqtvp/0ctJyuVwsFlVV7Xa7uq4Ph8Mrrv+jH84uf1wi6pASAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"kops_edit.png\"\n        title=\"kops_edit.png\"\n        src=\"/static/458ef2f22e3c6ed321038d0308d1ff3a/37523/kops_edit.png\"\n        srcset=\"/static/458ef2f22e3c6ed321038d0308d1ff3a/e9ff0/kops_edit.png 180w,\n/static/458ef2f22e3c6ed321038d0308d1ff3a/f21e7/kops_edit.png 360w,\n/static/458ef2f22e3c6ed321038d0308d1ff3a/37523/kops_edit.png 720w,\n/static/458ef2f22e3c6ed321038d0308d1ff3a/4c42d/kops_edit.png 896w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>위 그림의 표시된 부분을 수정해준 뒤 저장해주도록 하겠습니다.\r\n이때 들여쓰기에 유의해주시길 바랍니다.\r\n저는 아래의 amazonvpc.env 부분을 수정할때 들여쓰기랠 해주지 않았어서 cluster를 수정했음에도 불구하고 저장이 되지 않는 이슈가 있었습니다..ㅜㅜ\r\n만약 cluster 수정에 성공하였다면 저장하였을때 약간의 로딩시간이 있고\r\n다시 kops edit cluster로 들어가서 저장된 내용을 확인해주셔야 합니다.</p>\n<p>수정이 성공적으로 되었다면 아래의 명령어를 통해 rolling update를 진행해 주도록 하겠습니다.\r\n대략 10분 정도의 시간이 소요될것입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kops update cluster --yes <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">echo</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">sleep</span> <span class=\"token number\">5</span> <span class=\"token operator\">&amp;&amp;</span> kops rolling-update cluster --yes</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHElEQVQoz42S27KCMAxF+4ioyKhcRKA4chXw//8uzspMHDxP52FN2rTZSZq6rKilKCtpvJf7/S5lWUpVVbq+3W4/68vlIkmSSJqmcr1e5Xw+y+FwkP1+rxac97U0jdfAuq4VRLkcRdEPx+NRQSAMwx8hE3ZkL4pCq7AKDfxbqBAQRdBAyMSd916aplGBx+Mh7IFK8bNu21bPSJjnuVrrCEsy/HEci1vXVd7vt3Rdp3aeZxnHUaZpkr7v1eIbhkGDaJ3ALafTSf1aIZcRpYplWb6C8Hq95Pl8fivmXYMg0DZ3u52ybR0cmRFBEBGqshbBnoO2sizTKSP8F6bOmbMB8BYE2IXtJBkC7WBpD7uduu3BoWp/a2sNMtuX+A8f/l7jiwPO1KQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"rollingUpdate.png\"\n        title=\"rollingUpdate.png\"\n        src=\"/static/6069011ce3a561ff0483b664bbbaf121/37523/rollingUpdate.png\"\n        srcset=\"/static/6069011ce3a561ff0483b664bbbaf121/e9ff0/rollingUpdate.png 180w,\n/static/6069011ce3a561ff0483b664bbbaf121/f21e7/rollingUpdate.png 360w,\n/static/6069011ce3a561ff0483b664bbbaf121/37523/rollingUpdate.png 720w,\n/static/6069011ce3a561ff0483b664bbbaf121/302a4/rollingUpdate.png 1080w,\n/static/6069011ce3a561ff0483b664bbbaf121/07a9c/rollingUpdate.png 1440w,\n/static/6069011ce3a561ff0483b664bbbaf121/9c6a1/rollingUpdate.png 1869w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAiUlEQVQI1zVNSwqFMBBzXSyC9uOvtG5KXwW9/+nySMBFmMwkmQy9Vpwpo1wXev9h2zaEEOC9RykF67pq3/dd4C3GKE6Pc04ea63uw/M8eN8X930LKSWZlmVRYJom7eR8fByHgpwsJ885q4D60HtHaw21VoEGto3jiHmeYYzRcz7lztBXQFBj5tP/HGNNrf/LcfwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"node_externalIP2.png\"\n        title=\"node_externalIP2.png\"\n        src=\"/static/5b542d5b657eb1e54a420cd0a92087a6/37523/node_externalIP2.png\"\n        srcset=\"/static/5b542d5b657eb1e54a420cd0a92087a6/e9ff0/node_externalIP2.png 180w,\n/static/5b542d5b657eb1e54a420cd0a92087a6/f21e7/node_externalIP2.png 360w,\n/static/5b542d5b657eb1e54a420cd0a92087a6/37523/node_externalIP2.png 720w,\n/static/5b542d5b657eb1e54a420cd0a92087a6/302a4/node_externalIP2.png 1080w,\n/static/5b542d5b657eb1e54a420cd0a92087a6/07a9c/node_externalIP2.png 1440w,\n/static/5b542d5b657eb1e54a420cd0a92087a6/25be5/node_externalIP2.png 1893w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABVUlEQVQoz5VT24rCMBTsm9pW7f2StEldsQW3irAq6v//1yxzoN1lWaF9GJKQZM7MJMc5xSn6MIGuOwR5Da0V2rZFXdfI8xxVVWG/38vYNA2MMbLHtbVW1tzXWqMoCjg7Y3BsO9R5BlUWiOMYWZahLEvBer3GcrnEarV6i2HfdV04xlo8nk+cLxccj0eEYThWS9NUCH3fnwynthaffY8gDLHdbqUaLXVdJ0pZlQc9zxsvvZsLoU4y6ChG7Pmj7CAI5CDJhwsc/17+V+FOaXTGQicpkjRFFEVIkgRKKQEjmEL0Y9kYXG83sc0MmRsfgxkSg9rJhHyUr+sVSmtRRpv8DofDQch/ZzjJclWUqLIMG9cdM6TtwersDD9KhbZUUHzlIBAigv+RijebzTzLtmnweL1wOp/R9710B/8hwW6g2lmEbKf7/S4tRLLFYiEZsv24ZgxzLH8DJjoi6ZnoBcUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"MAX_POD3.png\"\n        title=\"MAX_POD3.png\"\n        src=\"/static/03f391b78a3bea60d0cb806d934c62c6/37523/MAX_POD3.png\"\n        srcset=\"/static/03f391b78a3bea60d0cb806d934c62c6/e9ff0/MAX_POD3.png 180w,\n/static/03f391b78a3bea60d0cb806d934c62c6/f21e7/MAX_POD3.png 360w,\n/static/03f391b78a3bea60d0cb806d934c62c6/37523/MAX_POD3.png 720w,\n/static/03f391b78a3bea60d0cb806d934c62c6/84ee5/MAX_POD3.png 1076w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18.88888888888889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtklEQVQY03WPyQ6DMAxEObMeIYkTskJAiFKJ//+1qWKpXKoeRrbH8rNdbS5B5jdcSLiuF+77xrqu8N7jOA5IKSGEgDEGzrmnJiL2xnHENE1QSnGv0kJB2AQyM1KMiDHCWovzPDnPOXNd8gLUWqPrOtR1jaZpnvhVZSRB+gxFBjmvWJaFtxVQuWDbNoYUf55nhvd9z8Nt2/6o0kTQLkARIYQAax2/tO87xwIsr6SUGFyuHIbhL/ADwidpX+/rMewAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"MAX_POD4.png\"\n        title=\"MAX_POD4.png\"\n        src=\"/static/4a5032fa8dd877fc2b42d644d1e3b541/37523/MAX_POD4.png\"\n        srcset=\"/static/4a5032fa8dd877fc2b42d644d1e3b541/e9ff0/MAX_POD4.png 180w,\n/static/4a5032fa8dd877fc2b42d644d1e3b541/f21e7/MAX_POD4.png 360w,\n/static/4a5032fa8dd877fc2b42d644d1e3b541/37523/MAX_POD4.png 720w,\n/static/4a5032fa8dd877fc2b42d644d1e3b541/302a4/MAX_POD4.png 1080w,\n/static/4a5032fa8dd877fc2b42d644d1e3b541/84f4d/MAX_POD4.png 1208w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>POD의 최대개수 증설이 성공적으로 되었습니다.</p>\n<h2 id=\"6-k8s-service\" style=\"position:relative;\"><a href=\"#6-k8s-service\" aria-label=\"6 k8s service permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. K8S Service</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiElEQVQoz3WSW2vbQBCF/e/7nOf+iPYhcTCkUGjpDdyapApOsRNXlmxptbL2Iu2uY0tfkcBtCcmBgZnzcObMZXRwDXtjcFrjlMJZS6UUqtqhlMIYg9Yaay1aK2pr6bqO59Dzo+/TKUkc9yXt8Uh0PePr50+ExwNt2w5CURShtcEYS9M4Qgg45/E+4LwneP+3yWg8HvNjNqMv90co372mvDyjDTW0x0FAyB2FLMhEQZwkKG0RhWSz3ZILSS7Kf4K3UUScbDBNi1QBcXGGePMKvVrjc4lOVySrLb9u1yzuYh6WGdo68rxk/nNB/HvDJiuGCXvN0X8bYJHWzKKUUlZ4BSaDfKmYX82Zv5fcXEoevhi89aTLFfHdkq2oyHIJJ4e91VPcJ4bo5h6bp3QcB67dw8E84oucOttisxSVxNR5hm9qfAjDTrungj36o4jpFesPb6lUw/7Qke0aPk4ThCwpyhLnAy9huPIp6dG/x2Qy4eL8nFLKgROV49t1hlYaVVV454bxumeid/gHJbNeyoumGZkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"LoadBalancer.png\"\n        title=\"LoadBalancer.png\"\n        src=\"/static/30d7c36ab2456d720e2492440df57f88/37523/LoadBalancer.png\"\n        srcset=\"/static/30d7c36ab2456d720e2492440df57f88/e9ff0/LoadBalancer.png 180w,\n/static/30d7c36ab2456d720e2492440df57f88/f21e7/LoadBalancer.png 360w,\n/static/30d7c36ab2456d720e2492440df57f88/37523/LoadBalancer.png 720w,\n/static/30d7c36ab2456d720e2492440df57f88/1ff84/LoadBalancer.png 1040w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>이번 실습에서 저희가 진행 할 방법은 AWS LoadBalancer + NLB IP 모드 동작 방식으로 진행하도록 하겠습니다.\r\nPOD의 IP가 LB의 백엔드풀에 바로 등록이 되는 방식 입니다\r\n(Node의 IP가 아닌 POD의 IP가 직접 등록되니 IP Table Rule또한 타지 않습니다.)</p>\n<p>실습을 위해서 먼저 LB 생성을 진행하도록 하겠습니다.</p>\n<p>그러기 위해서는 생성된 컨트롤플레인, 워커노드에 LB생성을 위한 권한을 부여해주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -o iam_policy.json https://raw.githubusercontent.com/kubernetes-sigs/aws-load-balancer-controller/v2.4.5/docs/install/iam_policy.json\r\naws iam create-policy --policy-name AWSLoadBalancerControllerIAMPolicy --policy-document file://iam_policy.json\r\n<span class=\"token assign-left variable\">ACCOUNT_ID</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">`</span>aws sts get-caller-identity --query <span class=\"token string\">'Account'</span> --output text<span class=\"token variable\">`</span></span>\r\naws iam attach-role-policy --policy-arn arn:aws:iam::<span class=\"token variable\">$ACCOUNT_ID</span>:policy/AWSLoadBalancerControllerIAMPolicy --role-name masters.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span>\r\naws iam attach-role-policy --policy-arn arn:aws:iam::<span class=\"token variable\">$ACCOUNT_ID</span>:policy/AWSLoadBalancerControllerIAMPolicy --role-name nodes.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span></code></pre></div>\n<p>위의 명렁어를 모두 입력해 주었다면 AWS Management Console -> IAM 역할로 이동하셔서 각 masters.도메인, nodes.도메인 으로 이동하셔서 아래와 같이\r\n권한이 잘 부여가 되었는지 확인을 해줍니다.\r\n권한이 부여되어있지 않다면 LB 생성이 불가능 합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHklEQVQoz41SXXOEIBDj///F62N75weggAIimk52ivWe2p1ZI7KbbED1fL7weHzAWIvzPDFNE4wxgsuy4L9Ra0UIAWrbNqSUUeshhDklQQaRue+7NLQ8jkMwpYQYo7yXUmQAxQcbGkFYAtZ1Rc4ZFGNQhHVsJgn3iPM8v31nvfLhl/A4T/i0YK/1zQ73W81foWIulzXJsqFsm6jRRlNm3uvucV+L5fxjjRGChzYGa0yX7Tbh/Rx5LJO1chGss9aKdTU7hzXGS8l7j77vr5tuyfNiM/eJXI/jCK211A7DIKhkilIuQqq8Xh0+nwMGPaEbLebZwTsnZCTqug7OOSFugk1IcbpyEQIpRYza4KszGPUkZM55aWjJqUh8/9b+lm8u3rx1d0qG0QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"IAM_CHECK.png\"\n        title=\"IAM_CHECK.png\"\n        src=\"/static/626693ed98bc89abc070896108b5b20a/37523/IAM_CHECK.png\"\n        srcset=\"/static/626693ed98bc89abc070896108b5b20a/e9ff0/IAM_CHECK.png 180w,\n/static/626693ed98bc89abc070896108b5b20a/f21e7/IAM_CHECK.png 360w,\n/static/626693ed98bc89abc070896108b5b20a/37523/IAM_CHECK.png 720w,\n/static/626693ed98bc89abc070896108b5b20a/302a4/IAM_CHECK.png 1080w,\n/static/626693ed98bc89abc070896108b5b20a/07a9c/IAM_CHECK.png 1440w,\n/static/626693ed98bc89abc070896108b5b20a/d61c2/IAM_CHECK.png 1800w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>다음으로 kops cluster를 업데이트 해주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kops edit cluster --name <span class=\"token variable\">${KOPS_CLUSTER_NAME}</span></code></pre></div>\n<p>다음 아래 그림에 표시된 내용을 입력해주도록 합니다.</p>\n<p>Cert-manager는 K8S Cluster 내 에서 TLS 인증서를 자동으로 프로비저닝 및 관리하는 오픈 소스 입니다.\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAABJ0AAASdAHeZh94AAABNUlEQVQoz42SyW7DMAxEdYwkypYtVYvlVYbjLfXW5tBr//+jigTNIUnR+IEgBgSGnAMR5kcc9Tg+Yd7gqMPRcOANiUfgFeUVufSC8vKqPYkaCB2EhnIHgUDSeKGyWCbizcXSCZVJndFAUQAAeqsH/Qta5mk6jXVdWWu0lIkUmXqLgXJgATC4g8H9BJXer9vWtG3pfcy5ICAJaGAaGH849ASafT17P+Z5KYQBSAAkY/g54t9mpT+XZRvHtqpSrQspfRhioAxeg2Zjv4ZxKcvv7eM9z1shiyDEALvMxtq+77M0ZYzhw4FSSmEvyFq7LEvXdXVdc87ZjV3mJEnWde26Lr/inEvT1DlnjHm5Agkh5nmepinLMiklIeTyEHRXfEQpPR6P5/N5GIaiKLz3+opSKoqi/1f8AKvQM5ZMTpFwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Edit_Kops.png\"\n        title=\"Edit_Kops.png\"\n        src=\"/static/ae30b4022f40e4ff07c7441623e21121/37523/Edit_Kops.png\"\n        srcset=\"/static/ae30b4022f40e4ff07c7441623e21121/e9ff0/Edit_Kops.png 180w,\n/static/ae30b4022f40e4ff07c7441623e21121/f21e7/Edit_Kops.png 360w,\n/static/ae30b4022f40e4ff07c7441623e21121/37523/Edit_Kops.png 720w,\n/static/ae30b4022f40e4ff07c7441623e21121/302a4/Edit_Kops.png 1080w,\n/static/ae30b4022f40e4ff07c7441623e21121/78415/Edit_Kops.png 1207w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>다음 Rolling update를 통하여 업데이트를 적용해주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kops update cluster --yes <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">echo</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">sleep</span> <span class=\"token number\">5</span> <span class=\"token operator\">&amp;&amp;</span> kops rolling-update cluster</code></pre></div>\n<p>성공적으로 업데이트 되었습니다!!</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaElEQVQoz12S2bKCQAxEfVVQBDcUVBAUVxa1yv//stw6sTIl96FrBk063ekZHI9HSdPUYblcynw+lyiKFNPpVDzPk9Fo5P6L41hms5me4/FYf/N9X+sG1+tVTqeTknEyYL/fK7Isk6Io3KDNZiPr9Vput5sjhYieIAi+hI/HQ+73uzY3TSNd18lqtdICMBwOtQlAAtq2deogKctSJpPJl5Bpl8tFttutEtd1reBeVZXkea6qfgkRYUNZBS5ZD/cBjZBikckGSLGKTdujEeKEE1UM6ik0QixzAlMJUE4hsB3+JzwcDv1QzuezKmS59o0dlh6GodsVZBAhAstGiBircaGwKxQxHVLSZQB2aCYcI7RQTBW1jtAUMQViAsI2gwiFYp4Min9D4WQQYfQUoogCGp/PpxK+32/5fD7yer1UFU0Qcgc8LU4eNIH1FCZJIgAVpGrfrGC328lisVC7FEPMTgmKu4WFUgvlD9VDIlwEt2aQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"kops_check.png\"\n        title=\"kops_check.png\"\n        src=\"/static/cf49637587da42417c0eaa7870908515/37523/kops_check.png\"\n        srcset=\"/static/cf49637587da42417c0eaa7870908515/e9ff0/kops_check.png 180w,\n/static/cf49637587da42417c0eaa7870908515/f21e7/kops_check.png 360w,\n/static/cf49637587da42417c0eaa7870908515/37523/kops_check.png 720w,\n/static/cf49637587da42417c0eaa7870908515/302a4/kops_check.png 1080w,\n/static/cf49637587da42417c0eaa7870908515/d318f/kops_check.png 1421w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>아래 명령어를 입력하여 Deployment &#x26; Service 를 생성해주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f ~/pkos/2/echo-service-nlb.yaml</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABMUlEQVQoz4WS3W6DMAyFc9lfWgpNCC2BAqUqiPd/PE+fJ0+TtmkXR06s+JxjO86XUfK6ldQ00nWdtG0rj8dDz33fK4ZhkKIoJM9z2e/3cjgc/oQLVZDKXyWEoEWXy0Xqupbr9TNHjDEqmqaR7Xb7VfwbuRuGUVLXy/v9lnVd1RGEVVXJ6/VSx5CCaZr+demCj1LERh2klGQcR233drvJsixKiMA8zyoGMYS73e4HyDsKmV9ZlpqAAGcUPp9PFTqfzxqPx6MClwZGBDhnWSaOueCARSh5SkpIzgAhgszUe6/R5stoAHfeufv9LkaKAhuFEGIemgsib0+nk2w2G22RCFiU5RxFqKNMIQVEW8R3QpszeVq37fM7iLxzDJpWSUCOU7vTBnc6IIew3e2bsVkTZMsf7jfhhi5IF18AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Service_Check.png\"\n        title=\"Service_Check.png\"\n        src=\"/static/67a7c218e9b1e2e50ba78a8db95ca152/37523/Service_Check.png\"\n        srcset=\"/static/67a7c218e9b1e2e50ba78a8db95ca152/e9ff0/Service_Check.png 180w,\n/static/67a7c218e9b1e2e50ba78a8db95ca152/f21e7/Service_Check.png 360w,\n/static/67a7c218e9b1e2e50ba78a8db95ca152/37523/Service_Check.png 720w,\n/static/67a7c218e9b1e2e50ba78a8db95ca152/302a4/Service_Check.png 1080w,\n/static/67a7c218e9b1e2e50ba78a8db95ca152/07a9c/Service_Check.png 1440w,\n/static/67a7c218e9b1e2e50ba78a8db95ca152/16068/Service_Check.png 1451w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>AWS Management Console에서 LoadBalancer을 들어가보면 POD의 IP가 LB의 백엔드풀에 등록되어 있는것을 확인하실 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 45.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABS0lEQVQoz41R2U4DMQzc76eoQNWKFtSqQJH4M849mmzuZAeN2a1QHxCRLMexPR5Pqs3+BZvtAYvVBpfXK8yulriY32A2X2Cx3mJ1/4jl3cMftsft9gnr3TPWuwMqjCfnDKU1dN9Da43ueESIAf8/A0rJqKy1SCnhq67RNA2sNeAbTQZoLd4YvjsY62Cdg/d+rHNw3o+xQ2WMRcpZGLE4poxUBpkZQkAp5cSBORczUv7Js49kpsPaiivGGHFUCtZ5hJSRy4CYAoZhbPQeJeeTNNOQ83uIkQwNcilouw7tUUEpJWybthU/aUrfG3PSmXfJnd0rBkQnwOvbOz4+vyRBKZgz1Mk58TTnnGg3xRNg23ZCShhy5d9TYkqiH/VhjpZHvQg2xayZ+mkcXHFFAvCXCMaV2Nj3Rn6PAJweQoQPAbWqpZZ6MWYNgeMYfwMsaqepPBxM9gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"LoadBalancer_2.png\"\n        title=\"LoadBalancer_2.png\"\n        src=\"/static/de5d9b190aab6fb275d2e145c71eb719/37523/LoadBalancer_2.png\"\n        srcset=\"/static/de5d9b190aab6fb275d2e145c71eb719/e9ff0/LoadBalancer_2.png 180w,\n/static/de5d9b190aab6fb275d2e145c71eb719/f21e7/LoadBalancer_2.png 360w,\n/static/de5d9b190aab6fb275d2e145c71eb719/37523/LoadBalancer_2.png 720w,\n/static/de5d9b190aab6fb275d2e145c71eb719/302a4/LoadBalancer_2.png 1080w,\n/static/de5d9b190aab6fb275d2e145c71eb719/07a9c/LoadBalancer_2.png 1440w,\n/static/de5d9b190aab6fb275d2e145c71eb719/09262/LoadBalancer_2.png 1896w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"7-external-dns\" style=\"position:relative;\"><a href=\"#7-external-dns\" aria-label=\"7 external dns permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>7. External DNS</h2>\n<p>dns 관련 파드 갯수를 줄여보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl delete deploy -n kube-system coredns-autoscaler\r\nkubectl scale deploy -n kube-system coredns --replicas <span class=\"token number\">1</span></code></pre></div>\n<p>아래 명령어를 입력하여 컨트롤플레인, 워커노드에 ExternalDNSUpdate 관련 정책을 업에이트 해주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -s -O https://s3.ap-northeast-2.amazonaws.com/cloudformation.cloudneta.net/AKOS/externaldns/externaldns-aws-r53-policy.json\r\naws iam create-policy --policy-name AllowExternalDNSUpdates --policy-document file://externaldns-aws-r53-policy.json\r\naws iam list-policies --query <span class=\"token string\">'Policies[?PolicyName==`AllowExternalDNSUpdates`].Arn'</span> --output text\r\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">POLICY_ARN</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span>aws iam list-policies --query <span class=\"token string\">'Policies[?PolicyName==`AllowExternalDNSUpdates`].Arn'</span> --output text<span class=\"token variable\">)</span></span>\r\naws iam attach-role-policy --policy-arn <span class=\"token variable\">$POLICY_ARN</span> --role-name masters.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span>\r\naws iam attach-role-policy --policy-arn <span class=\"token variable\">$POLICY_ARN</span> --role-name nodes.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span></code></pre></div>\n<p>위에서 LB에 대한 권한을 확인했듯이 똑같이 IAM 에서 AllowExternalDNSIPdates를 확인해주도록 합니다.\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAwUlEQVQY012Q266FIAxE+f/vNFELggp4Izon02w5xIeVlrZML2bfMraccZWCUgqu61JL7vuuPM+jvH6ba2vMuq5wziHGhJQS9n3HeZ5KaZocx1FhLucMP03w3uu/6eebZVnQ9z1ERjhnYa2FiGgTFr0wTsZxrD4ZhgHS5Ay7TWGG+Ag3J+Ttf8I61e/NSbkRoc9YuxFRwTCvKhiWhJQ3LSIU+1qKcas31sImJoSArusgYrU4xlin+MIc78X70X6h6B/Vks8j8Qs5hAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"External_IAM.png\"\n        title=\"External_IAM.png\"\n        src=\"/static/f5522e7f7244697f68bf030165a33f8c/37523/External_IAM.png\"\n        srcset=\"/static/f5522e7f7244697f68bf030165a33f8c/e9ff0/External_IAM.png 180w,\n/static/f5522e7f7244697f68bf030165a33f8c/f21e7/External_IAM.png 360w,\n/static/f5522e7f7244697f68bf030165a33f8c/37523/External_IAM.png 720w,\n/static/f5522e7f7244697f68bf030165a33f8c/302a4/External_IAM.png 1080w,\n/static/f5522e7f7244697f68bf030165a33f8c/07a9c/External_IAM.png 1440w,\n/static/f5522e7f7244697f68bf030165a33f8c/91b67/External_IAM.png 1527w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>다음 kops edit cluster 명령어를 통해 아래 표시된 부분을 수정 후 업데이트 해주도록 하겠습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAABJ0AAASdAHeZh94AAABWklEQVQoz43QyW7CMBAGYIsLyXicxSGOnYWSJjhgcINAolIPfY8KDsCFM7z/oUpoeyvwaWRZsv/xQhy+dnjrcOsEc5evukk4h8gCNxBqyhvghgYvEE6BaxpqiFoaTKifoa8IjydBNObxeCS6MRKTUTLBIEPmI7rYoYgMf9C+EJmHyIiZ6UbXeZ4KMYrjKJGxSiUi0Numf3WrpF2t6qou8kIqFSNLARXQFL2ceQLZ/QbEGDOdTquqklIyih5Qhuj35eED5L2qt6/VW5brKKpCbqWqw5BSik8gH81s+1otEtnmxUKln3OziAUAPBXWWhdFIYRwe47jwHPHdmFr7XK5LMtSKSWlTJIEn0batt1sNnVdp2k66rFfj8Pr9dpaa4xRSrmu+/dVjDHP8/y7SNM0ZVlmWXa7MADcHj8cDgeDAbnvcrlcr9fz+bzf74/H4+l0OvYOh8Nut/u66xvxKkb2iwQddQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"kops_edit_2.png\"\n        title=\"kops_edit_2.png\"\n        src=\"/static/518428931357f86b32d3aae38868918d/37523/kops_edit_2.png\"\n        srcset=\"/static/518428931357f86b32d3aae38868918d/e9ff0/kops_edit_2.png 180w,\n/static/518428931357f86b32d3aae38868918d/f21e7/kops_edit_2.png 360w,\n/static/518428931357f86b32d3aae38868918d/37523/kops_edit_2.png 720w,\n/static/518428931357f86b32d3aae38868918d/302a4/kops_edit_2.png 1080w,\n/static/518428931357f86b32d3aae38868918d/db3a5/kops_edit_2.png 1087w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>업데이트가 정상적으루 수행되었습니다!!</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.777777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAmUlEQVQI12WOzQ6EIBCDvfoHWVCRhYCsIGji+z9eDXPYw+7hSydN02kjtMdLe7yNQUoRIQSs64qUEo7jQIwR931j2zaUUnBdF3lV53mGtRbeezjn6G6MC7D+g1wKzrNQ2BhDxTlnKKWw7zuEEFiWBYwxcM6htUbbtn80XCowqSClpGU1OE0TFdSv4zii6zoMw0Da9/2X6v3yAJ2RTKbQSPaxAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"kops_edit_3.png\"\n        title=\"kops_edit_3.png\"\n        src=\"/static/b587e17428b8672ec0918260fc099fb5/37523/kops_edit_3.png\"\n        srcset=\"/static/b587e17428b8672ec0918260fc099fb5/e9ff0/kops_edit_3.png 180w,\n/static/b587e17428b8672ec0918260fc099fb5/f21e7/kops_edit_3.png 360w,\n/static/b587e17428b8672ec0918260fc099fb5/37523/kops_edit_3.png 720w,\n/static/b587e17428b8672ec0918260fc099fb5/302a4/kops_edit_3.png 1080w,\n/static/b587e17428b8672ec0918260fc099fb5/4d383/kops_edit_3.png 1195w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>아래 명렁어를 통해 테스트용 서비스/파드를 배포해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f ~/pkos/2/echo-service-nlb.yaml</code></pre></div>\n<p>다음 자신의 도메인 정보를 입력하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">MyDOMAIN1</span><span class=\"token operator\">=</span>nginx.korwoo.net\r\nkubectl annotate <span class=\"token function\">service</span> svc-nlb-ip-type <span class=\"token string\">\"external-dns.alpha.kubernetes.io/hostname=<span class=\"token variable\">$MyDOMAIN1</span>.\"</span></code></pre></div>\n<p>그럼 정상적으로 됬는지 확인해보도록 하겠습니다. 아래 명령어를 입력하면 IP주소가 출력될것입니다.(약 5분정도 시간이 필요합니다.)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">dig</span> +short <span class=\"token variable\">$MyDOMAIN1</span></code></pre></div>\n<p>이후 Route53에 접속하시면 등록한 도메인이 A레코드로 등록된것을 확인하실 수 있습니다.\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 49.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiUlEQVQoz41RW24UMRCc+/8gkIKCSFixEbCAuATiDIgLAJmXx++xx/YWqk4ygvATSy17xtVVXeXu+P4z3p2+4NXVAS8vX+PZ8wu8uLjE9eGIw80HXB8/PqFOuHp7wpubT+jw1wopI6aMUgvO5zNaa3jqaq2gtYpOG4tSK4wx+PnrN/pxwqI11LJg0QbKeizGQVuPEIKUDwFaG1jnBTtrC/PjG/T3r+ic86LgvBdS7iFErOuKlDNCXPfiP+Ktc1hTQkoJOWfkvCEHB28WdFQTQucQY8S2bbtV2i6loJQNtVbUUjEMI6Zp3iOprQmmtTNKbehCjDuh9x5aaznT2rom8J5nErJxGAb0wwClFJRaxDr7OAhLCLdSxCqL6ta6HUCbJCQZv6dpwjzfkXGneN42sc4Y/ptQzQrjOEo+nOoxIe/6fhDrfd/LhMQSF9f13ww54TzN0sA8SSgPQ8J7y9M8wxgr4ux5EG73WXYP48oLO4eRlpSS7DgRdwoRx2ZmeHvb7zWOd3jJMgT8ARHE8mts6XBxAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Route53.png\"\n        title=\"Route53.png\"\n        src=\"/static/3923e87e3c667f93a8111d8d0aa46f5c/37523/Route53.png\"\n        srcset=\"/static/3923e87e3c667f93a8111d8d0aa46f5c/e9ff0/Route53.png 180w,\n/static/3923e87e3c667f93a8111d8d0aa46f5c/f21e7/Route53.png 360w,\n/static/3923e87e3c667f93a8111d8d0aa46f5c/37523/Route53.png 720w,\n/static/3923e87e3c667f93a8111d8d0aa46f5c/302a4/Route53.png 1080w,\n/static/3923e87e3c667f93a8111d8d0aa46f5c/07a9c/Route53.png 1440w,\n/static/3923e87e3c667f93a8111d8d0aa46f5c/e1250/Route53.png 1786w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>과제3. 서비스(NLB)/파드 배포 시 External DNS 설정해서 각자 자신의 도메인으로 NLB 통해 애플리케이션으로 접속해보기</p>\n<p>다음은 voteing-app 서비스를 배포해보도록 하겠습니다.</p>\n<p>아래의 명렁어를 입력해 git clone을 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone https://github.com/dockersamples/example-voting-app</code></pre></div>\n<p>다음 vote 라는 namespace를 만들겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl create ns vote\r\nkubectl ns vote</code></pre></div>\n<p>다음 아래 명령어를 입력하여 서비스파일을 변경하도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">rm</span> -rf vote-service.yaml result-service.yaml\r\n<span class=\"token function\">cp</span> ~/pkos/2/vote-service.yaml <span class=\"token builtin class-name\">.</span>\r\n<span class=\"token function\">cp</span> ~/pkos/2/result-service.yaml <span class=\"token builtin class-name\">.</span>\r\n<span class=\"token function\">cat</span> vote-service.yaml <span class=\"token operator\">|</span> yh\r\n<span class=\"token function\">cat</span> result-service.yaml <span class=\"token operator\">|</span> yh</code></pre></div>\n<p>아래 명령어를 통해 서비스를 배포하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl apply -f <span class=\"token builtin class-name\">.</span></code></pre></div>\n<p>다음 아래 명령어를 입력하여 자신의 도메인에 ExternalDNS를 추가하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">MyDOMAIN1</span><span class=\"token operator\">=</span>vote.korwoo.net\r\n<span class=\"token assign-left variable\">MyDOMAIN2</span><span class=\"token operator\">=</span>result.korwoo.net</code></pre></div>\n<p>이후 입력한 도메인으로 접속하여 확인해봅시다!</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA8ElEQVQoz52T3UrDQBBG84Z6UfARvPABBVFRkIIg+BLthWljfja7M7MtHMlqMKZpwFwcFnZnznwMbFY3joRr8UFOCCIQhWNwxLaGGDAV2onajkwt0iFqfwhiHMzY1sbNOrK681zcOlb3xsvW4GB4sZO+LIgyhRdNwk0jXL8XXL3tE5evOc8fLURLNeO+bDzhN6GialRBWFd7nsqcxzLnocrZ+Bb7qTlJeE4oYgTVdJoYsVuBRI4a06Ap2aywbxiuoGf4tlg45t/CpczsUGdTLk7YN+mZ+0UJnQ80ztO03yxLOBB233JXlOw+S4qqnhV+AXvdnlWwsjzgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"vote.png\"\n        title=\"vote.png\"\n        src=\"/static/3c7cf000bbfd88062f370e9c115f6ea2/37523/vote.png\"\n        srcset=\"/static/3c7cf000bbfd88062f370e9c115f6ea2/e9ff0/vote.png 180w,\n/static/3c7cf000bbfd88062f370e9c115f6ea2/f21e7/vote.png 360w,\n/static/3c7cf000bbfd88062f370e9c115f6ea2/37523/vote.png 720w,\n/static/3c7cf000bbfd88062f370e9c115f6ea2/302a4/vote.png 1080w,\n/static/3c7cf000bbfd88062f370e9c115f6ea2/07a9c/vote.png 1440w,\n/static/3c7cf000bbfd88062f370e9c115f6ea2/a8a6f/vote.png 1516w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABGUlEQVQoz6WRS0oDQRCG5wrGx0LjKwpuXfk4gPfwAJ7AA6iISQYmmegikKy8gBtxYUTITkXEpa4NkojVzSSTh5/0DDEhjOCYho+qprp+/uqyDisNDq7rHN18kK5q0lUVm5Mgao5vP7EmbUWfRFbGRGGtFoQBakwEa9lVRLGUF1JudONKIaxH9Vm/iZmYdISJTDhOPyYywrQtP+9GhSMFjbNZR9g51xQffQr3PmcPPu6dH9z3K00WcjEcmpGmssLeZRNz6l4viAqfDi2e37vMOeGX/FlwxhZ2Lzwa3hdPtS411eNF2ry12ly9duIJGhbzwtqpYqus2S5rNkqazVKYrxf/uRQjahZj3CSdQT6fi7mUYdFUBMP1UYffNQhm16EULE0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"result.png\"\n        title=\"result.png\"\n        src=\"/static/ffc10ddbcf4df4afc9fed957e3608cd2/37523/result.png\"\n        srcset=\"/static/ffc10ddbcf4df4afc9fed957e3608cd2/e9ff0/result.png 180w,\n/static/ffc10ddbcf4df4afc9fed957e3608cd2/f21e7/result.png 360w,\n/static/ffc10ddbcf4df4afc9fed957e3608cd2/37523/result.png 720w,\n/static/ffc10ddbcf4df4afc9fed957e3608cd2/302a4/result.png 1080w,\n/static/ffc10ddbcf4df4afc9fed957e3608cd2/07a9c/result.png 1440w,\n/static/ffc10ddbcf4df4afc9fed957e3608cd2/5df5d/result.png 1572w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>과제4. NLB에 TLS 적용하기</p>\n<p>아래 명령어를 입력하여 CERT_ARN을 저장해주도록 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">CERT_ARN</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">`</span>aws acm list-certificates --query <span class=\"token string\">'CertificateSummaryList[].CertificateArn[]'</span> --output text<span class=\"token variable\">`</span></span></code></pre></div>\n<p>다음 아래 명령어를 입력해 Deployment를 생성해주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cat</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token string\">EOF<span class=\"token bash punctuation\"> <span class=\"token operator\">|</span> kubectl create -f -</span>\r\napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: deploy-echo\r\nspec:\r\n  replicas: 2\r\n  selector:\r\n    matchLabels:\r\n      app: deploy-websrv\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: deploy-websrv\r\n    spec:\r\n      terminationGracePeriodSeconds: 0\r\n      containers:\r\n      - name: akos-websrv\r\n        image: k8s.gcr.io/echoserver:1.5\r\n        ports:\r\n        - containerPort: 8080\r\n---\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: svc-nlb-ip-type\r\n  annotations:\r\n    external-dns.alpha.kubernetes.io/hostname: \"<span class=\"token variable\">${MyDomain}</span>\"\r\n    service.beta.kubernetes.io/aws-load-balancer-nlb-target-type: ip\r\n    service.beta.kubernetes.io/aws-load-balancer-scheme: internet-facing\r\n    service.beta.kubernetes.io/aws-load-balancer-healthcheck-port: \"8080\"\r\n    service.beta.kubernetes.io/aws-load-balancer-cross-zone-load-balancing-enabled: \"true\"\r\n    service.beta.kubernetes.io/aws-load-balancer-ssl-ports: \"https\"\r\n    service.beta.kubernetes.io/aws-load-balancer-ssl-cert: <span class=\"token variable\">${CERT_ARN}</span>\r\n    service.beta.kubernetes.io/aws-load-balancer-backend-protocol: \"http\"\r\nspec:\r\n  ports:\r\n    - port: 80\r\n      targetPort: 8080\r\n      protocol: TCP\r\n      name: http\r\n    - port: 443\r\n      targetPort: 8080\r\n      protocol: TCP\r\n      name: https\r\n  type: LoadBalancer\r\n  loadBalancerClass: service.k8s.aws/nlb\r\n  selector:\r\n    app: deploy-websrv\r\nEOF</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAuklEQVQoz52R2wqDMBBE8/+/qK+KIEhUNLdNpkzaiC1qawMDubAns7NqXVeM44hpmmCdg7EWIQSIRIjILYUgUMMwZKBzDt57LMuClBL+XYrOmqbJIDqLKeGKl/L7uRTddV0HrXUWI6Bbylq77YtijBv40CEBVVWhbdsMK0C2X4rK74Tt706BdV2j7/tcwLYJo55Bh9eQ5K3t0wyZ3TzPMMZsxQVYznvgPq9D4J0J/jJ99W1qn46u3BH4AJg5xhoXo+poAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"TLS.png\"\n        title=\"TLS.png\"\n        src=\"/static/bf5ab6d75ec99a8420d9413af25c88a2/37523/TLS.png\"\n        srcset=\"/static/bf5ab6d75ec99a8420d9413af25c88a2/e9ff0/TLS.png 180w,\n/static/bf5ab6d75ec99a8420d9413af25c88a2/f21e7/TLS.png 360w,\n/static/bf5ab6d75ec99a8420d9413af25c88a2/37523/TLS.png 720w,\n/static/bf5ab6d75ec99a8420d9413af25c88a2/302a4/TLS.png 1080w,\n/static/bf5ab6d75ec99a8420d9413af25c88a2/07a9c/TLS.png 1440w,\n/static/bf5ab6d75ec99a8420d9413af25c88a2/d76ab/TLS.png 1731w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#1-kops-%EC%9B%90%ED%81%B4%EB%A6%AD-%EB%B0%B0%ED%8F%AC\">1. KOPS 원클릭 배포</a></li>\n<li><a href=\"#2-aws-vpc-cni\">2. AWS VPC CNI</a></li>\n<li><a href=\"#4-pod%EC%97%90%EC%84%9C-%EC%99%B8%EB%B6%80-%ED%86%B5%EC%8B%A0\">4. Pod에서 외부 통신</a></li>\n<li><a href=\"#5-%EB%85%B8%EB%93%9C%EC%97%90%EC%84%9C-pod-%EC%83%9D%EC%84%B1%EA%B0%AF%EC%88%98-%EC%A0%9C%ED%95%9C\">5. 노드에서 POD 생성갯수 제한</a></li>\n<li><a href=\"#6-k8s-service\">6. K8S Service</a></li>\n<li><a href=\"#7-external-dns\">7. External DNS</a></li>\n</ul>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"toc\"><pre class=\"language-toc\"><code class=\"language-toc\"></code></pre></div>","frontmatter":{"date":"January 29, 2023","title":"Gasida Kubernetes Study 2주차","categories":"Kubernetes","author":"KORWOO","emoji":"🔮"},"fields":{"slug":"/Kubernetes/Gasida_Study_homework_2/"}},"prev":{"id":"c31314fe-66ed-534b-ac06-f1d987c34bf1","html":"<p>가시다님 스터디 : <a href=\"https://www.notion.so/gasidaseo/23-7635cc4f02c04954a3260b317588113e\">https://www.notion.so/gasidaseo/23-7635cc4f02c04954a3260b317588113e</a></p>\n<p>4주차 Harbor를 이용한 이미지 저장소 구축 및 ArgoCD</p>\n<h2 id=\"1argocd\" style=\"position:relative;\"><a href=\"#1argocd\" aria-label=\"1argocd permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.ArgoCD??</h2>\n<p>어느덧 가시다님의 쿠버네티스 스터디도 4주차에 접어들었습니다.\r\n이번주의 주제는 Harbor 구축 및 ArgoCD 입니다.\r\nHarbor의 경우 제가 근무하고 있는 회사에서 한때 사용하였던 경험이 있어 나름 익숙한 Container Registry 였지만\r\nArgoCD같은 경우 여기저기서 많이 들어는봤지만 생소한 개념이었습니다..ㅜㅜ\r\n그래서 ArgoCD가 무엇인지에 대해 설명하고 넘어가겠습니다.</p>\n<p>ArgoCD에 대해 설명하기 위해서는 먼저 GitOps에 대해 알아야합니다.\r\nGitOps는 어렵게 생각할것 없이 Git에서 사용하는 Devops의 실천 방법 중 하나입니다.\r\n그중에서도 CD(Continous Deployment)에 초점을 두고 있습니다.</p>\n<p>GitOps의 핵심 아이디어는</p>\n<ol>\n<li>배포에 관련된 모든 것을 선언형 기술서(Declarative Descriptions)형태로 작성하여 Config Repostiry에서 관리</li>\n<li>Config Repositry의 선언형 기술서와 운영 환경 간 상태차이가 없도록 유지시키는 자동화 시스템 구성</li>\n</ol>\n<p>즉 GitOps는 K8S Manifest 파일을 Git에서 관리하고 배포할때에도 Git에 저장된 Manifest로 Cluster에 배포하는 과정입니다.\r\nManifest 파일에 배포된 상태가 어떤 모양을 가져아 할지 선언되어 있는 방식으로 정의하여 단일 진실의 원천(SSOT) 를 지킵니다.\r\nGitOps를 사용하면 배포상태의 모습을 항상 Manifest에 정의된 대로 원천가 동일하게 맞추며 현재 배포환경의 상태를 쉽게 파악할 수 있습니다.</p>\n<p>GitOps에 대해서 설명드릴 내용이 좀 더 많이 있으나 GitOps가 메인이 아닌지라 기회가 된다면 다음 포스팅에서 GitOps에 대해 다뤄볼수 있도록 하겠습니다.\r\n이 GitOps를 구현체가 바로 ArgoCD 입니다!!</p>\n<p>서론이 길었습니다.</p>\n<p>바로 실습으로 넘어가도록 하겠습니다.</p>\n<h2 id=\"2-harbor-container-registry-구축\" style=\"position:relative;\"><a href=\"#2-harbor-container-registry-%EA%B5%AC%EC%B6%95\" aria-label=\"2 harbor container registry 구축 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Harbor Container Registry 구축</h2>\n<p>Cluster 구성 과정은 지난번 포스팅을 참고하여 주시고 바로 진행하겠습니다.</p>\n<p>먼저 지나번과 같이 Control Plane, Worker Node에 AWS LoadBalancer, ExternalDNS 에 대한 권한을 부여하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">aws iam attach-role-policy --policy-arn arn:aws:iam::<span class=\"token variable\">$ACCOUNT_ID</span>:policy/AWSLoadBalancerControllerIAMPolicy --role-name masters.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span>\r\naws iam attach-role-policy --policy-arn arn:aws:iam::<span class=\"token variable\">$ACCOUNT_ID</span>:policy/AWSLoadBalancerControllerIAMPolicy --role-name nodes.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span>\r\naws iam attach-role-policy --policy-arn arn:aws:iam::<span class=\"token variable\">$ACCOUNT_ID</span>:policy/AllowExternalDNSUpdates --role-name masters.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span>\r\naws iam attach-role-policy --policy-arn arn:aws:iam::<span class=\"token variable\">$ACCOUNT_ID</span>:policy/AllowExternalDNSUpdates --role-name nodes.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span></code></pre></div>\n<p>다음 kops cluster 를 업데이트 해주도록하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kops edit cluster\r\n-----\r\nspec:\r\n  certManager:\r\n    enabled: <span class=\"token boolean\">true</span>\r\n  awsLoadBalancerController:\r\n    enabled: <span class=\"token boolean\">true</span>\r\n  externalDns:\r\n    provider: external-dns\r\n-----\r\n\r\nkops update cluster --yes <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">echo</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">sleep</span> <span class=\"token number\">3</span> <span class=\"token operator\">&amp;&amp;</span> kops rolling-update cluster</code></pre></div>\n<p>다음은 이미지 저장소인 Harbor를 설치해주도록 하겠습니다.\r\nHarbor 설치는 Helm Chart를 통해 설치를 진행하도록하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">helm repo <span class=\"token function\">add</span> harbor https://helm.goharbor.io\r\nhelm fetch harbor/harbor --untar</code></pre></div>\n<p>다음 value.yaml에 대한 수정이 필요합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">vim</span> ~/harbor/values.yaml\r\n\r\nexpose.tls.certSource<span class=\"token operator\">=</span>none  <span class=\"token comment\"># 19줄</span>\r\nexpose.ingress.hosts.core<span class=\"token operator\">=</span>harbor.<span class=\"token operator\">&lt;</span>각자자신의도메인<span class=\"token operator\">></span>    <span class=\"token comment\"># 36줄</span>\r\nexpose.ingress.hosts.notary<span class=\"token operator\">=</span>notary.<span class=\"token operator\">&lt;</span>각자자신의도메인<span class=\"token operator\">></span>  <span class=\"token comment\"># 37줄</span>\r\nexpose.ingress.hosts.core<span class=\"token operator\">=</span>harbor.korwoo.link    \r\nexpose.ingress.hosts.notary<span class=\"token operator\">=</span>notary.korwoo.link  \r\nexpose.ingress.controller<span class=\"token operator\">=</span>alb                      <span class=\"token comment\"># 44줄</span>\r\nexpose.ingress.className<span class=\"token operator\">=</span>alb                       <span class=\"token comment\"># 47줄</span>\r\nexpose.ingress.annotations<span class=\"token operator\">=</span>alb.ingress.kubernetes.io/scheme: internet-facing\r\nexpose.ingress.annotations<span class=\"token operator\">=</span>alb.ingress.kubernetes.io/target-type: <span class=\"token function\">ip</span>\r\nexpose.ingress.annotations<span class=\"token operator\">=</span>alb.ingress.kubernetes.io/listen-ports: <span class=\"token string\">'[{\"HTTPS\":443}, {\"HTTP\":80}]'</span>\r\nexpose.ingress.annotations<span class=\"token operator\">=</span>alb.ingress.kubernetes.io/certificate-arn: <span class=\"token variable\">${CERT_ARN}</span>\r\n<span class=\"token assign-left variable\">externalURL</span><span class=\"token operator\">=</span>https://harbor.<span class=\"token operator\">&lt;</span>각자자신의도메인<span class=\"token operator\">></span>\r\n<span class=\"token assign-left variable\">externalURL</span><span class=\"token operator\">=</span>https://harbor.korwoo.link             <span class=\"token comment\"># 131줄</span></code></pre></div>\n<p>위의 yaml 파일 내용수정 중\r\n51~54번째줄에 해당하는 내용은 주석처리를 해주시면 됩니다.\r\n추가적으로 expore.ingress.annotations=alb.ingress.kubernetes.io/certificate-arn: ${CERT_ARN} 부분은\r\n문자 그대로 넣어주시는것이 아니라\r\n터미널에서 echo “alb.ingress.kubernetes.io/certificate-arn: $CERT_ARN” 명령어를 입력하여 나온 값을\r\n${CERT_ARN} 값 대신에 넣어줄수 있도록 합니다.\r\n단순히 ${CERN_ARN} 값을 넣으면 인증키 값이 꼬일수도 있기 떄문입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaUlEQVQoz41S2W6DQBDjdXf2ZEO4Q5BCUxKiJm2l/v+Xudojl6pWfbA8gOTxGGdMluD5HtzuwK3nCTyfwfNDek7fdA9SNbgZ4iwkSIgAQRRZCGRMVuB2BjMTmNmBuROYewNz58SXwKTKCOlAsgDJHIL4k2gQ5KaGrI7Q6wl6PYP8djOCm210c2W9CRwF8zuS4BWZLHq4ly+U4wLX7CD9ZmFBQoOkCSz8edI+IL8Je5d3EDLSBXR3gipnCN1EF6YH2RFCtRC6j5npLrrXTZrb9L5NSxxIKGRcaNjNAjtckI/vMJsz7PYDdvyEq19RqQpKrlOGRcxPre+Z+jk4LsI1GZkV3LjAdBN0NyEfDrDdDrbfw/q57NAQQRID3U5jD/hxsoOqZxTDGXV7BFctSNfxrOBI3SpB/0BGegXTLTB2gLI9uGpAqgqdCz/E1+HaM8+pHr8hOPQZ6nKCUg1EyGSVciqeOkZ/CF0FvwHfxu+W7OF8xAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"harbor_yaml.png\"\n        title=\"harbor_yaml.png\"\n        src=\"/static/27bd7c3179f7b59fbe00ce751b5300a8/37523/harbor_yaml.png\"\n        srcset=\"/static/27bd7c3179f7b59fbe00ce751b5300a8/e9ff0/harbor_yaml.png 180w,\n/static/27bd7c3179f7b59fbe00ce751b5300a8/f21e7/harbor_yaml.png 360w,\n/static/27bd7c3179f7b59fbe00ce751b5300a8/37523/harbor_yaml.png 720w,\n/static/27bd7c3179f7b59fbe00ce751b5300a8/302a4/harbor_yaml.png 1080w,\n/static/27bd7c3179f7b59fbe00ce751b5300a8/d4e7f/harbor_yaml.png 1416w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>수정이 완료 되었다면\r\n아래의 명령어를 입력하여 helm install을 진행해주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl create ns harbor\r\nhelm <span class=\"token function\">install</span> harbor harbor/harbor -f ~/harbor/values.yaml --namespace harbor --version <span class=\"token number\">1.11</span>.0</code></pre></div>\n<p>헬름 인스톨 이후\r\nharbor.자신의도메인 에 접속하시면 Harbor에 접속하실 수 있습니다.\r\n이 작업또한 시간이 조금 필요하기에 느긋하게 5분정도 후에 접속해보시면 되겠습니다!</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkElEQVQoz5VSXW/UMBDMz4eHE4Veq9JW4lqQgH/BD+H1rrETu/FnnM9Bs3cH10csTSw7u7Mzu66+fP2B3befuL17wPvNR7zbfMLm6hqbqy0+bO9w8/CMm/snwfZ+h63sb3H9eYfbx2c8Pn1HhYuVckYZR/zvWvhxe+D3L1SdD5imGTFGtMagc07gQ0AIET5EOO4xwfsg/2JKCDEipYScM3LfI0ePYDUq5xzWdUXf90IyjiPmZQbWFdM0YeJ5nrHMM9q2Fch5WQSMkfO6YlmBisrOhM57hBBESSlF7qiACYTWDZTS6LpO4JwXF8MwCDljKkrnOhNaY2GtFaW8SzFhHCdRclRoTmhBd4wjYV+K7FXOvSTkEyErN00rBFTJPon1E+FLXaOuFRShNGqlYIwV0F3FBMqltUtCsUuF6Z9CYwx008j/pmnw+tpJHmMJUchBXFomYV3XUo0BTDg33lgrg+NdjAllGI7P5jQgomJSKYMMgsGmNdBa/63KobFPJFVK4XB4wX5PHMQy+xnkiR0L/QEMWfA7L5YhTAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"route53.png\"\n        title=\"route53.png\"\n        src=\"/static/903faa47dacc1ac1e0aff55bf6ec17dd/37523/route53.png\"\n        srcset=\"/static/903faa47dacc1ac1e0aff55bf6ec17dd/e9ff0/route53.png 180w,\n/static/903faa47dacc1ac1e0aff55bf6ec17dd/f21e7/route53.png 360w,\n/static/903faa47dacc1ac1e0aff55bf6ec17dd/37523/route53.png 720w,\n/static/903faa47dacc1ac1e0aff55bf6ec17dd/302a4/route53.png 1080w,\n/static/903faa47dacc1ac1e0aff55bf6ec17dd/07a9c/route53.png 1440w,\n/static/903faa47dacc1ac1e0aff55bf6ec17dd/764d7/route53.png 1782w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABFklEQVQoz62Q3U7DMAyF8/YgNNaJjo2/Ale8By/CHXewJLbTtEvXg+IWVrRdTYtkJfZxP5/aPL6+oVw94HK2wMXVHLOixHVRoihXuFlXWKyf97GqNIrx/n3Pb5+wvH/B8q6CwXiatgURoe97nHT8J/DxDpNBMUZYa2GtAzHDOQfvPUREc08E7wkSgtacGzSRACLWqIMgkBscZjHUAV8UIXGrA1gEdV0jthFxG9E0DZhZtTysHY3E2Ghvhm9TB5NS0oJ1DhsvoDyVWXPnPUgYJDQ4z3nWrAOz6Ir2f+CVo8Ds8HuzAcsojo1/zZPa9D6mmdR1upsMJJaDDwbwIewYPL9NSt3Eofxzd0qYXZd0oecD7rqzAn8AxlTtPgY+RLwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"LB.png\"\n        title=\"LB.png\"\n        src=\"/static/ab3be415cc7f015673ff282fb6f997a6/37523/LB.png\"\n        srcset=\"/static/ab3be415cc7f015673ff282fb6f997a6/e9ff0/LB.png 180w,\n/static/ab3be415cc7f015673ff282fb6f997a6/f21e7/LB.png 360w,\n/static/ab3be415cc7f015673ff282fb6f997a6/37523/LB.png 720w,\n/static/ab3be415cc7f015673ff282fb6f997a6/302a4/LB.png 1080w,\n/static/ab3be415cc7f015673ff282fb6f997a6/07a9c/LB.png 1440w,\n/static/ab3be415cc7f015673ff282fb6f997a6/a2498/LB.png 1764w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>만약 접속이 잘 안되실 경우 IAM에서 역할 할당이 잘 되어있는지,\r\nRoute53에 harbor.도메인이 잘 등록되어 있는지,\r\nLB는 잘 생성되어 있는지를 확인해주시면 되겠습니다.</p>\n<p>정상적으로 접속이 되었습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB50lEQVQ4y42S3W/SUBjGe6Exw5h458Y2oDBpCy2nn4etBToQs6ZsIRtxTG+UqCTGSGRRFnUfipnJEo165Z/7mJ7ahgE6L355T29+5+n7HO7FxS88Ov2GrcEZ/OEntN+eozUcw3v9Ed7gDFuvTuEfjtE6/PxfcLcLFDfzBq5nCW7kVCTu6mxeyyhYKDq4ZTSxkDeRkNaREMtXwq1KKlIFDemizmBn2UBKJFizm9CfHkFyfeSNCoTyJgTq/hNuuaAjKWlISjqShQgDSwJBitZR6p9A6Y2Qq3jIaA540wVv1MCb8+FWZROK3UBOt7EkqgguYJcIBOlyA6Vn70D6Jyj1RlireOA1G1kmrSJr1mKib5YwkK4UDZZ0VvieQfrHf5VOypmQV9eZNCKlWFgWVaRpKCTPP1yZNJgBXJAspztMEu5SY3ucFUZJp6SWG8vk+na4w+JGnSHSKgRahUhrYdO0DjIhjOeUNChDaezA2j4AlyEUjfYD3N89wL32Ppq7XXjdx5A3NrFiukxyKeGEVPkjlV0f1s5DGP4+uOAXFwWCOxMsSuGziUqZSRhLj2G9HIN2ejC8DsxWNyxlHkmhNCOcPtPBOSpHP2EPL2DtPWHSS8K4kKlnMy8hHXyBM/oO+81XOKMfobTTw2+Rr8KoBCCugwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"harbor_conn.png\"\n        title=\"harbor_conn.png\"\n        src=\"/static/c18d41a9c1522c3738af3222150cd9bb/37523/harbor_conn.png\"\n        srcset=\"/static/c18d41a9c1522c3738af3222150cd9bb/e9ff0/harbor_conn.png 180w,\n/static/c18d41a9c1522c3738af3222150cd9bb/f21e7/harbor_conn.png 360w,\n/static/c18d41a9c1522c3738af3222150cd9bb/37523/harbor_conn.png 720w,\n/static/c18d41a9c1522c3738af3222150cd9bb/302a4/harbor_conn.png 1080w,\n/static/c18d41a9c1522c3738af3222150cd9bb/c9c3a/harbor_conn.png 1289w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ID PW 는 기본\r\nID : admin\r\nPW : Harbor12345로 설정이 되어있습니다.</p>\n<p>접속이 되었다면 신규 프로젝트를 생성해주도록하겠습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.22222222222223%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACZklEQVQ4y5WT23LaMBCG3QR8kGRbtgGbhHAICYUQUiAk4RQITZOm05tOL/oCfZW+SR/07+zKENKZXvRi55fW0qd/tbIV1Foolo5xEGewdIp3UYbDpIqDuMrzv4Py9N2sO4IVmX00PoxSWI6vUZABCsLnKKoQtgpZ/ydspSF1DMtPKghLKYQuQUZliDCGpwLIQEMEmseuClhpTnnPDzkn/JBzIp8rAkqdMNn1NRwVwpE+HKH4o4oS3uwQ1A/hxyXOe4HmdQTjXJTAzQ+y+HTaJBRs6cMjh2EMlVRA7lVShopNBOXMjJMKZFyGiBKuyBgyLi06iYC2J6GzGgarZ4w2L7haP6M1nqMxmqIxmrE2RzMOHo/nqF1e79y6+dVYW+sEDLMazu7WOLu5x/ntCq3rxb9jskT96tZcy7ZK6b8CSYP0GN35Iy5Xz2hPluyst3hEd/4Rp5MlH0RBY4KeDCamidvmBHpbsnFIQAL0758Y0hzP0Fl/RWe24RL3gxwSkJrKwDCCDKNXIDWFSu4tP2Gw/sxgusN27oiUXHVnG7yfPhjw8A5H9SaOTxpI0ipcFe4BpQGSs/7yCZ3pA+rDKeZfvqG/eERzvGDwtlzj8AYiiPKmvOmyhi0kdPWEF1MnWcdzvjMaN/ION6nrwymaH25R64/edHnXlG3J0VEd7bsHnFKZHCu0JkZp3p5ucL56QfflB+5//cbF959wPLF7MuzQpgctFIqe5MeatnuotLu59lh3ubMLZJ0Bsu4Q9dkT0t4ILv1Zcg9IIAqGugIFx4XtCdiuMLofrkDR9VB0XBQOC6z8WzLUlP0HtOOGBpT0uh8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"harbor_project.png\"\n        title=\"harbor_project.png\"\n        src=\"/static/a447318a43d2f000d1a332574afbcfce/37523/harbor_project.png\"\n        srcset=\"/static/a447318a43d2f000d1a332574afbcfce/e9ff0/harbor_project.png 180w,\n/static/a447318a43d2f000d1a332574afbcfce/f21e7/harbor_project.png 360w,\n/static/a447318a43d2f000d1a332574afbcfce/37523/harbor_project.png 720w,\n/static/a447318a43d2f000d1a332574afbcfce/eafa0/harbor_project.png 939w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>이미지 레지스트리가 잘 생성 되었으므로 한번 이미지저장소에 이미지를 Push해보도록 하겠습니다.\r\n아래 명령어를 통해 임의의 이미지를 내려받고 태그를 달아주도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker pull nginx\r\ndocker pull busybox\r\ndocker tag busybox harbor.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span>/pkos/busybox:0.1</code></pre></div>\n<p>아래 명령어는 insecure 설정 명령어입니다. 진행해주도록 하겠습니다. 진행 후 daemor reload 및 docker 재시작을 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cat</span> <span class=\"token operator\">&lt;&lt;</span>EOT<span class=\"token operator\">></span> /etc/docker/daemon.json\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token string\">\"insecure-registries\"</span> <span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"harbor.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span>\"</span><span class=\"token punctuation\">]</span>\r\n<span class=\"token punctuation\">}</span>\r\nEOT\r\n\r\nsystemctl daemon-reload <span class=\"token operator\">&amp;&amp;</span> systemctl restart docker</code></pre></div>\n<p>다음 아래 명령어를 통하여 Harbor에 로그인하고 이미지를 Push하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker login harbor.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span> -u admin -p Harbor12345\r\ndocker push harbor.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span>/pkos/busybox:0.1</code></pre></div>\n<p>명령어 수행 후 Harbor에서 Image가 정상적으로 Push 된것을 확인하실 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB20lEQVQoz0WRS2sTURiGB+3CksnkPulcM5nJZTJJJpPLaI2lIMVNF7oSNxVScaG2Gatxlb/jVqgo7tyLqAtBEKkbBX/HI+dQ2sXLdzbn4Xm/T3n/4y9vPp9x+uUXp1/PePvtNx++/+Hdz3+8/viJ42VGlmW8enHCavWS9XpNdnTEMss4WR7z6PCQg4OHLBYLGaV+f8WVO4+5tv8M7e6Szf2nbO4/Qbv3nMrtB9iGSX3LQK/pVMpVqpUqer1OuVwmn89zdWMDRVEu05/v0Zzs4A6v04hTjG6M1Uvwp3PMdo9yzaVYt9H0ImpFRdVU1JwqYaqqymiaRqFQkFE66S7uIMWOprRnO/jjOcFkTu/WHl5/jKFvUbdcLNfGsAxMy8SyLAzDQNd1qtUqxWKRXC4n4YoTjbHCEUYnppls4462cQYz7EFKIxrT9Vs0Wx3iOKYf9YmiiHa7jeM4EiiqC6AwFlDFG6bYvURWDdJdGslNvNENOZuDiQTWDBvPa+AHAWEYyriuK01N06RUKl1YSkO3P8UME5xhiiPqnxu6YUzUCfH8FkEQ4Ps+3W6XJEkkVJh6nieBou654QxhKYBmb3yZaIoR9HBNi4bfptn05Gexu1qtdrE/8RZTHEYA/wOFg/XaGzCSwAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image_push.png\"\n        title=\"image_push.png\"\n        src=\"/static/f68d04d474061bc02b46c775f3ec70ed/37523/image_push.png\"\n        srcset=\"/static/f68d04d474061bc02b46c775f3ec70ed/e9ff0/image_push.png 180w,\n/static/f68d04d474061bc02b46c775f3ec70ed/f21e7/image_push.png 360w,\n/static/f68d04d474061bc02b46c775f3ec70ed/37523/image_push.png 720w,\n/static/f68d04d474061bc02b46c775f3ec70ed/302a4/image_push.png 1080w,\n/static/f68d04d474061bc02b46c775f3ec70ed/07a9c/image_push.png 1440w,\n/static/f68d04d474061bc02b46c775f3ec70ed/e67dd/image_push.png 1801w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>다음은 YAML 파일의 컨테이너 이미지 저장소 주소를 Local Harbor로 변경해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -s -O https://raw.githubusercontent.com/junghoon2/kube-books/main/ch13/busybox-deploy.yml\r\n<span class=\"token function\">sed</span> -i <span class=\"token string\">\"s|harbor.myweb.io/erp|harbor.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span>/pkos|g\"</span> busybox-deploy.yml</code></pre></div>\n<p>위의 명령어의 yaml 파일을 조회하시면 image가 저희가 방금 저장하였던 local Harbor의 이미지로 지정이 되어있습니다.\r\nkubectl apply -f busybox-deply.yml 을 입력하시면\r\n해당 이미지가 Pulling 되어 Pod가 기동될것입니다.</p>\n<h2 id=\"3-gitlab-을-이용한-local-git-소스-저장소-구축\" style=\"position:relative;\"><a href=\"#3-gitlab-%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-local-git-%EC%86%8C%EC%8A%A4-%EC%A0%80%EC%9E%A5%EC%86%8C-%EA%B5%AC%EC%B6%95\" aria-label=\"3 gitlab 을 이용한 local git 소스 저장소 구축 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. GitLab 을 이용한 Local Git 소스 저장소 구축</h2>\n<p>Gitops 실습에 앞서 소스 저장소 구축을 위해 GitLab 이용해 Local Git 저장소를 구축해보겠습니다.\r\n참고로 GitLab은 최소 요구사항이 제법 높은편입니다.(<a href=\"https://docs.gitlab.com/ee/install/requirements.html\">https://docs.gitlab.com/ee/install/requirements.html</a>)\r\n그래서 실습할때 높은 사양의 EC2를 생성해주는것을 권장드립니다.\r\n아래의 명령어를 순차적으로 입력해주겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl create ns gitlab\r\nhelm repo <span class=\"token function\">add</span> gitlab https://charts.gitlab.io/\r\nhelm repo update\r\nhelm fetch gitlab/gitlab --untar</code></pre></div>\n<p>다음 yaml 파일을 아래와 같이 수정해주시면 되겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">vim</span> ~/gitlab/values.yaml\r\n----------------------\r\nglobal:\r\n  hosts:\r\n    domain: <span class=\"token operator\">&lt;</span>각자자신의도메인<span class=\"token operator\">></span>             <span class=\"token comment\"># 52줄</span>\r\n    https: <span class=\"token boolean\">true</span>\r\n\r\n  ingress:                  <span class=\"token comment\"># 66줄</span>\r\n    configureCertmanager: <span class=\"token boolean\">false</span>\r\n    provider: aws\r\n    class: alb\r\n    annotations:\r\n      alb.ingress.kubernetes.io/scheme: internet-facing\r\n      alb.ingress.kubernetes.io/target-type: <span class=\"token function\">ip</span>\r\n      alb.ingress.kubernetes.io/listen-ports: <span class=\"token string\">'[{\"HTTPS\":443}, {\"HTTP\":80}]'</span>\r\n      alb.ingress.kubernetes.io/certificate-arn: <span class=\"token variable\">${CERT_ARN}</span>\r\n      alb.ingress.kubernetes.io/success-codes: <span class=\"token number\">200</span>-399\r\n    tls:\r\n      enabled: <span class=\"token boolean\">false</span>\r\n\r\ncertmanager:           <span class=\"token comment\"># 834줄</span>\r\n  installCRDs: <span class=\"token boolean\">false</span>\r\n  install: <span class=\"token boolean\">false</span>\r\n  rbac:\r\n    create: <span class=\"token boolean\">false</span>\r\n\r\nnginx-ingress:\r\n  enabled: <span class=\"token boolean\">false</span>\r\n\r\nprometheus:    <span class=\"token comment\">#904줄</span>\r\n  install: <span class=\"token boolean\">false</span>\r\n\r\ngitlab-runner:       <span class=\"token comment\">#1129줄</span>\r\n  install: <span class=\"token boolean\">false</span>\r\n----------------------\r\n\r\nhelm <span class=\"token function\">install</span> gitlab gitlab/gitlab -f ~/gitlab/values.yaml --namespace gitlab --version <span class=\"token number\">6.8</span>.1</code></pre></div>\n<p>수정 참고용 이미지 첨부하겠습니다.\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.111111111111114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAABJ0AAASdAHeZh94AAAA1ElEQVQoz5WQy27CQAxFs65f87CJM5RJB5GWiKpSUf//21CgbBBUxbLuwtbRtW+nGnOd63rDzPhkdWYpbw45KCA8DatGfZ0jJ7yF4R/OqpRHpAxsyHbVFSyqyIb48J1uZTnvjlaaBI1AAAhAgIx07T+cc+TcPq3uxAZRD1ZULaVIhIRIdB+j86LLAWPd2/Rt7z+6/dLpWN7mjzr2Ekb3uW0HH9w9hICI7t73fSmltcbMnSaRYdLgzIFYLi0iv6HB/dgu8wVm3ydtvJz5cg4ZHjE3P58AQTgg6MQkVukAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"GitLab.png\"\n        title=\"GitLab.png\"\n        src=\"/static/ee0ddc74d7ccd7670a9e531830300551/37523/GitLab.png\"\n        srcset=\"/static/ee0ddc74d7ccd7670a9e531830300551/e9ff0/GitLab.png 180w,\n/static/ee0ddc74d7ccd7670a9e531830300551/f21e7/GitLab.png 360w,\n/static/ee0ddc74d7ccd7670a9e531830300551/37523/GitLab.png 720w,\n/static/ee0ddc74d7ccd7670a9e531830300551/302a4/GitLab.png 1080w,\n/static/ee0ddc74d7ccd7670a9e531830300551/07a9c/GitLab.png 1440w,\n/static/ee0ddc74d7ccd7670a9e531830300551/d2782/GitLab.png 1864w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>헬름 인스톨이 완료되었다면 아래 명령어를 통해 Gitlab 접속 비밀번호를 출력하실 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">kubectl get secrets -n gitlab gitlab-gitlab-initial-root-password --template<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>.data.password<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">|</span> base64 -d <span class=\"token punctuation\">;</span><span class=\"token builtin class-name\">echo</span></code></pre></div>\n<p>다음 gitlab.자신의 도메인으로 접속하시고\r\nID : root\r\nPW : 위의 명령어의 출력값\r\n을 입력하셔서 접속테스트를 해보시면 되겠습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACCUlEQVQ4y5WR30tUQRTH7/8ZZSZKSfQWUi9lCha99dgvzRVKi0AwJFRQeoqoNsva1cBs9+6yqbOz996Z+3s+ce9uuyoqduDDmTv3nO9854y18HKZ2bk1nk2/5dGTBZ5OLTJdWKIws3wiL+bW8jw5tUhhZonZ2VUeFuZ5Nb+CNTJwg/6+MfovjHLx/G36zt1ioO8OQ5fGGewfO5arl+9xZXCC4aG7DA9NcG34PtdHHjA++hgrbW0S/SkSNIq07CLN6if07gahKBGJMlGz3M6ddbYfNzdJW1skcqubcX6CqmA1qiXm331m9cMXZL3Mvl1G1jZo2eu49W84tXWc2tdD+Ls/CPdLBHslwr0SsShj5Cax3May6xUm137x5uNvIiXQriBRDdA2qBroDqrW/TbKJvVsTIayUc0Kcm8H1bSx7GqVRnWbNFS0w2C6KzDmBDr/snj+fpebr3dY+S6wlFI4rofvB0RRTBRFOb7vE8cxaZrmGGNOJIwT/CghCCMsISRCtNBa5yL/8DyPJEnyhjQ1pwrSuVNWbykV4HltN8fFaUI9QXqCLRmglUYr1XbmernbIAgOOEwPcFgsqwmCkDAM8x5LewnSUYimxHVcxL5ASonjuKjOIRlat7PyQ6Kkd81s9lmt63p5vZVbNWD4v2i/9uGu/MrdoZ5hVsc9xME55oJHN4+eeja3PcG/nF4OX3QmuVcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"gitlab_login.png\"\n        title=\"gitlab_login.png\"\n        src=\"/static/0c1d74dca9fe89ca1edbd38f1ec9d007/37523/gitlab_login.png\"\n        srcset=\"/static/0c1d74dca9fe89ca1edbd38f1ec9d007/e9ff0/gitlab_login.png 180w,\n/static/0c1d74dca9fe89ca1edbd38f1ec9d007/f21e7/gitlab_login.png 360w,\n/static/0c1d74dca9fe89ca1edbd38f1ec9d007/37523/gitlab_login.png 720w,\n/static/0c1d74dca9fe89ca1edbd38f1ec9d007/98b29/gitlab_login.png 937w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>Gitlab에 접속하신 후 신규 유저를 생성하겠습니다.\r\n권한은 Admin으로 설정해주시면 되겠습니다.</p>\n<p>계정 생성 후 상단의 Edit 버튼을 눌러 비밀번호를 설정 해주도록 합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAABuklEQVQ4y5VTy27bMBDUH/dc9FPyC+k3FAVyy7GnBo3dQxvHVkyFT5HLJadYSnKclxsvMCDFJZfDmVVHRBDkzIgxIhGh1opS6jwWMDOYS5s/x7RnTAwdMnxkdNv7LX7drtGvbsE/f4BWN6hEWEKK7XY9jLFwzkNrA2stUiJo7RBDwNfrHT5frnHxfYNODuScwTkjC1OimRE3FpJ7esU0n3IT+1oLQmIMnuCEoXMB+35ACGNjYK1rT/fOYxxjW0spwXsPZx2cc63oIocAtQKY0IWRYCNAuSInRqYCaiO3sc1zQYwEo90hf4wUcwOljC7qR/y9+obkPUoFykvx529h1XS0DsPwCKUG7PfqFdvO/F7h+ssnjLv7ZoJo8jLkgGDRdoFoWufnLns6WTSDas5prQ+Jt/BeHKc6oRzG2AyIYwLnqec4H4HLyYuO0YnYzgRwrg0kZiyGzKMYtDA8xfTAUFpBhJ766vWty/rHCiZxz0Ap1QpLlFrAhd/U8L8FpWnFjL5/wN3dBmqvsNUPWKs/TwzPKhgjYkzPeumUyx948sTQaHNo0vpO0bNMERhr4Y0BbTcocZz+zjML/gP81+cFQXYUWwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"gitlab_passwd.png\"\n        title=\"gitlab_passwd.png\"\n        src=\"/static/7ad2e554468c8cdef4752e9f94ce80f7/37523/gitlab_passwd.png\"\n        srcset=\"/static/7ad2e554468c8cdef4752e9f94ce80f7/e9ff0/gitlab_passwd.png 180w,\n/static/7ad2e554468c8cdef4752e9f94ce80f7/f21e7/gitlab_passwd.png 360w,\n/static/7ad2e554468c8cdef4752e9f94ce80f7/37523/gitlab_passwd.png 720w,\n/static/7ad2e554468c8cdef4752e9f94ce80f7/1b1d5/gitlab_passwd.png 876w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>비밀번호 설정후 Impersonation Token 을 클릭하고 표시된 모든 scopes를 선택하여 Token을 생성해주도록 하겠습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 95.55555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAACP0lEQVQ4y51Uu47bQAzUfwdImS6/kCptkBRpUl+RKh9wTXDx3dmyVqvVat+SVhOQstfyPYDDLUCQprWj4ZBUNQwGbdviYX+A299j+nuLWTbgsyzsUkoIIbL33sM5j5RGOBcwhoCbW4XPvx7w/Y9ApbVZ7+aMKS+IZON0BZJiQowR1jo45zj32qkGbWGMgZQdpJRohYCzDvM8YxxHTNPE3piAvrfQ2sHagGVZiuW8YM4Zc15Q9Wo4AUpQ+RSTeR+YDXnvPMdUaggr2KrIxZ+t0tri8SixP0oMPsH4EYNLxbSLUCbAx+nZ5ZesUmpALRQe65ZBd/uG44eDYN/IHkep0Q8WMURmSI25WCg5kqfSvYG1lkumUkduRuAmkPg552csXsoVhsNgoVSPuq75bZTsOsWNeM/hsdE9AR6ZITEjhivLdVx8yghjfhtgpwwavZZHGtDAErutJZrLceZRem65xFxyiBP20kA0ojALLHRkdszQe87xCHlfntvG9DwDxpSxa9b125ZZLviwkSBeAZ1nleJzo6qUMurO4nCoIVsJ3Wtordn3J6Pf1Ki+7zlPICv7dKU5yVWFOGMnDIQQEKIt27Bl8XTmigwnIGJXmkKA98IyILEoQO7it4O81Y9eTs3YbtAK2Fo0xwZKqasLW2bsnwBszxXg3XGA6rp1Dmm9WOyVwZkpfbpohF7bkDNoNY4ZyqzfOl80u+7sVvgL+9P/p3EpgDGM+HJT4+OPf/j0c4cP3+7w9ff6xc7L21fuDPof2iXEAeqTLcIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"gitlab_token.png\"\n        title=\"gitlab_token.png\"\n        src=\"/static/849ef182b38e758389f28c3163a874c8/37523/gitlab_token.png\"\n        srcset=\"/static/849ef182b38e758389f28c3163a874c8/e9ff0/gitlab_token.png 180w,\n/static/849ef182b38e758389f28c3163a874c8/f21e7/gitlab_token.png 360w,\n/static/849ef182b38e758389f28c3163a874c8/37523/gitlab_token.png 720w,\n/static/849ef182b38e758389f28c3163a874c8/59000/gitlab_token.png 917w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>계정 생성 및 토큰 발급이 끝났다면 기존에 로그인 되어있던 root 계정을 로그아웃 하고 생성한 계정으로 로그인 해주도록하겠습니다.\r\n로그인 후 blank project를 신규 생성해주도록 하겠습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 96.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAACAUlEQVQ4y61TzY7TMBjME+5Kq7bSHjjwABy5AdoFHoKX4MCVE1eQEBI3hDhs2e1PEie24784SWf1uTjbNml7IdLIcWKPv5n5nLy4fonp5BZXVze4uHiFy8vXJ0FrZrN3mE7fYjK5DZjO3uP59Q2ezd4gUaKDNR7/60nKrIaSDsDm7OLDFZvNZoAkTdeYz+e4v3/A3d0cec7QtR28b9A0W3jvB3MaRwmddTDaQCkFpTWM1rDWBjjnAowx/Tz+IxDBQLLWGlob0CilDJtH5cYqzkkuSw7GCtR1jbZte1kEmtOiruv2SGhOGCWUQkIIETbHhYRIFh/yzRq7Rz6acsFKrJYpeMHBuUQlFZTSg2rLssRytYZ1bieofZDKRHARJLNCBC+JjHyMIPMpNEvh1S2UbY7Kpe8JtcniYQEudWiN7Ul+pG2eqojjIUhVMk8l8ixDVVUh6dA+SqOqVKiQvtE7/ae2OUsohcByudpKMwaqUtAqEqtgQ6x8rO8GochKh5Q558GnKJFOi+PZK7nbNr/+MqzXKRaLFYqiBIUkhNxL2Pcyo78eztUB8cCeEPCoVYlay5B2zli4z1mWgTG2lW0slKlR/7vDjX8KakD47Q/H558pvv4uICsVjD/sr6bp4NvNScm9hx+/5/jwZYlPP3IY607fhJHei2Q7kk+bfGzzsZQfAbjFrQrMJDAsAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"gitlab_project.png\"\n        title=\"gitlab_project.png\"\n        src=\"/static/ab00de6120124ff017293aaac09edb16/37523/gitlab_project.png\"\n        srcset=\"/static/ab00de6120124ff017293aaac09edb16/e9ff0/gitlab_project.png 180w,\n/static/ab00de6120124ff017293aaac09edb16/f21e7/gitlab_project.png 360w,\n/static/ab00de6120124ff017293aaac09edb16/37523/gitlab_project.png 720w,\n/static/ab00de6120124ff017293aaac09edb16/e4374/gitlab_project.png 927w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>프로젝트 생성이 되었다면 쿠버네티스에서 사용하는 YAML 파일을 GitLab에 업로드 해보도록 하겠습니다.\r\n아래의 명령어를 차근차근 입력해주시면 되겠습니다.\r\n이떄 git clone 이후 Password 입력 부분은 붙여넣기 해도 입력이 안된것처럼 보이는데 정상적인 현상이므로 붙여넣기 해주시면 되겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mkdir</span> ~/gitlab-test <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> ~/gitlab-test\r\n<span class=\"token comment\"># git 계정 초기화 : 토큰 및 로그인 실패 시 매번 실행해주자</span>\r\n<span class=\"token function\">git</span> config --system --unset credential.helper\r\n<span class=\"token function\">git</span> config --global --unset credential.helper\r\n\r\n<span class=\"token comment\"># git 계정 정보 확인 및 global 계정 정보 입력</span>\r\n<span class=\"token function\">git</span> config --list\r\n<span class=\"token function\">git</span> config --global user.name <span class=\"token string\">\"&lt;각자 자신의 Gitlab 계정>\"</span>\r\n<span class=\"token function\">git</span> config --global user.email <span class=\"token string\">\"&lt;각자 자신의 Gitlab 계정의 이메일>\"</span>\r\n\r\n<span class=\"token comment\"># git clone</span>\r\n<span class=\"token function\">git</span> clone https://gitlab.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span>/<span class=\"token operator\">&lt;</span>각자 자신의 Gialba 계정<span class=\"token operator\">></span>/test-stg.git\r\n<span class=\"token function\">git</span> clone https://gitlab.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span>/korwoo/test-stg.git\r\nCloning into <span class=\"token string\">'test-stg'</span><span class=\"token punctuation\">..</span>.\r\nUsername <span class=\"token keyword\">for</span> <span class=\"token string\">'https://gitlab.korwoo.net'</span><span class=\"token builtin class-name\">:</span> korwoo\r\nPassword <span class=\"token keyword\">for</span> <span class=\"token string\">'https://korwoo@gitlab.korwoo.net'</span><span class=\"token builtin class-name\">:</span> <span class=\"token operator\">&lt;</span>토큰 입력<span class=\"token operator\">></span>\r\n\r\n<span class=\"token comment\"># 이동</span>\r\n<span class=\"token function\">ls</span> -al test-stg <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> test-stg\r\n\r\n<span class=\"token comment\"># 파일 생성 및 깃 업로드(push) : 웹에서 확인</span>\r\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"gitlab test memo\"</span> <span class=\"token operator\">>></span> test.txt\r\n<span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> commit -m <span class=\"token string\">\"initial commit - add test.txt\"</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.22222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACbklEQVQ4y4WTy27VMBBA84HcigVQiTVbhMSCTQEJhMQH8Cd8Ad+AEILSwi29r7wdx85NYjsHjXtT0YIg0tGMxzPOPOzk8fEz7t17xd27L7lz54Sjo+cHXrA4es5iccJiMcuTaDs+fhNjhPv3X/Pw4VsePTjh6ZN3JGfnGZtNzmqVsl7nlGVLlinStCbL/oY6UJPn6tqe5w3bbU5ijcU56DqPUhWNUvzvm6YQpfcOCITgom2/tySq1nTdRKMdZVVT1Qrn/FVgDL51GOB8IEwwOo8PU1z7AMZYEt1Yyjzj5/kpu8sl6+U5qx9nXJx9ZfntK6efPrI8/RKR/WKzIt9cRkSPbNeU2xVFuiNRjcGUJflySbpLSTcb6qLENDpidXutt6r5g6aqKfOCKi+pypKktT1dmlKcf6dqLFWpaHXHOAa8B+8mpFURf0UIEDxIK4feY7Rlco7gHEldNQyjY/SBoe8ZxxEnm2FiEqYDB937gDGGrtvTtgb8yNnO8vr9Tz58Lq+GIg6qVlhraaS0to22vu+xtouB+/0+Nl1rHTGtQUnJSpFVmk8ry67ek7Taxr8ppWiaJiKHVVUddQnquo4QpAX+kH24RtZXsydeoUQ3hrqWS5milI66SKEoKi4uVqRpTttK9i1amyhnZJ1mBcvlZdRjhlJWUZRRDsNI3w9RSuaSaR3b0UX73xA/8RGZuDEwuoBuTezh75+UKOUOw/DPlyOl94eBJn70dEOgtXu8c3GS4iBS+iODkD/PB8/7M7OfJCP7idwzYzrW6y15VjIODjd6xpnB3UD2bjP7SZsSMXh3QN5omG4w/Ub4B3OmvwDnPLJ4WEm7rAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"gitlab_push.png\"\n        title=\"gitlab_push.png\"\n        src=\"/static/c993d4d0e687571044ffa5bf93ad1f0f/37523/gitlab_push.png\"\n        srcset=\"/static/c993d4d0e687571044ffa5bf93ad1f0f/e9ff0/gitlab_push.png 180w,\n/static/c993d4d0e687571044ffa5bf93ad1f0f/f21e7/gitlab_push.png 360w,\n/static/c993d4d0e687571044ffa5bf93ad1f0f/37523/gitlab_push.png 720w,\n/static/c993d4d0e687571044ffa5bf93ad1f0f/a8417/gitlab_push.png 941w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABV0lEQVQoz41RSY6DMBDkmJ0QRIiAhM0GsxhDNP//Wo2qJ855DiXbLaiuJbB1A6UM6m6EtTOGYYDWGlVVCcqyxOv1knue54I0TZEkCe73O7Isk9PPgzUvUNUG5eCwrQ7TNAnpPM8wxsi973u0bSvE/JEEj8cDURRht9vhcDhgv9/LGbgwQpZrJMri573C2gXjOGLbNiHnves6Iafauq5RFIUoi+NYSI7Ho+B0OiGwUYy80EiVxXt1MB/LVEgiDxKSnKBigjGQmPaplqTBuizoewOlu29+SilRQ9xuN1wuly/CMJSTc+J6vQoZ5+fzGcFs7d/2wchWKrPWil2fI7Pz5TRNg+fzKVnyTft8+xKDRWtobaCHGfM0QX0Uequ880NmRzKWQ3JaJdgsC2KeotBJVj1apb8FEH47LTFsgj94eOsenEmGzjkhcMsiFmmbdqmEm32D/wFb/gV8pPDrN/4PYAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"yaml_upload.png\"\n        title=\"yaml_upload.png\"\n        src=\"/static/e650a332b413265822e7fd637242acfc/37523/yaml_upload.png\"\n        srcset=\"/static/e650a332b413265822e7fd637242acfc/e9ff0/yaml_upload.png 180w,\n/static/e650a332b413265822e7fd637242acfc/f21e7/yaml_upload.png 360w,\n/static/e650a332b413265822e7fd637242acfc/37523/yaml_upload.png 720w,\n/static/e650a332b413265822e7fd637242acfc/302a4/yaml_upload.png 1080w,\n/static/e650a332b413265822e7fd637242acfc/07a9c/yaml_upload.png 1440w,\n/static/e650a332b413265822e7fd637242acfc/71c1d/yaml_upload.png 1536w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>정상적으로 업로드 되었습니다!!</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADMUlEQVQ4y4VUbYscRRCen2yExHDhol4ul5h70QRDICJEgxeUw89+EFGJgh9ElIQYxMztzt3u7M5b97z09Os8UjV7l7sjag/PPtVd1VXV1dUbPXpwgN29A2xu7ePa+qd4b+MzbNx4jI3Nx7h5ax93tr/CBxew99HX2Lq9j5tbX+DW7SfY2T3A5sYD3Nl7hOje+w9x/epdbK59iK21Paxf3sWVS9t45+1t5stvnceVSztYv3qP8e7ax7hOfO0+dtbvYvvGQ0TWA+gn+OH3P/HlTy8QH8WAnWFQM6CfAvoVoGOgfzXKJgbU30BIgOFoBMk+AboYUVWUKPM5vv1tgidPY/z6MkGVL5CmKcrsGHU+hcynzKdykUBkE4bMJmirY3TiGFU2RVTLFpPC4PsXOX75K8c8F4jnJZKlxOGyQbzscEjIVljJ8aJdrSnMpMO8DphmHWUosKwtPvlxgc9/XkC0PUSjIDqNUg0oVfhfFJ1nZLUeM3TWAnBAIB7HMIw/Awln8R9jCIEcNugoQqExm82RzlNYa/91k/cefa/hnGM2xkJrzTLti0Ql0bYWlVCo6xpCCCilYIxhQ5KJaU4jhMAbyTGtkWMCrRFHUjSs6PseWhuORKxUD9UpNE3LTPoQhnOgchB7H+B8gHUeUdNptPM5Fs+eYVlI5MsCizRDVdbwbmA4SwiwxjNIdiawTikDUQrA9EBwdOQautecRdt26DibsTYUORAoIz9gYA6cvVmdwjuHXGp880eB50mDqFeG60RHo1p1XXdaw5Pa0PrIhvVS1hy8qgS6pkacCtz/boanLytElDZlRUoyJKbLKcsSUkq+pKZu2KHRY635AmhOtdcawbvTLoi8C5xdWVZo6hZSNqiZ6cYlsixnpjKMMGfk8QLbVqEoJTrVjxnWTYvkaIY8L9kZBSAjIWokyTEWi4znpDuPMXiaLnF4mPA8ctbD+AGt0qsX83qEIfAR6Wgnvfem4ZxlO+5DaoFeWwjRrF6Afw0Kpu3qNRjmc/oVrHVsR8wOdW+QZznKouJFqqtzgZla5xRn192FuadedeORyTjPc37LJ0+MXgF/wwW86Vv9aVBJ/gFvjNgEVH0QBwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"yaml_update_2.png\"\n        title=\"yaml_update_2.png\"\n        src=\"/static/8c1a8402f8e3e6c80440a6981c756246/37523/yaml_update_2.png\"\n        srcset=\"/static/8c1a8402f8e3e6c80440a6981c756246/e9ff0/yaml_update_2.png 180w,\n/static/8c1a8402f8e3e6c80440a6981c756246/f21e7/yaml_update_2.png 360w,\n/static/8c1a8402f8e3e6c80440a6981c756246/37523/yaml_update_2.png 720w,\n/static/8c1a8402f8e3e6c80440a6981c756246/a8417/yaml_update_2.png 941w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"4-argocd-구축\" style=\"position:relative;\"><a href=\"#4-argocd-%EA%B5%AC%EC%B6%95\" aria-label=\"4 argocd 구축 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. ArgoCD 구축</h2>\n<p>모든 준비가 완료되었습니다. 이제 ArgoCD를 설치해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span>\r\nhelm repo <span class=\"token function\">add</span> argo https://argoproj.github.io/argo-helm\r\nhelm repo update\r\nhelm <span class=\"token function\">install</span> argocd argo/argo-cd --set server.service.type<span class=\"token operator\">=</span>LoadBalancer --namespace argocd --version <span class=\"token number\">5.19</span>.14\r\n\r\n<span class=\"token comment\"># admin 계정의 암호 확인</span>\r\n<span class=\"token assign-left variable\">ARGOPW</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span>kubectl -n argocd get secret argocd-initial-admin-secret -o <span class=\"token assign-left variable\">jsonpath</span><span class=\"token operator\">=</span><span class=\"token string\">\"{.data.password}\"</span> <span class=\"token operator\">|</span> base64 -d<span class=\"token variable\">)</span></span>\r\n<span class=\"token builtin class-name\">echo</span> <span class=\"token variable\">$ARGOPW</span>\r\n</code></pre></div>\n<p>설치가 완료되었다면 AWS Management Console에 접속하셔서 LB에 접속하시고 ArgoCD의 LB에 해당하는 DNS name으로 접속해봅시다.\r\nID : root\r\nPW : 위에서 출력한 $ARGOPW</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 97.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADJUlEQVQ4y5VU/WsVRxTd/7Yt1ippioqp9Euh0L+grdhWydMYIS0NoqgIEaE/iwgVXp55L0mz3/M9O/N2T7l3Xp5pFKQDh5llh7PnnHvvZg8ePcX2gye4u7WN39Y3cGt0F7dGG7i5fof39TubS4w27i3Ptze3cO+P+9jc2sbvfz7EL6Pb+HF0A9mlK99ide07XPrqe1xY+wbnPr+Ijz9dSThzHh+dOY9Pzq78B5+tXMDKxStYvXwVX3x5DatrV/l8+esfkAFACAEnlwuRYZ2Dthb9MAAYgMU+DD2GIe19nzCfzxFiQCalRF4UiDHyJWMtmrbFdDrF369fYzzexVFeQLqI1kYIG9NZSLRtCyEEhJRw3kNpjcw5B6kUE7I65/jCbLaPyeQNdncnmE330LzaQfPiEZoXj9G+fArZlJBKQynFRKHrYIxBprVmRQPbAbz3TEgKhFSoWwHR1tDPf4XZ+Qnm2XWYZz8jqAqxHziuECPv5C6TUqE7kaFkMsFKKUNjHYxz8ADIQ1igixFd18H7jkVoY1hIRjLJ//HK8xx10/AXvXMIocM8BgTv4KxB5yyfiSwR+kSoNUeXETMRUA60yrLkZ6paWbcoWwVhPLT1nNF48gZaG0SqagjsjoiJxybLEta6ZesURcGZ0mp0h1llMK0MbOhZyc7zv3B4lDORNpbd9UOPeT/niDJipTDjPL5DWCuP/cqgUp5bkAj5vtGQVDQh2SqR1bqAMgoZWW1bwTZOE+bCYVpqVkrNTYTUe2SdQC1DxSNC6Vpoo5NCIqVufx/h+EglhVTZruNK0n0SQDAmuVsS0leoTY7XScJSOuyVGsJ0yx5tFtNB2ZNlyp8UtqZOlr13nGGI72ZIyqgo0obFFHnuABJA1pum4QxJYWOqREiVookg64mwTITDgFxYTHKFWnvOkO5UVc1klHvKM1leFsWrBrb+Z2mZ+rCsahzlOXb3ZhjvzTDbP8DB4SEODg7fKlyAMpWKpqtlZNT9SoplUYiwqmu+KKRgnCY4jTT3CZlS9HMQPBlc2aJAVafJoVH6v8ioclQxGp3jnwNlSC/fp+ZD+BdrPdWeorzBhAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"argo_domain.png\"\n        title=\"argo_domain.png\"\n        src=\"/static/b22b87931af50f05938326eb78c7e982/37523/argo_domain.png\"\n        srcset=\"/static/b22b87931af50f05938326eb78c7e982/e9ff0/argo_domain.png 180w,\n/static/b22b87931af50f05938326eb78c7e982/f21e7/argo_domain.png 360w,\n/static/b22b87931af50f05938326eb78c7e982/37523/argo_domain.png 720w,\n/static/b22b87931af50f05938326eb78c7e982/906b5/argo_domain.png 950w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 89.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC2klEQVQ4y5WSbWvbVhiG/WvWrFDabIsDTZOVdKNxWQqDOKPLGGRQ2Lf9pH3Ih40x6EabErowxry+0K1u4yaxI9vRix1Z8otkWbIsK4RrnGOrZFm8F8HNOZJuXed+nkepX3NP+CX3lO2Hj9j6cZNnuce0bBuzYdFsd+g4Do7j4rpdHLdL1/Oker5PEAS4nofr+aimTr1VIzX77gIryx+TWb7D3NwSn67dZRjHxHGMuKJhjOf38YM+PSF/vAZ9PD+gFw5w+yHdMCIIB6TemZ7nw/cz3FxaYTZ9g7W1uxIUDiLi42N+LxTZuPeQBz//xrf3H/Hd5jb3t3N8I/YPfqLr9aT/5OSEcDAgJVItZbLcymS5eDHN5+tf4UVDLKeL0/XkqSJlFB8zGMZSYj8cxjhhRFukFwmDENfrkVpcXOb69Y+Ynf2AC2+9x9pnX9IJh7SDkDAa4ofRWAO5BmFErz+QFRjdAK0jDvZpeT5WxyV1+/Ydrs1nmJlZZOrCDNnVdTSrQ6VuU67bchWqHjXlqhjWeN9EPWqimS15f2i2qBgNUgJ2de4m8wu3uHTpKiur6+i2MzaNjKrZ4kBv8OpAk9op6/J9NYElwFqD1OXL15ieXiCdvsHU1AzZT75AszujDxJj3eblgcqOBKpShYoh3/3FJ4BXrsyTQM8Dqo0WJd1kR9FQdJNCWedAN2XSBPS/gEnCfPGQ3YpBSTuSCUXZ5yYUMAGdBEzMoof5ksrLksorRZOHiB6fW3ICfHsqTXZ1BFQbbSkx8RHQpKjW2a2KlCblmoU29iT6G/BNQqvDXtV4o4Kiki+W+WNP4cWeQn6/TL5YYf+wxr5aY7eiyz5Xa9ZkoOiVkEilGA1yL17z9febbNzbYuOHrdGQjIYECZ9Ss6hMBNqjMk+XvXdY41mhxPPXipTooSj5tG9yyWeGMvp92hhNB8Me6fSEJw7ln6Z89oCzz/8zUBj/TaeBfwKtL4KfmfS8hQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"argo_connect.png\"\n        title=\"argo_connect.png\"\n        src=\"/static/45f179d326788062d64e9d3555c47ff5/37523/argo_connect.png\"\n        srcset=\"/static/45f179d326788062d64e9d3555c47ff5/e9ff0/argo_connect.png 180w,\n/static/45f179d326788062d64e9d3555c47ff5/f21e7/argo_connect.png 360w,\n/static/45f179d326788062d64e9d3555c47ff5/37523/argo_connect.png 720w,\n/static/45f179d326788062d64e9d3555c47ff5/40601/argo_connect.png 945w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>정상적으로 접속 가능합니다!!</p>\n<p>이제 ArgoCD로 애플리케이션 배포에 사용할 깃 저장소와 쿠버네티스 클러스터 정보 등록을 위하여 ArgoCD CLI 도구를 설치해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -sSL -o argocd-linux-amd64 https://github.com/argoproj/argo-cd/releases/latest/download/argocd-linux-amd64\r\n<span class=\"token function\">install</span> -m <span class=\"token number\">555</span> argocd-linux-amd64 /usr/local/bin/argocd\r\n<span class=\"token function\">chmod</span> +x /usr/local/bin/argocd\r\n\r\n\r\n<span class=\"token comment\"># 버전 확인</span>\r\nargocd version --short</code></pre></div>\n<p>CLI를 설치했으면 ArgoCD에 로그인 해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">CLB</span><span class=\"token operator\">=</span><span class=\"token operator\">&lt;</span>각자 자신의 argocd 서비스의 CLB 도메인 주소<span class=\"token operator\">></span>\r\n\r\n<span class=\"token comment\"># argocd 서버 로그인</span>\r\nargocd login <span class=\"token variable\">$CLB</span> --username admin --password <span class=\"token variable\">$ARGOPW</span>\r\n<span class=\"token comment\"># 기 설치한 깃랩의 프로젝트 URL 을 argocd 깃 리포지토리(argocd repo)로 등록. 깃랩은 프로젝트 단위로 소스 코드를 보관.</span>\r\nargocd repo <span class=\"token function\">add</span> https://gitlab.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span>/korwoo/test-stg.git --username korwoo --password hello1234\r\n \r\n<span class=\"token comment\"># 등록 확인 : 기본적으로 아르고시디가 설치된 쿠버네티스 클러스터는 타깃 클러스터로 등록됨</span>\r\nargocd repo list\r\n\r\n<span class=\"token comment\"># 기본적으로 아르고시디가 설치된 쿠버네티스 클러스터는 타깃 클러스터로 등록됨</span>\r\nargocd cluster list</code></pre></div>\n<p>로그인이 완료되었다면 ArgoCD를 이용해서 RabbiMQ Helm 애플리케이션을 배포해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># RabbitMQ 헬름 차트 설치</span>\r\nhelm repo <span class=\"token function\">add</span> bitnami https://charts.bitnami.com/bitnami\r\nhelm repo update\r\nhelm fetch bitnami/rabbitmq --untar\r\n<span class=\"token builtin class-name\">cd</span> rabbitmq/\r\n<span class=\"token function\">cp</span> values.yaml my-values.yaml\r\n\r\n<span class=\"token comment\"># 헬름 차트를 깃랩 저장소에 업로드</span>\r\n<span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> commit -m <span class=\"token string\">\"add rabbitmq helm\"</span>\r\n<span class=\"token function\">git</span> push</code></pre></div>\n<p>다음으로 ArgoCD에서 직접 동작하는것 확인하기 위한 작업을 진행해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> ~/\r\n<span class=\"token function\">curl</span> -s -O https://raw.githubusercontent.com/wikibook/kubepractice/main/ch15/rabbitmq-helm-argo-application.yml\r\n<span class=\"token function\">vim</span> rabbitmq-helm-argo-application.yml\r\n\r\n--------------------------------------\r\napiVersion: argoproj.io/v1alpha1\r\nkind: Application\r\nmetadata:\r\n  name: rabbitmq-helm\r\n  namespace: argocd\r\n  finalizers:\r\n  - resources-finalizer.argocd.argoproj.io\r\nspec:\r\n  destination:\r\n    namespace: rabbitmq\r\n    server: https://kubernetes.default.svc\r\n  project: default\r\n  source:\r\n    repoURL: https://gitlab.korwoo.net/korwoo/test-stg.git\r\n    path: rabbitmq\r\n    targetRevision: HEAD\r\n    helm:\r\n      valueFiles:\r\n      - my-values.yaml\r\n  syncPolicy:\r\n    syncOptions:\r\n    - <span class=\"token assign-left variable\">CreateNamespace</span><span class=\"token operator\">=</span>true\r\n--------------------------------------\r\n\r\nkubectl apply -f rabbitmq-helm-argo-application.yml\r\n\r\n\r\n\r\n</code></pre></div>\n<p>정상 작동하는것을 확인하실 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEDElEQVQ4y3WU3W8UVRjG50q5MN5ImgAmhpK0tmoBd5eWUsq2QFvaBRRCw3+jJFCg0oBeee2NiV6QKMQEMSRyA0YTY0yI0o/d7c7O95z52tmd/ejPzNltQQ2TvDmTmcnvvM/zvGeU+/cfcO+Hh3z37V2++eprfv/lV4TjUtF0qrqObpg4joMQHo7rynKFIAhC/CDEER6eH7KublDSiyiZzCSLC+c5NXORgwcnuHHzDulVb7ZIkgTDsjEdFy8ICaIarXaHuJEg/IANVcf0Q9woxosbRHGC8uHhSaYn55iZvcDIyDGWl7vAdrst17VShQePn/D9w5959OQ3NlSDP/9e58fHT7n302NqtZjtq9lMUI5NzHFmfpHCwiKD745y6/aX3ZetFltbW2yBXB1X4Ec1RBBhhDWanY78Ln3f6XS/SxUpJ0+eJ58vcPToafb3H2Jl5Qs69SrFcoVGkhDaf7FZqaJqBq7wpNQ1yyVptSUu3exFh02UwtnLnMgXGB+f5cCBw3zWk9xoJLRabYJAEMd1anFdAlNwHNW6tnTS6kh70rXeaKCknY2Nneb45DyDgzmuLa0QNloYrocTRJgiQHMEquVSMV3KhoNqCaqmgy90gjCk2eoCPT9AyWWnyOWmyeWm6O8/xNWlFewwpqxb6K4nQUXN5Pmmzppqslox2NBsSpqFYaqYjsAWAV4US5+V/NQ5JibOkMlMMTCQZen6bXQvkoDViikh61Vrp9JnRc2WGwpXxQ9DvCCi0WpTUaso7+wf4q3de9i9ew+vv/YGn1xZwvBjCXwZ9AKYdmihmg6Oq+P6AWGtTpy02CiWUEYOjjM0lGV4OMu+fYNcvXYL3avJzqTE7ap01+cpsGqh2QLb0bGFhx/F1JImxVIZpf/A+/T1vU1f3z527XqTT69cR/dr/LFaoqTbbBoOm4ZLJQ3C9uQmKVB3BEIYCN/Hdj3qSYvy5ibKByPjvDcyJjvcu3dAplyxfe4+eoqul/A9k7jRpN5IcNIzq1kSmEpOQzHSYxnWiOoJ66nkzNgpps9dYjp/Vo7NzeXP0UTIsw2VombJLkuGw1rF4FlRld6moVjCxxcaQRgRxQ0ZSqlcRslmj3NmZo7TMxcZHMzKn0OacgrY9rDrpyXHZbXnYdVycV0dx/MJ4zr1ZrvrYXb0FKPHZslmu3O4dOPF2KxXXx4Zc2dstoG2Y2C5njzfYdzopZzJM7lwicL8JYaHR7mxfAdNAo1/zeD2/fYc6rZAuJoMxfUCgijuSs5k8sxOf8zCwqIEXu9JfiVQNXseBlh2VZ4U0/Vw/agXSuYEhbkLzKfAoSM7Hr4KuLYD9PFcFS8IdiRLD3NH8nx07gKTJwoMDGR6Kf8f+F+orKojw9oOr1w1+AeJKSTjBUqkwwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"argo_check.png\"\n        title=\"argo_check.png\"\n        src=\"/static/545fd8a628f9eb4428100aaa8fb4c6d7/37523/argo_check.png\"\n        srcset=\"/static/545fd8a628f9eb4428100aaa8fb4c6d7/e9ff0/argo_check.png 180w,\n/static/545fd8a628f9eb4428100aaa8fb4c6d7/f21e7/argo_check.png 360w,\n/static/545fd8a628f9eb4428100aaa8fb4c6d7/37523/argo_check.png 720w,\n/static/545fd8a628f9eb4428100aaa8fb4c6d7/ecf19/argo_check.png 948w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"5과제-1--harbor에-자신만의-아무-이미지나-태그해서-업로드하고-다운로드해서-스크린샷\" style=\"position:relative;\"><a href=\"#5%EA%B3%BC%EC%A0%9C-1--harbor%EC%97%90-%EC%9E%90%EC%8B%A0%EB%A7%8C%EC%9D%98-%EC%95%84%EB%AC%B4-%EC%9D%B4%EB%AF%B8%EC%A7%80%EB%82%98-%ED%83%9C%EA%B7%B8%ED%95%B4%EC%84%9C-%EC%97%85%EB%A1%9C%EB%93%9C%ED%95%98%EA%B3%A0-%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C%ED%95%B4%EC%84%9C-%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7\" aria-label=\"5과제 1  harbor에 자신만의 아무 이미지나 태그해서 업로드하고 다운로드해서 스크린샷 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.과제 1.  Harbor에 자신만의 아무 이미지나 태그해서 업로드하고 다운로드해서 스크린샷</h2>\n<p>저는 Azure에 이미지 저장소를 하나 만들어서 컨테이너를 하나 Push해둔 상태입니다.\r\nAzure Container Registry에 저장되어 있는 이미지를 Harbor에 Push &#x26; Pull 해보겠습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 80.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB6UlEQVQ4y42USYvbQBCF9ZsDITkkBELyB+aWP5FAtgkYnFsg5yELuRkvanVrbW3dlqU3vLZb1nhkSMOjZLvq61dVwsGTLwIvFxIvFgqvlzE+/db4+CvH+7sMH+5y3P4t8fmPxuJfibdLiWe3Am+WEs+/CTz9GuLVIsK7nwlufqS4+b5GoFMFKULIKMJms8E2FGjtHo3dwzAai9p2GIYB/3OC1hhIpaDLEk3ToG0aWGNgrXHRmBb94eCS+wHofZyId9W2h+16BKY1iOMYh1PRtVOWJYQQKIrCPXtVVeWiLiv0w4DAODf2QTHbm8oBtUaapk4+fy4vaNsWSkpIKd1NXdfNJuoTkJ149X0//u5zA1pOkgRKSSip3BznjjXWQWlgKkIfLKXQFZKsQLffu1aYQKdZlk2UIs9z1HXtZvZYx1kyJ6AjPkzfCkK4ALrmwih2wYVQzL8Uv4+iCMHlMvy8VquVg0aRHGfMAooXus1qPYoOwzBEcG0B6/XaAeUJJkfo2TWXxFy6I3C3280Dy1JDhMIVKaUQK3URjzC2OgVut9tzy1Mgh8/bKLYRCeHcerHty7kSzM+zQN7GQsJ824RIeZwhXfqX3MN8nAfW9Qg8gqT78zjO8TFwCr3qkLApkMs4O5XjUoqJOwLvAcS5x00jp4SCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"azure_cr.png\"\n        title=\"azure_cr.png\"\n        src=\"/static/33ec562b62a58a6d8d87980292e7a45a/37523/azure_cr.png\"\n        srcset=\"/static/33ec562b62a58a6d8d87980292e7a45a/e9ff0/azure_cr.png 180w,\n/static/33ec562b62a58a6d8d87980292e7a45a/f21e7/azure_cr.png 360w,\n/static/33ec562b62a58a6d8d87980292e7a45a/37523/azure_cr.png 720w,\n/static/33ec562b62a58a6d8d87980292e7a45a/98b29/azure_cr.png 937w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>아래의 명령어를 입력하여 Azrue CLI를 설치하고 Azure에 로그인을 해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -L https://aka.ms/InstallAzureCli <span class=\"token operator\">|</span> <span class=\"token function\">bash</span>\r\n\r\n설치완료 후\r\naz login\r\naz acr login -n <span class=\"token operator\">&lt;</span>컨테이너 저장소 이름<span class=\"token operator\">></span>\r\naz acr loign -n korwoo\r\ndocker pull korwoo.azurecr.io/korwoo_project:47\r\ndocker tag 이미지id harbor.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span>/pkos/stayfocus:0.1\r\ndocker login harbor.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span> -u admin -p Harbor12345\r\ndocker push harbor.<span class=\"token variable\">$KOPS_CLUSTER_NAME</span>/pkos/stayfocus:0.1\r\n</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAzElEQVQY0z2Py26FMBBD2UJALIqgPC8kAXIvFeIp4P8/zJVHahdezMTxGXu7sfgxPb7NB19ZgdergTEWTdMgyzKM44i6rtG2LZZlQZqmCMMQeZ7LLo5jKKXES3nzusB93pjeDkZrOOfQ9z2maUJZliIGJEmCfd9xnuc/gDP9nAnetg3euq6oqgpBEECpUD7/iWRrLYZhkMvoPY4DxhgBzfMsb77vQ2stDTymMp0G1mA4iVQURei6Tvasc10XnueREPoYwAsJL4oC933jF7XNbdDOciO1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"azure_images.png\"\n        title=\"azure_images.png\"\n        src=\"/static/3d73184df37d8009add6ab312e35d9c4/37523/azure_images.png\"\n        srcset=\"/static/3d73184df37d8009add6ab312e35d9c4/e9ff0/azure_images.png 180w,\n/static/3d73184df37d8009add6ab312e35d9c4/f21e7/azure_images.png 360w,\n/static/3d73184df37d8009add6ab312e35d9c4/37523/azure_images.png 720w,\n/static/3d73184df37d8009add6ab312e35d9c4/302a4/azure_images.png 1080w,\n/static/3d73184df37d8009add6ab312e35d9c4/71ee9/azure_images.png 1081w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span>\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.22222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACN0lEQVQ4y92RWVMTQRRGx43CMlgUyDKZJIQskGQmmT2TmQlhEQwEZClKUANilSgP/hjZfPLHHqs7BkHJi48+nLpf39v99e3bSuLrDx58ukb5cN7j4wVDp1cMf76SscclT04vZRTrkbNrRs6uUE7OUY6/kfgi9n9HOblAMbe7ZJZ3SbgrPNRjhq0lRhvrjAZthqxlHlUXeVxbkgj9zFtjLOzw1FllLNwg4a3J2vNgHS1qoySNgJQZotUapGohaTNCNeqoVhPVjNCsiKTukTR8iap7qBVP5kQUa83wmZy3MeJVFL/zlniny/zCJqXFbQpRm6wZyGIpWJQ6WbbQKjZa2e7F21pGB7VkMuc3UXJmQNGNmdFdJnNlpooGOTukEi7jrnTIWQ3UkiUP3Tb4k6SgbKOoc1U0caBkMpmvMF00SOku6WqdfLDEjBmQqfqkDQ9N90iJKE3c34Ziv8y7KMJkIleWZoKpgk5adyk4EdmqT7ZWlzpnBcw4TTJ23OuobJMSF+iuRIxG5BVh0OfG0PCYdWK0asB0xWO6ZJMS5maDVMUhZ0dkanXm/RZzfousFZJ3mzJ3x1Awka9QcGNaO4c0d9+zsNcl7uwRbe0TbuzSeLVFMVhk1o3JOyFZJ5K6FL2kWG8NMHQiNg+O2HzT7SH0wRGvD49p77+Tnya6KXgLFLxYzjnnxH93KJ9cNOR8xvM643njF/oNLwq9uphXf3497Q2aoXFn8330P+U+Bhr+KwMN+zf+f4Y/ATiI58cTq6FZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"harbor_azure.png\"\n        title=\"harbor_azure.png\"\n        src=\"/static/2e20baa3bd98fb52a8808c14c7d84ff9/37523/harbor_azure.png\"\n        srcset=\"/static/2e20baa3bd98fb52a8808c14c7d84ff9/e9ff0/harbor_azure.png 180w,\n/static/2e20baa3bd98fb52a8808c14c7d84ff9/f21e7/harbor_azure.png 360w,\n/static/2e20baa3bd98fb52a8808c14c7d84ff9/37523/harbor_azure.png 720w,\n/static/2e20baa3bd98fb52a8808c14c7d84ff9/98b29/harbor_azure.png 937w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>이미지가 정상적으로 Push 되었습니다.\r\n이제 해당 이미지를 Pull 해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker rmi -f <span class=\"token operator\">&lt;</span>이미지id<span class=\"token operator\">></span> \r\ndocker pull harbor.korwoo.net/pkos/stayfocus:0.1</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAklEQVQoz52RSY6DQAxFaxkIYUyQCKAWYQqjQrMI97/Yb31LhQILpPTiyWCbV3ah8vQHSdUjywv0fY+u65DnOZIkQZqmiONYuN/vQhRFa449zF2vV7iuC8dxoH7nGc+qRNu2qOtaIoWe5wlBEMC2bZxOJ8EwjJXz+Sw9lPOg2+0GtbzfqJ9PvF4vDMOAeZ5RVZWcqKXE932RM29Z1grfOSFrRC3LImtO0yRSLdSSPVyLk2kh+8IwFChWFJRlKVKuTClX1iuZprlByxg1n3WlJ9LCcRzxeDw2U+w5qqmmaVAUBRg5Kf90lmWHHx2huBofLpfLhn8L9/eh+cx/Lfz2no6Efy4v9fKiyyV6AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"harbor_pull.png\"\n        title=\"harbor_pull.png\"\n        src=\"/static/07732dc799b0a9849dce299b5738ac12/37523/harbor_pull.png\"\n        srcset=\"/static/07732dc799b0a9849dce299b5738ac12/e9ff0/harbor_pull.png 180w,\n/static/07732dc799b0a9849dce299b5738ac12/f21e7/harbor_pull.png 360w,\n/static/07732dc799b0a9849dce299b5738ac12/37523/harbor_pull.png 720w,\n/static/07732dc799b0a9849dce299b5738ac12/302a4/harbor_pull.png 1080w,\n/static/07732dc799b0a9849dce299b5738ac12/62da8/harbor_pull.png 1262w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"6과제-2---자신만의-텍스트-파일을-kops-ec2-로컬에서-gitlab에-올려보기\" style=\"position:relative;\"><a href=\"#6%EA%B3%BC%EC%A0%9C-2---%EC%9E%90%EC%8B%A0%EB%A7%8C%EC%9D%98-%ED%85%8D%EC%8A%A4%ED%8A%B8-%ED%8C%8C%EC%9D%BC%EC%9D%84-kops-ec2-%EB%A1%9C%EC%BB%AC%EC%97%90%EC%84%9C-gitlab%EC%97%90-%EC%98%AC%EB%A0%A4%EB%B3%B4%EA%B8%B0\" aria-label=\"6과제 2   자신만의 텍스트 파일을 kops ec2 로컬에서 gitlab에 올려보기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6.과제 2.   자신만의 텍스트 파일을 kops-ec2 로컬에서 GitLab에 올려보기</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">mkdir</span> korwoo-gitlab <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> korwoo-gitlab\r\n\r\n<span class=\"token function\">git</span> config --list\r\n\r\n<span class=\"token function\">git</span> config 설정이 제대로 안되어 있다면\r\n<span class=\"token function\">git</span> config --global user.name <span class=\"token string\">\"korwoo\"</span>\r\n<span class=\"token function\">git</span> config --global user.email <span class=\"token string\">\"korwoo93@gmail.com\"</span>\r\n</code></pre></div>\n<p>이후 위의 과정을 참고하여 다시 신규 프로젝트를 생성해주자</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone https://gitlab.korwoo.net/korwoo/korwoo-stg.git\r\n<span class=\"token builtin class-name\">cd</span> korwoo-stg\r\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"stay focus korwoo!!\"</span> <span class=\"token operator\">>></span> korwoo.txt\r\n<span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">git</span> commit -m <span class=\"token string\">\"This Is Persornal Commit\"</span>\r\n<span class=\"token function\">git</span> push\r\n</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACeUlEQVQ4y42Q7UsUURSH57/szTJNij72oW+lqEUQ9Qf0KQgpa02zDCMsMiqpCPoQlqXrapm7s7uzM3fuvNw7c+eJuW7rJggNPJxzfudlzrnO4twSCwsrVB6+5s7Uc6buLnFv+gXT918y/eAl9+6/sJRx5eEys4/e8PjJCnPzb6nMLPOg8oq5+XfMVJ5xe2oW58LpMUZOTXD29DjnBscYHhhl4OglBo5dZuDoZU5YRq09fmQvHh6cZOjkBCNDVzkzOMnImWtcPDfJ+eErOO1QYUSN9Y1VPn5ZZXvrG8r7QdT6Qdr+Tt5Z28dfw/hr6PZXkBsQVyHqIqtWc7yWR9zZYf79BjeerrP0eQsVefidFnHQIBPb6OAAXU0FW6iu1aXvb+F4bZ9fXsrnms+n9SY7TZ/N3x7bjYDNekC1HrDZED2qdUGtEVLdLfXQar99TV3k7HTU3sB2qLm1XOf64i+afkTLE7R8SVNmuGFGsw8by7xru7rMezjtVockVZiiII0jUpVRALkp/hvT5zt+IIk7Pu7qKnXXo7HrUt91CQNJrg1a5WT96H4MKtX4HUHgh2ilcTwvIJERodskjhVxnFrKwiwz/w7oxlplPVSakcQpSaLQOts7OU5SEqVJ03JYTJIkFmMMRVFYKAFMniNDiZSRJYoiWytEaPudwBekaU6jJWg124hAIsPYnlqiVA7GMPPBZWyuxvijGjcXf9L0BJGUCCEJw4ggEPsb2vO671H+UUpJKEJMbuyDlxuKOMMNFK5QeFKTG2MvKMnzktxap9yodHqn9X1/tYN6N7mfp+jVO2mi9xuKw4f063v8m+sNTGJFYYpDmv6fvwP/AKeyVQU/HB1tAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"gitlab_push_2.png\"\n        title=\"gitlab_push_2.png\"\n        src=\"/static/875742fba5eecc6924f443a37171a9fc/37523/gitlab_push_2.png\"\n        srcset=\"/static/875742fba5eecc6924f443a37171a9fc/e9ff0/gitlab_push_2.png 180w,\n/static/875742fba5eecc6924f443a37171a9fc/f21e7/gitlab_push_2.png 360w,\n/static/875742fba5eecc6924f443a37171a9fc/37523/gitlab_push_2.png 720w,\n/static/875742fba5eecc6924f443a37171a9fc/146da/gitlab_push_2.png 943w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"7-과제3--교제의-책-273p-gitops-실습-해보기클러스터-설정-내역-변경과-깃-저장소-자동-반영\" style=\"position:relative;\"><a href=\"#7-%EA%B3%BC%EC%A0%9C3--%EA%B5%90%EC%A0%9C%EC%9D%98-%EC%B1%85-273p-gitops-%EC%8B%A4%EC%8A%B5-%ED%95%B4%EB%B3%B4%EA%B8%B0%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EC%84%A4%EC%A0%95-%EB%82%B4%EC%97%AD-%EB%B3%80%EA%B2%BD%EA%B3%BC-%EA%B9%83-%EC%A0%80%EC%9E%A5%EC%86%8C-%EC%9E%90%EB%8F%99-%EB%B0%98%EC%98%81\" aria-label=\"7 과제3  교제의 책 273p gitops 실습 해보기클러스터 설정 내역 변경과 깃 저장소 자동 반영 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>7 과제3 . 교제의 책 273P GitOPS 실습 해보기(클러스터 설정 내역 변경과 깃 저장소 자동 반영)</h2>\n<p>클러스터 설정 변경 검증을 위한 2개의 애플리케이션 배포를 위한 yml파일을 준비해주겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">httpd-deploy.yml\r\n\r\napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: httpd\r\n  namespace: httpd\r\n  labels:\r\n    app: httpd  <span class=\"token comment\">#service가 바라보는 label이 아님. 주의.</span>\r\nspec:\r\n  replicas: <span class=\"token number\">3</span>\r\n  selector:\r\n    matchLabels:\r\n      app: httpd  \r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: httpd  <span class=\"token comment\"># Service가 바라보는 label 지정 </span>\r\n    spec:\r\n      containers:\r\n      - name: httpd\r\n        image: httpd</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">httpd-svc.yml\r\n\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: httpd-svc\r\n  namespace: httpd\r\nspec:\r\n  ports:\r\n  - name: http\r\n    port: <span class=\"token number\">80</span>\r\n    protocol: TCP\r\n    targetPort: <span class=\"token number\">80</span>\r\n    nodePort: <span class=\"token number\">30180</span>\r\n  selector:\r\n    app: httpd\r\n  type: NodePort</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> ~/gitlab-test/test-stg/\r\n<span class=\"token function\">mkdir</span> 03.httpd\r\n<span class=\"token builtin class-name\">cd</span> 03.httpd</code></pre></div>\n<p>이후 03.httpd 디렉터리에 위2개의 yaml 파일을 저장후 Push 시켜줍니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaElEQVQoz42PTUsCURSG5/9XmoJEi2jTwiEoqGWrWkSGGWGCaYWmGWTqjHPv3K9z5425zqiFUAcezvfLOV5l7wyVygkO9k9RKfvY3jpCsVBFoVB13lH0M6pr+K5XLh1jt+ijVPSxs30Ir9sdYdjr4+KqhsvrOp4fG3hp1vDavHH0WrcYtOsYtO82Mnxq4L3TwKh7j49OAx4ZC2mA84cJmm8BAi7wxSSmfMGECUyYRCgNQkUIZUYWBy43zs+EgTcPGaQkTLmBUARNCbjQCEIOLglCJ45YWYdQq1zrxbw0K7xozmE0Yd0055h9jjEPI2ilQYZgybo5JRSkUFBCotVPP9LZVuLwtCKkbydJ4khNSgXGY8SxWPowjMAYd0QRB+cxWr0xAqYWctn+UjAvpkbagDEGrTWstY44jiGldDN5zRoFJD93Nwom1joxIlq+k8Z5nl9DZFc7mwVXjdz+yn/XNl+YXfBf1i/8Bui68m5lBTo5AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"push_check.png\"\n        title=\"push_check.png\"\n        src=\"/static/8eecf76f421734418a96d4e0d1a3b3ea/37523/push_check.png\"\n        srcset=\"/static/8eecf76f421734418a96d4e0d1a3b3ea/e9ff0/push_check.png 180w,\n/static/8eecf76f421734418a96d4e0d1a3b3ea/f21e7/push_check.png 360w,\n/static/8eecf76f421734418a96d4e0d1a3b3ea/37523/push_check.png 720w,\n/static/8eecf76f421734418a96d4e0d1a3b3ea/302a4/push_check.png 1080w,\n/static/8eecf76f421734418a96d4e0d1a3b3ea/07a9c/push_check.png 1440w,\n/static/8eecf76f421734418a96d4e0d1a3b3ea/5f7fb/push_check.png 1889w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>아래의 yaml파일은 아파치 웹서버를 설치하는 ArgoCD application CRD yaml 파일 입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">httpd-directory-argo-application.yml\r\n\r\napiVersion: argoproj.io/v1alpha1\r\nkind: Application\r\nmetadata:\r\n  name: httpd\r\n  namespace: argocd  \r\n  finalizers:\r\n  - resources-finalizer.argocd.argoproj.io\r\nspec:\r\n  destination:\r\n    namespace: httpd\r\n    server: https://kubernetes.default.svc\r\n  project: default\r\n  source:\r\n    repoURL: https://gitlab.korwoo.net/korwoo/test-stg.git\r\n    path: 03.httpd\r\n    targetRevision: HEAD\r\n    directory:\r\n      recurse: <span class=\"token boolean\">true</span>\r\n  syncPolicy:\r\n    syncOptions:\r\n    - <span class=\"token assign-left variable\">CreateNamespace</span><span class=\"token operator\">=</span>true\r\n    automated:\r\n      prune: <span class=\"token boolean\">true</span>\r\n      \r\nkubectl apply -f httpd-directory-argo-application.yml</code></pre></div>\n<p>이후\r\nk get applications -n argocd 명령어를 통해 httpd가 Healthy 상태로 바뀐것을 확인할 수 있습니다.\r\nyaml 파일 마지막 부분에 automated.prune: true이 설정하여 ArgoCD 에서 SYNC 하지 않아도 자동을 동기화 작업을 진행하게 됩니다.\r\n동기화 작업이 완료되어있다면 POD와 Object를 정상적으로 조회할 수 있습니다.</p>\n<p>설치가 정상적으로 되었습니다!!\r\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+0lEQVQY02VR2W6EQAzjmQXKOZxDuW9WC/z/t7lyKlClPkRxRrHjZIx30yKzv2ArjSDVGPoe+76jaRrUdY2u6zAMg9RFUSBJEkRRBK01XNfF6/WCZVlPGMfng7qqEKkYkVI4jgPTNMHzPBGieBAED5lh2zZM03zE/ooa5zihjVOo7x5hpkWcQlmWYZ5n9H0vLsuyRFVVgpmVUv/c/QqeJ7Ztw7quuK5LMus0TYXo+z7YQ2G+0Tkdcyhd3kK3e4ONvA/JN2aEYSi3ogDrPM8Fk8z1ucG9OoNYHC7LgjiOJTiZpHEcBdMRb9i2rQzgUG7AQfyc+/PYy+w4Dn4ANRicYAtB0EsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"http_healthy.png\"\n        title=\"http_healthy.png\"\n        src=\"/static/9f3a331f11c15bcc4aded806e80d7843/37523/http_healthy.png\"\n        srcset=\"/static/9f3a331f11c15bcc4aded806e80d7843/e9ff0/http_healthy.png 180w,\n/static/9f3a331f11c15bcc4aded806e80d7843/f21e7/http_healthy.png 360w,\n/static/9f3a331f11c15bcc4aded806e80d7843/37523/http_healthy.png 720w,\n/static/9f3a331f11c15bcc4aded806e80d7843/302a4/http_healthy.png 1080w,\n/static/9f3a331f11c15bcc4aded806e80d7843/96e86/http_healthy.png 1089w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>이제 깃 저장소에서 소스변경 하지 않고 클러스터에서 임의로 리소스를 변경하고 오브젝트를 삭제하여 ARgoCD GitOps의 동작 과정을 확인해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">k ns httpd\r\nk edit deployments.apps httpd\r\n\r\ncontainers.image: httpd:alpine\r\n</code></pre></div>\n<p>ArgoCD 페이지에서 APPDIFF 메뉴를 통해 차이점을 확인하실 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB7klEQVQoz2VS3U4TQRjde73pDb2xQChgmm79oVW88JlIaSXV+BomalBEUe4Mr6GJCoot0WdQ29352dn5O2a+dhcKs5nsZs985zvnmxO1Nx6g2Wyj1x/g2ctdfDn+jrC01vg7nkBkGbz39K94W+dgjME4ScCEgHOuxKNW3MHKShO9nSd4tb+P0+EZgVwIpIwTcXG4JLQWQmZIGEOe67mGUbvzELXaTewMnuLj0RFGv37DeU9kQkrkWpOiiwqNtYTzAre2bBjF8T0sLTXQ7Q2w9/4QP4ZnCGVJyiCzDMbYK5YDYVAXVGpjSjIiXF1tYmFhEd3+AM/33uLT1xMqmqQpza9Yc5adQ8o5zW8Oh0dUrdZw/VoFW9uP8OLNAT5/m15KUMCFPFc32wUh44J2cSHFgejG4hoqlSoRvj44xMnPEeFCCCiVw1kX2gPOwbvpt7EGPJOQSsF6BwcPN3ui23c3Ua/HZHn33Qccn46CBCghkUwS6EzBaQ2nDbwx4YqR6QxCS4x5AmkUcqeRew3tDaJG3MHycuMC4ZAUqjzHn/EETEgafGmNYuOgtcG/STKLlpk5AaJWaxPra7fQ7T8+VwiAcU5zzJS6GmxrKafTJCiKWZnDjTv3Ua83sX2JMGWMhh6iEYouB5vNgh+iFdJQOPgPnd8IZ3/BFG4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"argo_appdiff.png\"\n        title=\"argo_appdiff.png\"\n        src=\"/static/b379fa93d5582bf7b42f131669bfaa56/37523/argo_appdiff.png\"\n        srcset=\"/static/b379fa93d5582bf7b42f131669bfaa56/e9ff0/argo_appdiff.png 180w,\n/static/b379fa93d5582bf7b42f131669bfaa56/f21e7/argo_appdiff.png 360w,\n/static/b379fa93d5582bf7b42f131669bfaa56/37523/argo_appdiff.png 720w,\n/static/b379fa93d5582bf7b42f131669bfaa56/302a4/argo_appdiff.png 1080w,\n/static/b379fa93d5582bf7b42f131669bfaa56/07a9c/argo_appdiff.png 1440w,\n/static/b379fa93d5582bf7b42f131669bfaa56/966c1/argo_appdiff.png 1694w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>그렇다면 이번에는 오브젝트를 삭제해보도록 하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">k get svc\r\nk delete svc httpd-svc</code></pre></div>\n<p>ArgoCD 페이지에서 변경 내역을 확인하실 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB20lEQVQoz5WQW2sTQRiG9yfolXfmoiAIjfHQCzVtLd6kxTv9AYIgeuFPEmxtK3gC9cZ/4U1saZo9JZs9zOzOZg/ZVEzqI7tJsVURHHh4v3mZeb9vRnvy+BmPHj7lw6fPWK7PoWFj9gYYPQezP0C3naq2HQ/d7qOGCT+AyWTKdPqLch8NU7TlZot6vcnL7V1cITjodugYNgNfcGDYtA2bL7qOOXCx+y6OCJkcH/O39X0yQWu1HrC4eIt37z9WZjYakRZj8vE3VJITpSNEkhHnBUk+xpMKGacM84I4G81IZ5rkBVqzuU7jyjKbO28JkgLTFVheiOlJdFfiBBI/GuKrFMMLK687EBV6Semd4Eq0xtXb1GqX2dp5g+4rOpZFNioI4hTTCxFRSHF0RDIaY/sRfaGqBoFKsPyIfaHYC2P2opiujNEu1i5x/twFnm++QmRjuk6A4cqqe6mWL6uQauKBwJGKYZajkgzLD2mLiK9qSDuMORQKrXFjhYWFOi+2XxOkRRVoVk+eYbizpxhVLTH9kF6gMEvPlXSEohPG7PshXT9EW7t7j6WlNbZ2Z394EmjML5STnW0g58y9Ustzc7SbKxtcv7b6R+DvIaf1THipp9DWW/e5s7rxz8D/4SePh7ejpBW95wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"delete_svc.png\"\n        title=\"delete_svc.png\"\n        src=\"/static/ddd31a715ea784b9c93899aba2f59447/37523/delete_svc.png\"\n        srcset=\"/static/ddd31a715ea784b9c93899aba2f59447/e9ff0/delete_svc.png 180w,\n/static/ddd31a715ea784b9c93899aba2f59447/f21e7/delete_svc.png 360w,\n/static/ddd31a715ea784b9c93899aba2f59447/37523/delete_svc.png 720w,\n/static/ddd31a715ea784b9c93899aba2f59447/302a4/delete_svc.png 1080w,\n/static/ddd31a715ea784b9c93899aba2f59447/07a9c/delete_svc.png 1440w,\n/static/ddd31a715ea784b9c93899aba2f59447/7792f/delete_svc.png 1761w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>위의 화면에서 보시면 APP Health 가 Missiong 상태임을 확인하실 수 있습니다.</p>\n<p>k get applications -n argocd 명령어로도 확인이 가능합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAApUlEQVQI122OyQqDQBBEvZiIKyohCuIyo6MyIm74/3/2gn3OoSkKqqqf8/2UpK3lW7X0WmGXBWstfd9TVRVd16GUQmvNNE2M40jTNOKLoqAsS4ZhoK5rwjDEeb9e+EHI2/OY55n7vtm2TUJ5nnMcB+u6ijfGyMBTjONYNIoikiQRDYIA5/k0GkOWZSitua6Lfd9J01RCD+15nkLrui6+70vx3z2EPxRBTs2G14MEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img.png\"\n        title=\"img.png\"\n        src=\"/static/e32ade39fab6a65251414876dfec1b7f/37523/img.png\"\n        srcset=\"/static/e32ade39fab6a65251414876dfec1b7f/e9ff0/img.png 180w,\n/static/e32ade39fab6a65251414876dfec1b7f/f21e7/img.png 360w,\n/static/e32ade39fab6a65251414876dfec1b7f/37523/img.png 720w,\n/static/e32ade39fab6a65251414876dfec1b7f/136a2/img.png 884w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>여기서 위의 메뉴중에 SYNC 라는 메뉴가 있는데 이 메뉴를 클릭하면 깃 저장소에 애플리케이션 상태를 일치화 시킬 수 있습니다.</p>\n<p>SYNC를 시켜보니 깃 저장소와 애플리케이션 상태가 일치된거 같습니다! 명령어를 통해서도 확인해보겠습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0UlEQVQoz22QzW4TMRRG8wKwKkskWLYKqLsKxHuxYMEGVQotBQRkxTsgxEOwgAWQpk3STP4m8Yzt8fxlMklmoAfFkyAWtXR0pWv7XPurPXv6nM+fvhBEMb7SmCjGkxpfBUgdoLRBByG+DtAmoihKirKsalGyLkrK8jfZIkeaiNrDB4958fIt7cGYzmhCb+TS7jn8urziW7vL11ab7xcdzrt9Os6IbF1w09oMmedLavv7R7xrfrTNcD4nXSz4c31Nli8JkzlmkZHkuX1JlMzxdEi+WrNYrm3dsVwXrIqS2sHBEadnTeJlgSsDhkLRn0qcmaqYVvRnioHQjP2AiTSMfWP3B1vsuZmidv9encbpe2SS05t41SGhLZuLIowJ06ySeJokW5DlK7wgoi80fWlwVIgjQxyhqd2+dYfjxmtck/LjakiU5QTxnKGnGW6lk+1rnJm0wZs4xZWGjtC0gpCfvuIiiCrh3t5djhtvkGlOZywY+YEVbQQbmRcl6Ci1Xx0IhY5Tm6XQIZczxbmJaClDeyc8PHzCyVkTlS65cv1/2W2+7AjFwNNVRtueq0KmKqyyFpqeNHSFtlhhvf6Ik1cfUGluhbv8qsCr6vzX29DfDbiBv6lSg8Ma8/kRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img_1.png\"\n        title=\"img_1.png\"\n        src=\"/static/2ba5c1e97eecc082917c9b7b4864b3c8/37523/img_1.png\"\n        srcset=\"/static/2ba5c1e97eecc082917c9b7b4864b3c8/e9ff0/img_1.png 180w,\n/static/2ba5c1e97eecc082917c9b7b4864b3c8/f21e7/img_1.png 360w,\n/static/2ba5c1e97eecc082917c9b7b4864b3c8/37523/img_1.png 720w,\n/static/2ba5c1e97eecc082917c9b7b4864b3c8/302a4/img_1.png 1080w,\n/static/2ba5c1e97eecc082917c9b7b4864b3c8/07a9c/img_1.png 1440w,\n/static/2ba5c1e97eecc082917c9b7b4864b3c8/e1b78/img_1.png 1809w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">k get svc\r\nk describe pod httpd-676d9bc46d-94d2z</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABF0lEQVQoz5VS2WrEQAybx9zZQO57cx+w+f+vU5HBpdDdlD4Y25NIljxj8rTEdLwwTyP2fce2bWiaBuu6oq5rZFmGaZqQpimKokAQBHBdF57nvQ2TJBmyssY8z0JGonEc0fc9yrJEVVVC2Lat1ATdEj6fT0SPB5jzPBcFURQJyHEc2LYNy7IkM5TsE6mhpTAMRdV1XViWRdQOwyBnvu//At0qpC0WtEXLHMBd0Z4q/QR+S0gFBPECuDdaVov/JRNCEsVxLDfbdZ0o5C55pnu7C+6ZgzUMbSZJ8k1KuyTmrXIYz5i1ZnAd7PkPcXTJe2A253lKw10exyHkrJVEwcxKxu86iD0dUQixRvfGhk9Hn4vmv+KnXVr+Ar3t9NUzh16ZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img_2.png\"\n        title=\"img_2.png\"\n        src=\"/static/39dd046cad0534bb2d5adad34d2f4072/37523/img_2.png\"\n        srcset=\"/static/39dd046cad0534bb2d5adad34d2f4072/e9ff0/img_2.png 180w,\n/static/39dd046cad0534bb2d5adad34d2f4072/f21e7/img_2.png 360w,\n/static/39dd046cad0534bb2d5adad34d2f4072/37523/img_2.png 720w,\n/static/39dd046cad0534bb2d5adad34d2f4072/302a4/img_2.png 1080w,\n/static/39dd046cad0534bb2d5adad34d2f4072/07a9c/img_2.png 1440w,\n/static/39dd046cad0534bb2d5adad34d2f4072/f663d/img_2.png 1511w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#1argocd\">1.ArgoCD??</a></li>\n<li><a href=\"#2-harbor-container-registry-%EA%B5%AC%EC%B6%95\">2. Harbor Container Registry 구축</a></li>\n<li><a href=\"#3-gitlab-%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-local-git-%EC%86%8C%EC%8A%A4-%EC%A0%80%EC%9E%A5%EC%86%8C-%EA%B5%AC%EC%B6%95\">3. GitLab 을 이용한 Local Git 소스 저장소 구축</a></li>\n<li><a href=\"#4-argocd-%EA%B5%AC%EC%B6%95\">4. ArgoCD 구축</a></li>\n<li><a href=\"#5%EA%B3%BC%EC%A0%9C-1--harbor%EC%97%90-%EC%9E%90%EC%8B%A0%EB%A7%8C%EC%9D%98-%EC%95%84%EB%AC%B4-%EC%9D%B4%EB%AF%B8%EC%A7%80%EB%82%98-%ED%83%9C%EA%B7%B8%ED%95%B4%EC%84%9C-%EC%97%85%EB%A1%9C%EB%93%9C%ED%95%98%EA%B3%A0-%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C%ED%95%B4%EC%84%9C-%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7\">5.과제 1.  Harbor에 자신만의 아무 이미지나 태그해서 업로드하고 다운로드해서 스크린샷</a></li>\n<li><a href=\"#6%EA%B3%BC%EC%A0%9C-2---%EC%9E%90%EC%8B%A0%EB%A7%8C%EC%9D%98-%ED%85%8D%EC%8A%A4%ED%8A%B8-%ED%8C%8C%EC%9D%BC%EC%9D%84-kops-ec2-%EB%A1%9C%EC%BB%AC%EC%97%90%EC%84%9C-gitlab%EC%97%90-%EC%98%AC%EB%A0%A4%EB%B3%B4%EA%B8%B0\">6.과제 2.   자신만의 텍스트 파일을 kops-ec2 로컬에서 GitLab에 올려보기</a></li>\n<li><a href=\"#7-%EA%B3%BC%EC%A0%9C3--%EA%B5%90%EC%A0%9C%EC%9D%98-%EC%B1%85-273p-gitops-%EC%8B%A4%EC%8A%B5-%ED%95%B4%EB%B3%B4%EA%B8%B0%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EC%84%A4%EC%A0%95-%EB%82%B4%EC%97%AD-%EB%B3%80%EA%B2%BD%EA%B3%BC-%EA%B9%83-%EC%A0%80%EC%9E%A5%EC%86%8C-%EC%9E%90%EB%8F%99-%EB%B0%98%EC%98%81\">7 과제3 . 교제의 책 273P GitOPS 실습 해보기(클러스터 설정 내역 변경과 깃 저장소 자동 반영)</a></li>\n</ul>\n</div>\n<p>D:\\Git_Blog\\korwoo93.github.io</p>\n<div class=\"gatsby-highlight\" data-language=\"toc\"><pre class=\"language-toc\"><code class=\"language-toc\"></code></pre></div>","frontmatter":{"date":"February 08, 2023","title":"Gasida Kubernetes Study 4주차","categories":"Kubernetes","author":"KORWOO","emoji":"🔮"},"fields":{"slug":"/Kubernetes/Gasida_Study_homework_4/"}},"site":{"siteMetadata":{"siteUrl":"https://www.zoomkoding.com","comments":{"utterances":{"repo":""}}}}},"pageContext":{"slug":"/Kubernetes/Gasida_Study_homework_3/","nextSlug":"/Kubernetes/Gasida_Study_homework_2/","prevSlug":"/Kubernetes/Gasida_Study_homework_4/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}